# üéØ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è

## üöÄ –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è: –ú–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø—Ä–æ–¥–∞–∂

–ê–ª–≥–æ—Ä–∏—Ç–º —Ç–µ–ø–µ—Ä—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ **—É–º–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏** - –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –æ—Ç–¥–∞–µ—Ç—Å—è –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è–º —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é –ø—Ä–æ–¥–∞–∂, –ø—Ä–∏ —ç—Ç–æ–º –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —Å–∫–æ–ø–ª–µ–Ω–∏—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤.

---

## üìä –ö–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

### üèÉ –°–∫–æ—Ä–æ—Å—Ç—å –ø—Ä–æ–¥–∞–∂ (–ì–õ–ê–í–ù–´–ô –ü–†–ò–û–†–ò–¢–ï–¢)
- **`velocity_weight = 10.0`** ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –≤–µ—Å –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø—Ä–æ–¥–∞–∂
- –¢–æ–≤–∞—Ä—ã –∏–¥—É—Ç —Ç—É–¥–∞, –≥–¥–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏ –ø—Ä–æ–¥–∞—é—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ –≤—Å–µ–≥–æ
- –£—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Å–∫–æ—Ä–æ—Å—Ç—å –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (80%) + –æ–±—â–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è (20%)

### üé® –ö–æ–Ω—Ç—Ä–æ–ª—å –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–∞
- **`category_congestion_penalty = 15.0`** ‚Äî —à—Ç—Ä–∞—Ñ –∑–∞ –∫–∞–∂–¥—ã–π –∏–º–µ—é—â–∏–π—Å—è —Ç–æ–≤–∞—Ä —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- **`empty_category_bonus = 80.0`** ‚Äî –æ–≥—Ä–æ–º–Ω—ã–π –±–æ–Ω—É—Å –∑–∞ –Ω–æ–≤—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é (—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–∞)
- **`category_threshold = 10`** ‚Äî –ø–æ—Ä–æ–≥ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 10 —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤)
- **`category_overload_multiplier = 2.5`** ‚Äî –º–Ω–æ–∂–∏—Ç–µ–ª—å —à—Ç—Ä–∞—Ñ–∞ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ø–æ—Ä–æ–≥–∞

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –ï—Å–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–µ—Ç –≤–æ–æ–±—â–µ ‚Üí –±–æ–Ω—É—Å +80
- –ï—Å–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ 1-9 —à—Ç—É–∫ ‚Üí —à—Ç—Ä–∞—Ñ -15 –∑–∞ –∫–∞–∂–¥—É—é
- –ï—Å–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ‚â•10 —à—Ç—É–∫ ‚Üí —É—Å–∏–ª–µ–Ω–Ω—ã–π —à—Ç—Ä–∞—Ñ (–±–∞–∑–æ–≤—ã–π + –ø–µ—Ä–µ–≥—Ä—É–∑ √ó 2.5)

### ‚öñÔ∏è –†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å (–ú–ò–ù–ò–ú–ê–õ–¨–ù–ê–Ø)
- **`fairness_penalty = 0.05`** ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —à—Ç—Ä–∞—Ñ (–Ω–µ —Å—Ç—Ä–µ–º–∏–º—Å—è –∫ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏)
- **`max_department_percentage = None`** ‚Äî –ù–ï–¢ –∂–µ—Å—Ç–∫–∏—Ö –ª–∏–º–∏—Ç–æ–≤ –Ω–∞ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ
- –ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è —Å –≤—ã—Å–æ–∫–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é –º–æ–≥—É—Ç –ø–æ–ª—É—á–∏—Ç—å –±–æ–ª—å—à–µ —Ç–æ–≤–∞—Ä–æ–≤

### üì¶ –û—Å—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- **`coverage_weight = 0.2`** ‚Äî –Ω–µ–±–æ–ª—å—à–æ–π —É—á–µ—Ç –¥–µ—Ñ–∏—Ü–∏—Ç–∞
- **`margin_weight = 0.15`** ‚Äî –≤–µ—Å –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- **`gashek_dampener = 0.3`** ‚Äî –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–ª—è –ì–∞—à–µ–∫–∞ (—Å–∫–æ—Ä–æ—Å—Ç—å √ó 0.3 –∏–∑-–∑–∞ –ø–µ—Ä–µ–∫—É–ø–æ–≤)

---

## üéØ –ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –¢–µ–ª–µ—Ñ–æ–Ω—ã
- **–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ê**: –ø—Ä–æ–¥–∞–µ—Ç —Ç–µ–ª–µ—Ñ–æ–Ω—ã –±—ã—Å—Ç—Ä–æ, —É–∂–µ –µ—Å—Ç—å 5 —à—Ç—É–∫
  - Score = 10.0 √ó —Å–∫–æ—Ä–æ—Å—Ç—å - 15 √ó 5 = –≤—ã—Å–æ–∫–∏–π (–Ω–æ —à—Ç—Ä–∞—Ñ -75)
- **–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ë**: –ø—Ä–æ–¥–∞–µ—Ç –º–µ–¥–ª–µ–Ω–Ω–µ–µ, –Ω–æ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ –Ω–µ—Ç
  - Score = 10.0 √ó (–º–µ–Ω—å—à–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å) + 80 = –º–æ–∂–µ—Ç –ø–æ–±–µ–¥–∏—Ç—å –∑–∞ —Å—á–µ—Ç –±–æ–Ω—É—Å–∞!

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ú–æ–Ω–∏—Ç–æ—Ä—ã
- **–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ê**: —É–∂–µ 12 –º–æ–Ω–∏—Ç–æ—Ä–æ–≤ (–ø–µ—Ä–µ–≥—Ä—É–∑!)
  - –ë–∞–∑–æ–≤—ã–π —à—Ç—Ä–∞—Ñ: -15 √ó 12 = -180
  - –®—Ç—Ä–∞—Ñ –∑–∞ –ø–µ—Ä–µ–≥—Ä—É–∑: -(12-10) √ó 15 √ó 2.5 = -75
  - **–ò—Ç–æ–≥–æ —à—Ç—Ä–∞—Ñ: -255** ‚Üí –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –Ω–∏–∑–∫–∞—è
- **–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ë**: 3 –º–æ–Ω–∏—Ç–æ—Ä–∞, —Ö–æ—Ä–æ—à–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å
  - Score = 10.0 √ó —Å–∫–æ—Ä–æ—Å—Ç—å - 15 √ó 3 = -45 —à—Ç—Ä–∞—Ñ, –Ω–æ –≤—ã—Å–æ–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ—Ç

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ Streamlit

–í—ã –º–æ–∂–µ—Ç–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:
```bash
python3 -m streamlit run modern_bot/scripts/allocate_streamlit.py --server.port 8501
```

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

#### –î–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂ (—Ç–µ–∫—É—â–∏–µ):
- `velocity_weight`: 10.0
- `category_congestion_penalty`: 15.0
- `fairness_penalty`: 0.05

#### –î–ª—è –±–∞–ª–∞–Ω—Å–∞ –ø—Ä–æ–¥–∞–∂ + –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç:
- `velocity_weight`: 7.0
- `category_congestion_penalty`: 20.0
- `fairness_penalty`: 0.5

#### –î–ª—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–∞:
- `velocity_weight`: 5.0
- `category_congestion_penalty`: 25.0
- `empty_category_bonus`: 100.0
- `fairness_penalty`: 1.0

---

## üìà –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–ü–æ—Å–ª–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ.xlsx** ‚Üí –ª–∏—Å—Ç "–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ" ‚Äî –¥–µ—Ç–∞–ª–∏ –ø–æ –∫–∞–∂–¥–æ–º—É –∞—Ä—Ç–∏–∫—É–ª—É
2. **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ.xlsx** ‚Üí –ª–∏—Å—Ç "–ò—Ç–æ–≥ –ø–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è–º" ‚Äî —Å–≤–æ–¥–∫–∞
3. **logs/allocation_YYYYMMDD_HHMMSS.log** ‚Äî –¥–µ—Ç–∞–ª—å–Ω—ã–π –ª–æ–≥ —Å –ø—Ä–∏—á–∏–Ω–∞–º–∏ —Ä–µ—à–µ–Ω–∏–π

### –ß—Ç–æ —Å–º–æ—Ç—Ä–µ—Ç—å –≤ –ª–æ–≥–∞—Ö:
```
üèÜ –¢–æ–ø-3 –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –ø–æ —Å–∫–æ—Ä—É:
  #1: –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ_544 - score=95.23, velocity=12.50, coverage=2.3–Ω
  #2: –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ_123 - score=78.45, velocity=8.20, coverage=3.1–Ω
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ì–∞—à–µ–∫–∞ (#544)** ‚Äî —Å–∫–æ—Ä–æ—Å—Ç—å —É–º–Ω–æ–∂–∞–µ—Ç—Å—è –Ω–∞ 0.3 –∏–∑-–∑–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö–ø–µ—Ä–µ–∫—É–ø–æ–≤
2. **–ö–∞—Ç–µ–≥–æ—Ä–∏–∏** ‚Äî –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –∏–∑ –∫–æ–ª–æ–Ω–∫–∏ "–í–∏–¥ –ø—Ä–µ–¥–º–µ—Ç–∞" –≤ —Ä–µ–µ—Å—Ç—Ä–µ
3. **–ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π —à—Ç—Ä–∞—Ñ** ‚Äî —á–µ–º –±–æ–ª—å—à–µ –æ–¥–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, —Ç–µ–º —Å–∏–ª—å–Ω–µ–µ —à—Ç—Ä–∞—Ñ (–Ω–µ–ª–∏–Ω–µ–π–Ω–æ!)
4. **–ù–µ—Ç –ª–∏–º–∏—Ç–æ–≤** ‚Äî –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –º–æ–≥—É—Ç –ø–æ–ª—É—á–∏—Ç—å –ª—é–±–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ (–µ—Å–ª–∏ —Å–∫–æ—Ä–æ—Å—Ç—å –≤—ã—Å–æ–∫–∞—è)

---

## üéõÔ∏è –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –≠—Ñ—Ñ–µ–∫—Ç |
|----------|----------|--------|
| `velocity_weight` | 5-15 | –ß–µ–º –≤—ã—à–µ, —Ç–µ–º –≤–∞–∂–Ω–µ–µ —Å–∫–æ—Ä–æ—Å—Ç—å –ø—Ä–æ–¥–∞–∂ |
| `category_congestion_penalty` | 10-30 | –®—Ç—Ä–∞—Ñ –∑–∞ —Å–∫–æ–ø–ª–µ–Ω–∏–µ –æ–¥–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ |
| `empty_category_bonus` | 50-150 | –ë–æ–Ω—É—Å –∑–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–∞ |
| `fairness_penalty` | 0.01-2.0 | –°—Ç—Ä–µ–º–ª–µ–Ω–∏–µ –∫ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏ |
| `category_threshold` | 5-15 | –ü–æ—Ä–æ–≥ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ |

