# –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∞–ª–≥–æ—Ä–∏—Ç–º–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ

### üöÄ –ù–æ–≤–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è: –ú–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø—Ä–æ–¥–∞–∂
–ê–ª–≥–æ—Ä–∏—Ç–º –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ **—É–º–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏** –≤–º–µ—Å—Ç–æ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.

### üìù –û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

#### 1. AllocationConfig (allocate_auction.py)
```python
# –ë–´–õ–û (—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å):
velocity_weight: float = 0.3
fairness_penalty: float = 20.0
max_department_percentage: float = 0.06

# –°–¢–ê–õ–û (—Å–∫–æ—Ä–æ—Å—Ç—å + –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç):
velocity_weight: float = 10.0  # üöÄ –ü–†–ò–û–†–ò–¢–ï–¢
fairness_penalty: float = 0.05  # –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π
max_department_percentage: float = None  # —É–±—Ä–∞–ª–∏ –ª–∏–º–∏—Ç
```

#### 2. –£—Å–∏–ª–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–∞
```python
# –ù–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
category_congestion_penalty: float = 15.0  # —à—Ç—Ä–∞—Ñ –∑–∞ —Å–∫–æ–ø–ª–µ–Ω–∏–µ
empty_category_bonus: float = 80.0  # –±–æ–Ω—É—Å –∑–∞ –Ω–æ–≤—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é
category_threshold: int = 10  # –ø–æ—Ä–æ–≥ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏
category_overload_multiplier: float = 2.5  # –º–Ω–æ–∂–∏—Ç–µ–ª—å —à—Ç—Ä–∞—Ñ–∞
```

#### 3. –ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π —à—Ç—Ä–∞—Ñ –∑–∞ —Å–∫–æ–ø–ª–µ–Ω–∏–µ
- –ë–∞–∑–æ–≤—ã–π —à—Ç—Ä–∞—Ñ: `-15 √ó –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ`
- –ü–æ—Å–ª–µ 10 —à—Ç—É–∫: –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —à—Ç—Ä–∞—Ñ `√ó 2.5`
- –ü—Ä–∏–º–µ—Ä: 12 —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ = -180 (–±–∞–∑–æ–≤—ã–π) - 75 (–ø–µ—Ä–µ–≥—Ä—É–∑) = **-255**

#### 4. –£–±—Ä–∞–ª–∏ –∂–µ—Å—Ç–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- –£–¥–∞–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `max_per_dept_global`
- –ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è —Å –≤—ã—Å–æ–∫–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é –º–æ–≥—É—Ç –ø–æ–ª—É—á–∏—Ç—å —Å–∫–æ–ª—å–∫–æ —É–≥–æ–¥–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤

### üéõÔ∏è –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π Streamlit –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

–ù–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ:
- ‚úÖ –í–µ—Å —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø—Ä–æ–¥–∞–∂ (0-20, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10.0)
- ‚úÖ –®—Ç—Ä–∞—Ñ –∑–∞ —Å–∫–æ–ø–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (0-50, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 15.0)
- ‚úÖ –ë–æ–Ω—É—Å –∑–∞ –Ω–æ–≤—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é (0-200, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 80.0)
- ‚úÖ –ü–æ—Ä–æ–≥ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (3-20, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10)
- ‚úÖ –ú–Ω–æ–∂–∏—Ç–µ–ª—å —à—Ç—Ä–∞—Ñ–∞ –ø—Ä–∏ –ø–µ—Ä–µ–≥—Ä—É–∑–µ (1-5, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 2.5)
- ‚úÖ –í–µ—Å –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ (0-1, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0.15)
- ‚úÖ –î–µ–º–ø—Ñ–µ—Ä –¥–ª—è –ì–∞—à–µ–∫–∞ (0.1-1, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0.3)

---

## üéØ –ö–∞–∫ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã (–≤ –ø–æ—Ä—è–¥–∫–µ –≤–∞–∂–Ω–æ—Å—Ç–∏):
1. **–°–∫–æ—Ä–æ—Å—Ç—å –ø—Ä–æ–¥–∞–∂** (–≤–µ—Å 10.0) ‚Äî –≥–ª–∞–≤–Ω—ã–π —Ñ–∞–∫—Ç–æ—Ä
2. **–ê—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç** (–±–æ–Ω—É—Å +80 / —à—Ç—Ä–∞—Ñ –¥–æ -255) ‚Äî –∫–æ–Ω—Ç—Ä–æ–ª—å —Å–∫–æ–ø–ª–µ–Ω–∏—è
3. **–ú–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å** (–≤–µ—Å 0.15) ‚Äî –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–∞
4. **–ü–æ–∫—Ä—ã—Ç–∏–µ** (–≤–µ—Å 0.2) ‚Äî –¥–µ—Ñ–∏—Ü–∏—Ç –æ—Å—Ç–∞—Ç–∫–æ–≤
5. **–†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å** (–≤–µ—Å 0.05) ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ñ–∞–∫—Ç–æ—Ä

### –ü—Ä–∏–º–µ—Ä —Ä–∞—Å—á–µ—Ç–∞ score:
```
–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ê: 
- –°–∫–æ—Ä–æ—Å—Ç—å: 12 —à—Ç/–Ω–µ–¥ ‚Üí +120
- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ "–¢–µ–ª–µ—Ñ–æ–Ω" —É–∂–µ 8 —à—Ç ‚Üí -120
- –ú–∞—Ä–∂–∞ 500‚ÇΩ ‚Üí +75
- ‚Üí –ò–¢–û–ì–û: +75

–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ë:
- –°–∫–æ—Ä–æ—Å—Ç—å: 8 —à—Ç/–Ω–µ–¥ ‚Üí +80
- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ "–¢–µ–ª–µ—Ñ–æ–Ω" –Ω–µ—Ç ‚Üí +80
- –ú–∞—Ä–∂–∞ 500‚ÇΩ ‚Üí +75
- ‚Üí –ò–¢–û–ì–û: +235 (–ü–û–ë–ï–î–ò–¢–ï–õ–¨!)
```

---

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### ‚úÖ –î–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è:
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –ø—Ä–æ–¥–∞–∂
- –†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–π –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç –≤ –∫–∞–∂–¥–æ–º –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–∏
- –ù–µ—Ç —Å–∫–æ–ø–ª–µ–Ω–∏—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
- –£—á–µ—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º

### ‚ö†Ô∏è –ò–∑–º–µ–Ω–∏–ª–æ—Å—å:
- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ù–ï —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ (—ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ!)
- –ë—ã—Å—Ç—Ä–æ –ø—Ä–æ–¥–∞—é—â–∏–µ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –ø–æ–ª—É—á–∞—Ç –±–æ–ª—å—à–µ
- –ì–∞—à–µ–∫–∞ –ø–æ–ª—É—á–∏—Ç –º–µ–Ω—å—à–µ (–∫–æ—ç—Ñ—Ñ. 0.3)

---

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

### 1. Streamlit –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):
```bash
python3 -m streamlit run modern_bot/scripts/allocate_streamlit.py --server.port 8501
```
–û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:8501

### 2. –ö–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞:
```bash
python3 modern_bot/scripts/allocate_auction.py \
  --sales "–¢–∞–±–ª–∏—á–Ω–∞—è_—á–∞—Å—Ç—å_–ü—Ä–æ–¥–∞–∂–∏_—Ä–∞—Å–ø—Ä–æ–¥–∞–∂–∞_0109_311225.xlsx" \
  --stock "–æ—Å—Ç–∞—Ç–∫–∏ –Ω–∞ 301125.xlsx" \
  --auction "–†–µ–µ—Å—Ç—Ä –∞—É–∫—Ü–∏–æ–Ω–∞ 15.11 –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥.xlsx" \
  --out "—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ_–∞—É–∫—Ü–∏–æ–Ω.xlsx"
```

---

## üìù –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –í Excel —Ñ–∞–π–ª–µ:
1. **–õ–∏—Å—Ç "–ò—Ç–æ–≥ –ø–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è–º"** ‚Äî —Å–º–æ—Ç—Ä–∏–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
2. **–õ–∏—Å—Ç "–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ"** ‚Äî –¥–µ—Ç–∞–ª–∏ –ø–æ –∫–∞–∂–¥–æ–º—É —Ç–æ–≤–∞—Ä—É
3. –ö–æ–ª–æ–Ω–∫–∞ **"–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π"** ‚Äî –ø—Ä–∏—á–∏–Ω—ã –≤—ã–±–æ—Ä–∞ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è

### –í –ª–æ–≥–∞—Ö (logs/allocation_*.log):
```
üèÜ –¢–æ–ø-3 –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –ø–æ —Å–∫–æ—Ä—É:
  #1: –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ_544 - score=95.23, velocity=12.50
  #2: –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ_123 - score=78.45, velocity=8.20
  
‚úÖ –®—Ç—É–∫–∞ 1/5 ‚Üí –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ_544: 
   —Å–∫–æ—Ä=95.23, velocity=12.50/–Ω–µ–¥, –ø–æ–∫—Ä—ã—Ç–∏–µ=2.3–Ω
```

---

## üîß –¢–æ–Ω–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

–°–º. —Ñ–∞–π–ª [`–Ω–∞—Å—Ç—Ä–æ–π–∫–∞_—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.md`](–Ω–∞—Å—Ç—Ä–æ–π–∫–∞_—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.md) –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.

### –ë—ã—Å—Ç—Ä—ã–µ –ø—Ä–µ—Å–µ—Ç—ã:

**–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏ (—Ç–µ–∫—É—â–∏–µ):**
- velocity_weight: 10.0
- category_congestion_penalty: 15.0
- fairness_penalty: 0.05

**–ë–∞–ª–∞–Ω—Å –ø—Ä–æ–¥–∞–∂ + –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç:**
- velocity_weight: 7.0
- category_congestion_penalty: 20.0
- fairness_penalty: 0.5

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–∞:**
- velocity_weight: 5.0
- category_congestion_penalty: 25.0
- empty_category_bonus: 100.0
