{\rtf1\ansi\ansicpg1251\cocoartf2821
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fnil\fcharset0 HelveticaNeue;\f1\fnil\fcharset0 Menlo-Regular;}
{\colortbl;\red255\green255\blue255;\red89\green138\blue67;\red24\green24\blue24;\red193\green193\blue193;
\red183\green111\blue179;\red67\green192\blue160;\red212\green214\blue154;\red140\green211\blue254;\red202\green202\blue202;
\red194\green126\blue101;\red70\green137\blue204;\red167\green197\blue152;\red66\green179\blue255;}
{\*\expandedcolortbl;;\cssrgb\c41569\c60000\c33333;\cssrgb\c12157\c12157\c12157;\cssrgb\c80000\c80000\c80000;
\cssrgb\c77255\c52549\c75294;\cssrgb\c30588\c78824\c69020;\cssrgb\c86275\c86275\c66667;\cssrgb\c61176\c86275\c99608;\cssrgb\c83137\c83137\c83137;
\cssrgb\c80784\c56863\c47059;\cssrgb\c33725\c61176\c83922;\cssrgb\c70980\c80784\c65882;\cssrgb\c30980\c75686\c100000;}
\paperw11900\paperh16840\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\deftab560
\pard\pardeftab560\slleading20\partightenfactor0

\f0\fs26 \cf0 \uc0\u1060 \u1072 \u1081 \u1083 : main.py\
\
\'b4\'b4\'b4python\
\pard\pardeftab720\partightenfactor0

\f1\fs24 \cf2 \cb3 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 # main.py\cf4 \cb1 \strokec4 \
\
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 streamlit\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf6 \strokec6 st\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 numpy\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf6 \strokec6 np\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 pandas\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf6 \strokec6 pd\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 os\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 joblib\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 yaml\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 json\cf4 \cb1 \strokec4 \
\
\cf5 \cb3 \strokec5 from\cf4 \strokec4  \cf6 \strokec6 data_model\cf4 \strokec4  \cf5 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 WarehouseParams\cf4 \strokec4 , \cf7 \strokec7 validate_inputs\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 from\cf4 \strokec4  \cf6 \strokec6 calculations\cf4 \strokec4  \cf5 \strokec5 import\cf4 \strokec4  (\cb1 \
\cb3     \cf7 \strokec7 calculate_additional_metrics\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 calculate_roi\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 calculate_irr\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 calculate_total_bep\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 monte_carlo_simulation\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 calculate_financials\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 min_loan_amount_for_bep\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 calculate_monthly_bep\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 calculate_areas\cf4 \strokec4 ,\cb1 \
\cb3 )\cb1 \
\cf5 \cb3 \strokec5 from\cf4 \strokec4  \cf6 \strokec6 utils\cf4 \strokec4  \cf5 \strokec5 import\cf4 \strokec4  (\cb1 \
\cb3     \cf7 \strokec7 normalize_shares\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 load_params_from_file\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 save_params_to_file\cf4 \strokec4 ,\cb1 \
\cb3 )\cb1 \
\cf5 \cb3 \strokec5 from\cf4 \strokec4  \cf6 \strokec6 ui\cf4 \strokec4  \cf5 \strokec5 import\cf4 \strokec4  (\cb1 \
\cb3     \cf7 \strokec7 display_tab1\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 display_tab2_header\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 display_tab2_basic_forecast\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 display_tab2_ml_forecast\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 display_tab2_monte_carlo\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 display_tab3_header\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 display_tab3_bep_info\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 display_tab3_monthly_bep\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 display_tab3_sensitivity\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 display_tab4_header\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 display_tab4_area_metrics\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 display_tab4_storage_table\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 display_tab4_profit_table\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 display_tab4_results\cf4 \strokec4 ,\cb1 \
\cb3 )\cb1 \
\cf5 \cb3 \strokec5 from\cf4 \strokec4  \cf6 \strokec6 ml_models\cf4 \strokec4  \cf5 \strokec5 import\cf4 \strokec4  \cf7 \strokec7 prepare_ml_data\cf4 \strokec4 , \cf7 \strokec7 load_ml_model\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 from\cf4 \strokec4  \cf6 \strokec6 app_state\cf4 \strokec4  \cf5 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 AppState\cf4 \cb1 \strokec4 \
\
\
\cf2 \cb3 \strokec2 # \uc0\u1053 \u1072 \u1089 \u1090 \u1088 \u1072 \u1080 \u1074 \u1072 \u1077 \u1084  \u1089 \u1090 \u1088 \u1072 \u1085 \u1080 \u1094 \u1091 \cf4 \cb1 \strokec4 \
\cf6 \cb3 \strokec6 st\cf4 \strokec4 .\cf7 \strokec7 set_page_config\cf4 \strokec4 (\cf8 \strokec8 page_title\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1069 \u1082 \u1086 \u1085 \u1086 \u1084 \u1080 \u1095 \u1077 \u1089 \u1082 \u1072 \u1103  \u1084 \u1086 \u1076 \u1077 \u1083 \u1100  \u1089 \u1082 \u1083 \u1072 \u1076 \u1072  \u55357 \u56550 "\cf4 \strokec4 , \cf8 \strokec8 layout\cf9 \strokec9 =\cf10 \strokec10 "wide"\cf4 \strokec4 )\cb1 \
\
\cf2 \cb3 \strokec2 # \uc0\u1047 \u1072 \u1075 \u1086 \u1083 \u1086 \u1074 \u1086 \u1082 \cf4 \cb1 \strokec4 \
\cf6 \cb3 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 markdown\cf4 \strokec4 (\cf10 \strokec10 "# \uc0\u1069 \u1082 \u1086 \u1085 \u1086 \u1084 \u1080 \u1095 \u1077 \u1089 \u1082 \u1072 \u1103  \u1084 \u1086 \u1076 \u1077 \u1083 \u1100  \u1089 \u1082 \u1083 \u1072 \u1076 \u1072  (\u1085 \u1072  \u1088 \u1091 \u1089 \u1089 \u1082 \u1086 \u1084  \u1103 \u1079 \u1099 \u1082 \u1077 )"\cf4 \strokec4 )\cb1 \
\cf6 \cb3 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 markdown\cf4 \strokec4 (\cb1 \
\cb3     \cf10 \strokec10 "\uc0\u1042 \u1089 \u1077  \u1088 \u1072 \u1089 \u1095 \u1105 \u1090 \u1099  \u1074 \u1099 \u1087 \u1086 \u1083 \u1085 \u1103 \u1102 \u1090 \u1089 \u1103  \u1072 \u1074 \u1090 \u1086 \u1084 \u1072 \u1090 \u1080 \u1095 \u1077 \u1089 \u1082 \u1080  \u1087 \u1088 \u1080  \u1080 \u1079 \u1084 \u1077 \u1085 \u1077 \u1085 \u1080 \u1080  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1086 \u1074  \u1074  \u1073 \u1086 \u1082 \u1086 \u1074 \u1086 \u1081  \u1087 \u1072 \u1085 \u1077 \u1083 \u1080 . "\cf4 \cb1 \strokec4 \
\cb3     \cf10 \strokec10 "\uc0\u1055 \u1088 \u1086 \u1089 \u1090 \u1086  \u1084 \u1077 \u1085 \u1103 \u1081 \u1090 \u1077  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1099  \'97 \u1088 \u1077 \u1079 \u1091 \u1083 \u1100 \u1090 \u1072 \u1090 \u1099  \u1086 \u1073 \u1085 \u1086 \u1074 \u1103 \u1090 \u1089 \u1103 ."\cf4 \cb1 \strokec4 \
\cb3 )\cb1 \
\
\cf2 \cb3 \strokec2 # \uc0\u1048 \u1085 \u1080 \u1094 \u1080 \u1072 \u1083 \u1080 \u1079 \u1080 \u1088 \u1091 \u1077 \u1084  \u1089 \u1086 \u1089 \u1090 \u1086 \u1103 \u1085 \u1080 \u1077 \cf4 \cb1 \strokec4 \
\cf8 \cb3 \strokec8 app_state\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 AppState\cf4 \strokec4 ()\cb1 \
\
\cf2 \cb3 \strokec2 # \uc0\u1047 \u1072 \u1075 \u1088 \u1091 \u1078 \u1072 \u1077 \u1084  default_params\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 with\cf4 \strokec4  \cf7 \strokec7 open\cf4 \strokec4 (\cf10 \strokec10 "config.yaml"\cf4 \strokec4 , \cf10 \strokec10 "r"\cf4 \strokec4 ) \cf5 \strokec5 as\cf4 \strokec4  \cf8 \strokec8 f\cf4 \strokec4 :\cb1 \
\cb3     \cf8 \strokec8 config\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 yaml\cf4 \strokec4 .\cf7 \strokec7 safe_load\cf4 \strokec4 (\cf8 \strokec8 f\cf4 \strokec4 )\cb1 \
\cf8 \cb3 \strokec8 default_params\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 config\cf4 \strokec4 [\cf10 \strokec10 "default_params"\cf4 \strokec4 ]\cb1 \
\
\cf2 \cb3 \strokec2 # \uc0\u1048 \u1079 \u1074 \u1083 \u1077 \u1082 \u1072 \u1077 \u1084  forecast_method (\u1077 \u1089 \u1083 \u1080  None, \u1073 \u1077 \u1088 \u1105 \u1084  "\u1041 \u1072 \u1079 \u1086 \u1074 \u1099 \u1081 ")\cf4 \cb1 \strokec4 \
\cf8 \cb3 \strokec8 selected_forecast_method\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "forecast_method"\cf4 \strokec4 ) \cf11 \strokec11 or\cf4 \strokec4  \cf10 \strokec10 "\uc0\u1041 \u1072 \u1079 \u1086 \u1074 \u1099 \u1081 "\cf4 \cb1 \strokec4 \
\cf2 \cb3 \strokec2 # poly_degree \uc0\u1090 \u1072 \u1082 \u1078 \u1077 , \u1077 \u1089 \u1083 \u1080  None, \u1090 \u1086  = 2\cf4 \cb1 \strokec4 \
\cf8 \cb3 \strokec8 poly_degree\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "poly_degree"\cf4 \strokec4 ) \cf11 \strokec11 or\cf4 \strokec4  \cf12 \strokec12 2\cf4 \cb1 \strokec4 \
\
\cf8 \cb3 \strokec8 df_for_ml\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "df_for_ml"\cf4 \strokec4 )\cb1 \
\cf8 \cb3 \strokec8 ml_model\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "ml_model"\cf4 \strokec4 )\cb1 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 reset_params\cf4 \strokec4 ():\cb1 \
\cb3     \cf10 \strokec10 """\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     \uc0\u1057 \u1073 \u1088 \u1072 \u1089 \u1099 \u1074 \u1072 \u1077 \u1090  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1099  \u1082  \u1079 \u1085 \u1072 \u1095 \u1077 \u1085 \u1080 \u1103 \u1084  \u1087 \u1086  \u1091 \u1084 \u1086 \u1083 \u1095 \u1072 \u1085 \u1080 \u1102  \u1080 \u1079  config.yaml.\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     """\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 for\cf4 \strokec4  \cf8 \strokec8 key\cf4 \strokec4 , \cf8 \strokec8 value\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 default_params\cf4 \strokec4 .items():\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf8 \strokec8 key\cf4 \strokec4 , \cf8 \strokec8 value\cf4 \strokec4 )\cb1 \
\cb3     \cf8 \strokec8 app_state\cf4 \strokec4 .\cf8 \strokec8 shares\cf4 \strokec4 .update(\cb1 \
\cb3         \{\cb1 \
\cb3             \cf10 \strokec10 "storage_share"\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \strokec4 (\cf8 \strokec8 default_params\cf4 \strokec4 [\cf10 \strokec10 "storage_share"\cf4 \strokec4 ]),\cb1 \
\cb3             \cf10 \strokec10 "loan_share"\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \strokec4 (\cf8 \strokec8 default_params\cf4 \strokec4 [\cf10 \strokec10 "loan_share"\cf4 \strokec4 ]),\cb1 \
\cb3             \cf10 \strokec10 "vip_share"\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \strokec4 (\cf8 \strokec8 default_params\cf4 \strokec4 [\cf10 \strokec10 "vip_share"\cf4 \strokec4 ]),\cb1 \
\cb3             \cf10 \strokec10 "short_term_share"\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \strokec4 (\cf8 \strokec8 default_params\cf4 \strokec4 [\cf10 \strokec10 "short_term_share"\cf4 \strokec4 ]),\cb1 \
\cb3         \}\cb1 \
\cb3     )\cb1 \
\cb3     \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 session_state\cf4 \strokec4 [\cf10 \strokec10 "uploaded_file"\cf4 \strokec4 ] \cf9 \strokec9 =\cf4 \strokec4  \cf11 \strokec11 None\cf4 \cb1 \strokec4 \
\cb3     \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 session_state\cf4 \strokec4 [\cf10 \strokec10 "df_for_ml"\cf4 \strokec4 ] \cf9 \strokec9 =\cf4 \strokec4  \cf11 \strokec11 None\cf4 \cb1 \strokec4 \
\cb3     \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 session_state\cf4 \strokec4 [\cf10 \strokec10 "ml_model"\cf4 \strokec4 ] \cf9 \strokec9 =\cf4 \strokec4  \cf11 \strokec11 None\cf4 \cb1 \strokec4 \
\cb3     \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 session_state\cf4 \strokec4 [\cf10 \strokec10 "forecast_method"\cf4 \strokec4 ] \cf9 \strokec9 =\cf4 \strokec4  \cf10 \strokec10 "\uc0\u1041 \u1072 \u1079 \u1086 \u1074 \u1099 \u1081 "\cf4 \cb1 \strokec4 \
\cb3     \cf6 \strokec6 st\cf4 \strokec4 .\cf7 \strokec7 rerun\cf4 \strokec4 ()\cb1 \
\
\
\cf2 \cb3 \strokec2 # \uc0\u1057 \u1095 \u1080 \u1090 \u1099 \u1074 \u1072 \u1077 \u1084  query_params, \u1077 \u1089 \u1083 \u1080  \u1077 \u1089 \u1090 \u1100 \cf4 \cb1 \strokec4 \
\cf8 \cb3 \strokec8 query_params\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 query_params\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 query_params\cf4 \strokec4 :\cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  \cf10 \strokec10 "params"\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 query_params\cf4 \strokec4 :\cb1 \
\cb3         \cf5 \strokec5 try\cf4 \strokec4 :\cb1 \
\cb3             \cf8 \strokec8 loaded_params\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 json\cf4 \strokec4 .\cf7 \strokec7 loads\cf4 \strokec4 (\cf8 \strokec8 query_params\cf4 \strokec4 [\cf10 \strokec10 "params"\cf4 \strokec4 ])\cb1 \
\cb3             \cf5 \strokec5 for\cf4 \strokec4  \cf8 \strokec8 key\cf4 \strokec4 , \cf8 \strokec8 value\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 loaded_params\cf4 \strokec4 .items():\cb1 \
\cb3                 \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 key\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 default_params\cf4 \strokec4 :\cb1 \
\cb3                     \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf8 \strokec8 key\cf4 \strokec4 , \cf8 \strokec8 value\cf4 \strokec4 )\cb1 \
\cb3             \cf5 \strokec5 if\cf4 \strokec4  \cf10 \strokec10 "shares"\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 loaded_params\cf4 \strokec4 :\cb1 \
\cb3                 \cf8 \strokec8 app_state\cf4 \strokec4 .\cf8 \strokec8 shares\cf4 \strokec4 .update(\cf8 \strokec8 loaded_params\cf4 \strokec4 [\cf10 \strokec10 "shares"\cf4 \strokec4 ])\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 success\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1055 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1099  \u1091 \u1089 \u1087 \u1077 \u1096 \u1085 \u1086  \u1079 \u1072 \u1075 \u1088 \u1091 \u1078 \u1077 \u1085 \u1099  \u1080 \u1079  URL."\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 except\cf4 \strokec4  \cf6 \strokec6 Exception\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf8 \strokec8 e\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 error\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1054 \u1096 \u1080 \u1073 \u1082 \u1072  \u1079 \u1072 \u1075 \u1088 \u1091 \u1079 \u1082 \u1080  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1086 \u1074  \u1080 \u1079  URL: \cf11 \strokec11 \{\cf8 \strokec8 e\cf11 \strokec11 \}\cf10 \strokec10 "\cf4 \strokec4 )\cb1 \
\
\cf2 \cb3 \strokec2 # \uc0\u1041 \u1086 \u1082 \u1086 \u1074 \u1072 \u1103  \u1087 \u1072 \u1085 \u1077 \u1083 \u1100 \cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 with\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 sidebar\cf4 \strokec4 :\cb1 \
\cb3     \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 markdown\cf4 \strokec4 (\cf10 \strokec10 "## \uc0\u1042 \u1074 \u1086 \u1076  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1086 \u1074 "\cf4 \strokec4 )\cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 button\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u55357 \u56580  \u1057 \u1073 \u1088 \u1086 \u1089 \u1080 \u1090 \u1100  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1099 "\cf4 \strokec4 ):\cb1 \
\cb3         \cf7 \strokec7 reset_params\cf4 \strokec4 ()\cb1 \
\
\cb3     \cf2 \strokec2 # --- \uc0\u1054 \u1089 \u1085 \u1086 \u1074 \u1085 \u1099 \u1077  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1099  \u1089 \u1082 \u1083 \u1072 \u1076 \u1072  ---\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 sidebar\cf4 \strokec4 .\cf7 \strokec7 expander\cf4 \strokec4 (\cf10 \strokec10 "### \uc0\u1054 \u1089 \u1085 \u1086 \u1074 \u1085 \u1099 \u1077  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1099  \u1089 \u1082 \u1083 \u1072 \u1076 \u1072 "\cf4 \strokec4 ):\cb1 \
\cb3         \cf8 \strokec8 total_area\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u55357 \u56527  \u1054 \u1073 \u1097 \u1072 \u1103  \u1087 \u1083 \u1086 \u1097 \u1072 \u1076 \u1100  (\u1084 \'b2)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "total_area"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 10\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %i\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1054 \u1073 \u1097 \u1072 \u1103  \u1072 \u1088 \u1077 \u1085 \u1076 \u1091 \u1077 \u1084 \u1072 \u1103  \u1087 \u1083 \u1086 \u1097 \u1072 \u1076 \u1100  \u1089 \u1082 \u1083 \u1072 \u1076 \u1072  \u1074  \u1082 \u1074 \u1072 \u1076 \u1088 \u1072 \u1090 \u1085 \u1099 \u1093  \u1084 \u1077 \u1090 \u1088 \u1072 \u1093 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "total_area"\cf4 \strokec4 , \cf8 \strokec8 total_area\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 total_area\cf4 \strokec4  \cf9 \strokec9 <=\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 error\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1054 \u1073 \u1097 \u1072 \u1103  \u1087 \u1083 \u1086 \u1097 \u1072 \u1076 \u1100  \u1076 \u1086 \u1083 \u1078 \u1085 \u1072  \u1073 \u1099 \u1090 \u1100  \u1073 \u1086 \u1083 \u1100 \u1096 \u1077  \u1085 \u1091 \u1083 \u1103 ."\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 rental_cost_per_m2\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u55357 \u56496  \u1057 \u1090 \u1086 \u1080 \u1084 \u1086 \u1089 \u1090 \u1100  \u1072 \u1088 \u1077 \u1085 \u1076 \u1099  (\u1088 \u1091 \u1073 ./\u1084 \'b2/\u1084 \u1077 \u1089 .)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "rental_cost_per_m2"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 50\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %i\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1045 \u1078 \u1077 \u1084 \u1077 \u1089 \u1103 \u1095 \u1085 \u1072 \u1103  \u1072 \u1088 \u1077 \u1085 \u1076 \u1072  \u1079 \u1072  \u1086 \u1076 \u1080 \u1085  \u1082 \u1074 \u1072 \u1076 \u1088 \u1072 \u1090 \u1085 \u1099 \u1081  \u1084 \u1077 \u1090 \u1088 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "rental_cost_per_m2"\cf4 \strokec4 , \cf8 \strokec8 rental_cost_per_m2\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 rental_cost_per_m2\cf4 \strokec4  \cf9 \strokec9 <=\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 error\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1057 \u1090 \u1086 \u1080 \u1084 \u1086 \u1089 \u1090 \u1100  \u1072 \u1088 \u1077 \u1085 \u1076 \u1099  \u1076 \u1086 \u1083 \u1078 \u1085 \u1072  \u1073 \u1099 \u1090 \u1100  \u1073 \u1086 \u1083 \u1100 \u1096 \u1077  \u1085 \u1091 \u1083 \u1103 ."\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 useful_area_ratio_slider\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 slider\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u55357 \u56528  \u1044 \u1086 \u1083 \u1103  \u1087 \u1086 \u1083 \u1077 \u1079 \u1085 \u1086 \u1081  \u1087 \u1083 \u1086 \u1097 \u1072 \u1076 \u1080  (%)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf12 \strokec12 40\cf4 \strokec4 ,\cb1 \
\cb3             \cf12 \strokec12 80\cf4 \strokec4 ,\cb1 \
\cb3             \cf6 \strokec6 int\cf4 \strokec4 (\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "useful_area_ratio"\cf4 \strokec4 ) \cf9 \strokec9 *\cf4 \strokec4  \cf12 \strokec12 100\cf4 \strokec4 ),\cb1 \
\cb3             \cf12 \strokec12 5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1055 \u1088 \u1086 \u1094 \u1077 \u1085 \u1090  \u1087 \u1086 \u1083 \u1077 \u1079 \u1085 \u1086 \u1081  \u1087 \u1083 \u1086 \u1097 \u1072 \u1076 \u1080  \u1086 \u1090  \u1086 \u1073 \u1097 \u1077 \u1081  \u1087 \u1083 \u1086 \u1097 \u1072 \u1076 \u1080  \u1089 \u1082 \u1083 \u1072 \u1076 \u1072 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 useful_area_ratio\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 useful_area_ratio_slider\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf12 \strokec12 100.0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "useful_area_ratio"\cf4 \strokec4 , \cf8 \strokec8 useful_area_ratio\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf11 \strokec11 not\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4  \cf9 \strokec9 <\cf4 \strokec4  \cf8 \strokec8 useful_area_ratio\cf4 \strokec4  \cf9 \strokec9 <=\cf4 \strokec4  \cf12 \strokec12 1\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 error\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1044 \u1086 \u1083 \u1103  \u1087 \u1086 \u1083 \u1077 \u1079 \u1085 \u1086 \u1081  \u1087 \u1083 \u1086 \u1097 \u1072 \u1076 \u1080  \u1076 \u1086 \u1083 \u1078 \u1085 \u1072  \u1073 \u1099 \u1090 \u1100  \u1084 \u1077 \u1078 \u1076 \u1091  0 \u1080  100%."\cf4 \strokec4 )\cb1 \
\
\cb3     \cf2 \strokec2 # --- \uc0\u1056 \u1072 \u1089 \u1087 \u1088 \u1077 \u1076 \u1077 \u1083 \u1077 \u1085 \u1080 \u1077  \u1087 \u1083 \u1086 \u1097 \u1072 \u1076 \u1080  ---\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 sidebar\cf4 \strokec4 .\cf7 \strokec7 expander\cf4 \strokec4 (\cf10 \strokec10 "### \uc0\u1056 \u1072 \u1089 \u1087 \u1088 \u1077 \u1076 \u1077 \u1083 \u1077 \u1085 \u1080 \u1077  \u1087 \u1083 \u1086 \u1097 \u1072 \u1076 \u1080 "\cf4 \strokec4 ):\cb1 \
\cb3         \cf8 \strokec8 mode\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 radio\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1056 \u1077 \u1078 \u1080 \u1084  \u1088 \u1072 \u1089 \u1087 \u1088 \u1077 \u1076 \u1077 \u1083 \u1077 \u1085 \u1080 \u1103  \u1087 \u1083 \u1086 \u1097 \u1072 \u1076 \u1080 "\cf4 \strokec4 , [\cf10 \strokec10 "\uc0\u1056 \u1091 \u1095 \u1085 \u1086 \u1081 "\cf4 \strokec4 ], \cf8 \strokec8 index\cf9 \strokec9 =\cf12 \strokec12 0\cf4 \strokec4 )\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 markdown\cf4 \strokec4 (\cf10 \strokec10 "#### \uc0\u1056 \u1091 \u1095 \u1085 \u1086 \u1081  \u1074 \u1074 \u1086 \u1076  \u1087 \u1083 \u1086 \u1097 \u1072 \u1076 \u1077 \u1081  (\u1084 \'b2)"\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 temp_usable\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 total_area\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 useful_area_ratio\cf4 \cb1 \strokec4 \
\
\cb3         \cf8 \strokec8 storage_area_manual\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1055 \u1088 \u1086 \u1089 \u1090 \u1086 \u1077  (\u1084 \'b2)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "storage_area_manual"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 10.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %.2f\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1055 \u1083 \u1086 \u1097 \u1072 \u1076 \u1100  \u1087 \u1086 \u1076  \u1087 \u1088 \u1086 \u1089 \u1090 \u1086 \u1077  \u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1077 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "storage_area_manual"\cf4 \strokec4 , \cf8 \strokec8 storage_area_manual\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 storage_area_manual\cf4 \strokec4  \cf9 \strokec9 <\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 error\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1055 \u1083 \u1086 \u1097 \u1072 \u1076 \u1100  \u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1103  \u1076 \u1086 \u1083 \u1078 \u1085 \u1072  \u1073 \u1099 \u1090 \u1100  \u8805  0."\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 loan_area_manual\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1047 \u1072 \u1081 \u1084 \u1099  (\u1084 \'b2)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "loan_area_manual"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 10.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %.2f\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1055 \u1083 \u1086 \u1097 \u1072 \u1076 \u1100  \u1087 \u1086 \u1076  \u1079 \u1072 \u1081 \u1084 \u1099 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "loan_area_manual"\cf4 \strokec4 , \cf8 \strokec8 loan_area_manual\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 loan_area_manual\cf4 \strokec4  \cf9 \strokec9 <\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 error\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1055 \u1083 \u1086 \u1097 \u1072 \u1076 \u1100  \u1087 \u1086 \u1076  \u1079 \u1072 \u1081 \u1084 \u1099  \u1076 \u1086 \u1083 \u1078 \u1085 \u1072  \u1073 \u1099 \u1090 \u1100  \u8805  0."\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 vip_area_manual\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "VIP (\uc0\u1084 \'b2)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "vip_area_manual"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 10.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %.2f\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1055 \u1083 \u1086 \u1097 \u1072 \u1076 \u1100  \u1087 \u1086 \u1076  VIP-\u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1077 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "vip_area_manual"\cf4 \strokec4 , \cf8 \strokec8 vip_area_manual\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 vip_area_manual\cf4 \strokec4  \cf9 \strokec9 <\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 error\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1055 \u1083 \u1086 \u1097 \u1072 \u1076 \u1100  VIP \u1076 \u1086 \u1083 \u1078 \u1085 \u1072  \u1073 \u1099 \u1090 \u1100  \u8805  0."\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 short_term_area_manual\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1050 \u1088 \u1072 \u1090 \u1082 \u1086 \u1089 \u1088 \u1086 \u1095 \u1085 \u1086 \u1077  (\u1084 \'b2)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "short_term_area_manual"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 10.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %.2f\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1055 \u1083 \u1086 \u1097 \u1072 \u1076 \u1100  \u1087 \u1086 \u1076  \u1082 \u1088 \u1072 \u1090 \u1082 \u1086 \u1089 \u1088 \u1086 \u1095 \u1085 \u1086 \u1077  \u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1077 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "short_term_area_manual"\cf4 \strokec4 , \cf8 \strokec8 short_term_area_manual\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 short_term_area_manual\cf4 \strokec4  \cf9 \strokec9 <\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 error\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1055 \u1083 \u1086 \u1097 \u1072 \u1076 \u1100  \u1082 \u1088 \u1072 \u1090 \u1082 \u1086 \u1089 \u1088 \u1086 \u1095 \u1085 \u1086 \u1075 \u1086  \u1076 \u1086 \u1083 \u1078 \u1085 \u1072  \u1073 \u1099 \u1090 \u1100  \u8805  0."\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 total_manual_set\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cb1 \
\cb3             \cf8 \strokec8 storage_area_manual\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 loan_area_manual\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 vip_area_manual\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 short_term_area_manual\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 leftover\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 temp_usable\cf4 \strokec4  \cf9 \strokec9 -\cf4 \strokec4  \cf8 \strokec8 total_manual_set\cf4 \cb1 \strokec4 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 write\cf4 \strokec4 (\cb1 \
\cb3             \cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1053 \u1077  \u1088 \u1072 \u1089 \u1087 \u1088 \u1077 \u1076 \u1077 \u1083 \u1077 \u1085 \u1086 : \cf11 \strokec11 \{\cf8 \strokec8 leftover\cf11 \strokec11 :.2f\}\cf10 \strokec10  \uc0\u1084 \'b2 \u1080 \u1079  \cf11 \strokec11 \{\cf8 \strokec8 temp_usable\cf11 \strokec11 :.2f\}\cf10 \strokec10  \uc0\u1084 \'b2 \u1087 \u1086 \u1083 \u1077 \u1079 \u1085 \u1086 \u1081  \u1087 \u1083 \u1086 \u1097 \u1072 \u1076 \u1080 ."\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\
\cb3     \cf2 \strokec2 # --- \uc0\u1058 \u1072 \u1088 \u1080 \u1092 \u1099  \u1080  \u1087 \u1083 \u1086 \u1090 \u1085 \u1086 \u1089 \u1090 \u1080  ---\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 sidebar\cf4 \strokec4 .\cf7 \strokec7 expander\cf4 \strokec4 (\cf10 \strokec10 "### \uc0\u1058 \u1072 \u1088 \u1080 \u1092 \u1099  \u1080  \u1087 \u1083 \u1086 \u1090 \u1085 \u1086 \u1089 \u1090 \u1080 "\cf4 \strokec4 ):\cb1 \
\cb3         \cf8 \strokec8 storage_fee\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u55357 \u56499  \u1058 \u1072 \u1088 \u1080 \u1092  \u1087 \u1088 \u1086 \u1089 \u1090 \u1086 \u1075 \u1086  (\u1088 \u1091 \u1073 ./\u1084 \'b2/\u1084 \u1077 \u1089 .)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "storage_fee"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %i\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1045 \u1078 \u1077 \u1084 \u1077 \u1089 \u1103 \u1095 \u1085 \u1099 \u1081  \u1090 \u1072 \u1088 \u1080 \u1092  \u1079 \u1072  \u1087 \u1088 \u1086 \u1089 \u1090 \u1086 \u1081  \u1089 \u1082 \u1083 \u1072 \u1076  (\u1088 \u1091 \u1073 ./\u1084 \'b2)."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "storage_fee"\cf4 \strokec4 , \cf8 \strokec8 storage_fee\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 storage_fee\cf4 \strokec4  \cf9 \strokec9 <\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 error\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1058 \u1072 \u1088 \u1080 \u1092  \u1087 \u1088 \u1086 \u1089 \u1090 \u1086 \u1075 \u1086  \u1076 \u1086 \u1083 \u1078 \u1077 \u1085  \u1073 \u1099 \u1090 \u1100  \u8805  0."\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 shelves_per_m2\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u55357 \u56538  \u1055 \u1086 \u1083 \u1086 \u1082  \u1085 \u1072  1 \u1084 \'b2"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "shelves_per_m2"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 max_value\cf9 \strokec9 =\cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %i\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1050 \u1086 \u1083 \u1080 \u1095 \u1077 \u1089 \u1090 \u1074 \u1086  \u1087 \u1086 \u1083 \u1086 \u1082  \u1085 \u1072  1 \u1084 \'b2."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "shelves_per_m2"\cf4 \strokec4 , \cf8 \strokec8 shelves_per_m2\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 shelves_per_m2\cf4 \strokec4  \cf9 \strokec9 <\cf4 \strokec4  \cf12 \strokec12 1\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 error\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1050 \u1086 \u1083 \u1080 \u1095 \u1077 \u1089 \u1090 \u1074 \u1086  \u1087 \u1086 \u1083 \u1086 \u1082  \u1076 \u1086 \u1083 \u1078 \u1085 \u1086  \u1073 \u1099 \u1090 \u1100  \u8805  1"\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 short_term_daily_rate\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u55357 \u56658  \u1058 \u1072 \u1088 \u1080 \u1092  \u1082 \u1088 \u1072 \u1090 \u1082 \u1086 \u1089 \u1088 \u1086 \u1095 \u1085 \u1086 \u1075 \u1086  (\u1088 \u1091 \u1073 ./\u1076 \u1077 \u1085 \u1100 /\u1084 \'b2)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "short_term_daily_rate"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 10.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %.2f\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1058 \u1072 \u1088 \u1080 \u1092  \u1079 \u1072  1 \u1084 \'b2 \u1082 \u1088 \u1072 \u1090 \u1082 \u1086 \u1089 \u1088 \u1086 \u1095 \u1085 \u1086 \u1075 \u1086  \u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1103  \u1074  \u1076 \u1077 \u1085 \u1100 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "short_term_daily_rate"\cf4 \strokec4 , \cf8 \strokec8 short_term_daily_rate\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 short_term_daily_rate\cf4 \strokec4  \cf9 \strokec9 <\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 error\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1058 \u1072 \u1088 \u1080 \u1092  \u1082 \u1088 \u1072 \u1090 \u1082 \u1086 \u1089 \u1088 \u1086 \u1095 \u1085 \u1086 \u1075 \u1086  \u1076 \u1086 \u1083 \u1078 \u1077 \u1085  \u1073 \u1099 \u1090 \u1100  \u8805  0."\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 vip_extra_fee\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u55357 \u56401  \u1053 \u1072 \u1094 \u1077 \u1085 \u1082 \u1072  VIP (\u1088 \u1091 \u1073 ./\u1084 \'b2/\u1084 \u1077 \u1089 .)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "vip_extra_fee"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 50.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %.2f\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1053 \u1072 \u1094 \u1077 \u1085 \u1082 \u1072  \u1076 \u1083 \u1103  VIP (\u1088 \u1091 \u1073 ./\u1084 \'b2)."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "vip_extra_fee"\cf4 \strokec4 , \cf8 \strokec8 vip_extra_fee\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 vip_extra_fee\cf4 \strokec4  \cf9 \strokec9 <\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 error\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1053 \u1072 \u1094 \u1077 \u1085 \u1082 \u1072  VIP \u1076 \u1086 \u1083 \u1078 \u1085 \u1072  \u1073 \u1099 \u1090 \u1100  \u8805  0."\cf4 \strokec4 )\cb1 \
\
\cb3     \cf2 \strokec2 # --- \uc0\u1054 \u1094 \u1077 \u1085 \u1082 \u1072  \u1080  \u1079 \u1072 \u1081 \u1084 \u1099  ---\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 sidebar\cf4 \strokec4 .\cf7 \strokec7 expander\cf4 \strokec4 (\cf10 \strokec10 "### \uc0\u1054 \u1094 \u1077 \u1085 \u1082 \u1072  \u1080  \u1079 \u1072 \u1081 \u1084 \u1099 "\cf4 \strokec4 ):\cb1 \
\cb3         \cf8 \strokec8 item_evaluation_slider\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 slider\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u55357 \u56589  \u1054 \u1094 \u1077 \u1085 \u1082 \u1072  \u1074 \u1077 \u1097 \u1080  (%)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf6 \strokec6 int\cf4 \strokec4 (\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "item_evaluation"\cf4 \strokec4 ) \cf9 \strokec9 *\cf4 \strokec4  \cf12 \strokec12 100\cf4 \strokec4 ),\cb1 \
\cb3             \cf12 \strokec12 5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1055 \u1088 \u1086 \u1094 \u1077 \u1085 \u1090  \u1086 \u1094 \u1077 \u1085 \u1082 \u1080  \u1089 \u1090 \u1086 \u1080 \u1084 \u1086 \u1089 \u1090 \u1080  \u1074 \u1077 \u1097 \u1080  (\u1087 \u1086 \u1076  \u1079 \u1072 \u1083 \u1086 \u1075 )."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 item_evaluation\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 item_evaluation_slider\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf12 \strokec12 100.0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "item_evaluation"\cf4 \strokec4 , \cf8 \strokec8 item_evaluation\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 item_realization_markup\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u55357 \u56520  \u1053 \u1072 \u1094 \u1077 \u1085 \u1082 \u1072  \u1088 \u1077 \u1072 \u1083 \u1080 \u1079 \u1072 \u1094 \u1080 \u1080  (%)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "item_realization_markup"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 5.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 max_value\cf9 \strokec9 =\cf12 \strokec12 100.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %.1f\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1053 \u1072 \u1094 \u1077 \u1085 \u1082 \u1072  \u1087 \u1088 \u1080  \u1088 \u1077 \u1072 \u1083 \u1080 \u1079 \u1072 \u1094 \u1080 \u1080  \u1074 \u1077 \u1097 \u1077 \u1081 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "item_realization_markup"\cf4 \strokec4 , \cf8 \strokec8 item_realization_markup\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 average_item_value\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u55357 \u56498  \u1057 \u1088 \u1077 \u1076 \u1085 \u1103 \u1103  \u1086 \u1094 \u1077 \u1085 \u1082 \u1072  \u1074 \u1077 \u1097 \u1080  (\u1088 \u1091 \u1073 .)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "average_item_value"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 500\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %i\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1057 \u1088 \u1077 \u1076 \u1085 \u1103 \u1103  \u1089 \u1090 \u1086 \u1080 \u1084 \u1086 \u1089 \u1090 \u1100  \u1086 \u1076 \u1085 \u1086 \u1081  \u1074 \u1077 \u1097 \u1080  (\u1088 \u1091 \u1073 .)."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "average_item_value"\cf4 \strokec4 , \cf8 \strokec8 average_item_value\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 loan_interest_rate\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u55357 \u56499  \u1057 \u1090 \u1072 \u1074 \u1082 \u1072  \u1079 \u1072 \u1081 \u1084 \u1086 \u1074  (%/\u1076 \u1077 \u1085 \u1100 )"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "loan_interest_rate"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 0.01\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %.3f\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1044 \u1085 \u1077 \u1074 \u1085 \u1072 \u1103  \u1089 \u1090 \u1072 \u1074 \u1082 \u1072  (%) \u1076 \u1083 \u1103  \u1079 \u1072 \u1081 \u1084 \u1086 \u1074 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "loan_interest_rate"\cf4 \strokec4 , \cf8 \strokec8 loan_interest_rate\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 loan_term_days\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u55357 \u56517  \u1057 \u1088 \u1077 \u1076 \u1085 \u1080 \u1081  \u1089 \u1088 \u1086 \u1082  \u1079 \u1072 \u1081 \u1084 \u1072  (\u1076 \u1085 \u1077 \u1081 )"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "loan_term_days"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %i\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1057 \u1088 \u1077 \u1076 \u1085 \u1080 \u1081  \u1089 \u1088 \u1086 \u1082  \u1079 \u1072 \u1081 \u1084 \u1072  \u1074  \u1076 \u1085 \u1103 \u1093 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "loan_term_days"\cf4 \strokec4 , \cf8 \strokec8 loan_term_days\cf4 \strokec4 )\cb1 \
\
\cb3     \cf2 \strokec2 # --- \uc0\u1056 \u1077 \u1072 \u1083 \u1080 \u1079 \u1072 \u1094 \u1080 \u1103  (%) ---\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 sidebar\cf4 \strokec4 .\cf7 \strokec7 expander\cf4 \strokec4 (\cf10 \strokec10 "### \uc0\u1056 \u1077 \u1072 \u1083 \u1080 \u1079 \u1072 \u1094 \u1080 \u1103  (%)"\cf4 \strokec4 ):\cb1 \
\cb3         \cf8 \strokec8 realization_share_storage_slider\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 slider\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1055 \u1088 \u1086 \u1089 \u1090 \u1086 \u1077 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf6 \strokec6 int\cf4 \strokec4 (\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "realization_share_storage"\cf4 \strokec4 ) \cf9 \strokec9 *\cf4 \strokec4  \cf12 \strokec12 100\cf4 \strokec4 ),\cb1 \
\cb3             \cf12 \strokec12 5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1055 \u1088 \u1086 \u1094 \u1077 \u1085 \u1090  \u1074 \u1077 \u1097 \u1077 \u1081  \u1080 \u1079  \u1087 \u1088 \u1086 \u1089 \u1090 \u1086 \u1075 \u1086  \u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1103 , \u1080 \u1076 \u1091 \u1097 \u1080 \u1093  \u1085 \u1072  \u1088 \u1077 \u1072 \u1083 \u1080 \u1079 \u1072 \u1094 \u1080 \u1102 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 realization_share_storage\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 realization_share_storage_slider\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf12 \strokec12 100.0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "realization_share_storage"\cf4 \strokec4 , \cf8 \strokec8 realization_share_storage\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 realization_share_loan_slider\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 slider\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1047 \u1072 \u1081 \u1084 \u1099 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf6 \strokec6 int\cf4 \strokec4 (\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "realization_share_loan"\cf4 \strokec4 ) \cf9 \strokec9 *\cf4 \strokec4  \cf12 \strokec12 100\cf4 \strokec4 ),\cb1 \
\cb3             \cf12 \strokec12 5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1055 \u1088 \u1086 \u1094 \u1077 \u1085 \u1090  \u1074 \u1077 \u1097 \u1077 \u1081  \u1080 \u1079  \u1079 \u1072 \u1081 \u1084 \u1086 \u1074 , \u1080 \u1076 \u1091 \u1097 \u1080 \u1093  \u1085 \u1072  \u1088 \u1077 \u1072 \u1083 \u1080 \u1079 \u1072 \u1094 \u1080 \u1102 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 realization_share_loan\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 realization_share_loan_slider\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf12 \strokec12 100.0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "realization_share_loan"\cf4 \strokec4 , \cf8 \strokec8 realization_share_loan\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 realization_share_vip_slider\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 slider\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "VIP"\cf4 \strokec4 ,\cb1 \
\cb3             \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf6 \strokec6 int\cf4 \strokec4 (\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "realization_share_vip"\cf4 \strokec4 ) \cf9 \strokec9 *\cf4 \strokec4  \cf12 \strokec12 100\cf4 \strokec4 ),\cb1 \
\cb3             \cf12 \strokec12 5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1055 \u1088 \u1086 \u1094 \u1077 \u1085 \u1090  \u1074 \u1077 \u1097 \u1077 \u1081  \u1080 \u1079  VIP, \u1082 \u1086 \u1090 \u1086 \u1088 \u1099 \u1077  \u1073 \u1091 \u1076 \u1091 \u1090  \u1088 \u1077 \u1072 \u1083 \u1080 \u1079 \u1086 \u1074 \u1072 \u1085 \u1099 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 realization_share_vip\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 realization_share_vip_slider\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf12 \strokec12 100.0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "realization_share_vip"\cf4 \strokec4 , \cf8 \strokec8 realization_share_vip\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 realization_share_short_term_slider\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 slider\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1050 \u1088 \u1072 \u1090 \u1082 \u1086 \u1089 \u1088 \u1086 \u1095 \u1085 \u1086 \u1077 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf6 \strokec6 int\cf4 \strokec4 (\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "realization_share_short_term"\cf4 \strokec4 ) \cf9 \strokec9 *\cf4 \strokec4  \cf12 \strokec12 100\cf4 \strokec4 ),\cb1 \
\cb3             \cf12 \strokec12 5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1055 \u1088 \u1086 \u1094 \u1077 \u1085 \u1090  \u1074 \u1077 \u1097 \u1077 \u1081  \u1080 \u1079  \u1082 \u1088 \u1072 \u1090 \u1082 \u1086 \u1089 \u1088 \u1086 \u1095 \u1085 \u1086 \u1075 \u1086  \u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1103  \u1085 \u1072  \u1088 \u1077 \u1072 \u1083 \u1080 \u1079 \u1072 \u1094 \u1080 \u1102 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 realization_share_short_term\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 realization_share_short_term_slider\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf12 \strokec12 100.0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "realization_share_short_term"\cf4 \strokec4 , \cf8 \strokec8 realization_share_short_term\cf4 \strokec4 )\cb1 \
\
\cb3     \cf2 \strokec2 # --- \uc0\u1055 \u1088 \u1086 \u1094 \u1077 \u1085 \u1090  \u1079 \u1072 \u1087 \u1086 \u1083 \u1085 \u1103 \u1077 \u1084 \u1086 \u1089 \u1090 \u1080  ---\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 sidebar\cf4 \strokec4 .\cf7 \strokec7 expander\cf4 \strokec4 (\cf10 \strokec10 "### \uc0\u1055 \u1088 \u1086 \u1094 \u1077 \u1085 \u1090  \u1079 \u1072 \u1087 \u1086 \u1083 \u1085 \u1103 \u1077 \u1084 \u1086 \u1089 \u1090 \u1080 "\cf4 \strokec4 ):\cb1 \
\cb3         \cf8 \strokec8 storage_fill_rate_slider\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 slider\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1055 \u1088 \u1086 \u1089 \u1090 \u1086 \u1077 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf6 \strokec6 int\cf4 \strokec4 (\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "storage_fill_rate"\cf4 \strokec4 ) \cf9 \strokec9 *\cf4 \strokec4  \cf12 \strokec12 100\cf4 \strokec4 ),\cb1 \
\cb3             \cf12 \strokec12 5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1055 \u1088 \u1086 \u1094 \u1077 \u1085 \u1090  \u1079 \u1072 \u1087 \u1086 \u1083 \u1085 \u1077 \u1085 \u1080 \u1103  \u1087 \u1083 \u1086 \u1097 \u1072 \u1076 \u1080  \u1087 \u1088 \u1086 \u1089 \u1090 \u1086 \u1075 \u1086  \u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1103 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 storage_fill_rate\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 storage_fill_rate_slider\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf12 \strokec12 100.0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "storage_fill_rate"\cf4 \strokec4 , \cf8 \strokec8 storage_fill_rate\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 loan_fill_rate_slider\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 slider\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1047 \u1072 \u1081 \u1084 \u1099 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf6 \strokec6 int\cf4 \strokec4 (\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "loan_fill_rate"\cf4 \strokec4 ) \cf9 \strokec9 *\cf4 \strokec4  \cf12 \strokec12 100\cf4 \strokec4 ),\cb1 \
\cb3             \cf12 \strokec12 5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1055 \u1088 \u1086 \u1094 \u1077 \u1085 \u1090  \u1079 \u1072 \u1087 \u1086 \u1083 \u1085 \u1077 \u1085 \u1080 \u1103  \u1087 \u1083 \u1086 \u1097 \u1072 \u1076 \u1080  \u1079 \u1072 \u1081 \u1084 \u1086 \u1074 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 loan_fill_rate\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 loan_fill_rate_slider\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf12 \strokec12 100.0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "loan_fill_rate"\cf4 \strokec4 , \cf8 \strokec8 loan_fill_rate\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 vip_fill_rate_slider\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 slider\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "VIP"\cf4 \strokec4 ,\cb1 \
\cb3             \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf6 \strokec6 int\cf4 \strokec4 (\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "vip_fill_rate"\cf4 \strokec4 ) \cf9 \strokec9 *\cf4 \strokec4  \cf12 \strokec12 100\cf4 \strokec4 ),\cb1 \
\cb3             \cf12 \strokec12 5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1055 \u1088 \u1086 \u1094 \u1077 \u1085 \u1090  \u1079 \u1072 \u1087 \u1086 \u1083 \u1085 \u1077 \u1085 \u1080 \u1103  VIP-\u1089 \u1077 \u1082 \u1094 \u1080 \u1080 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 vip_fill_rate\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 vip_fill_rate_slider\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf12 \strokec12 100.0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "vip_fill_rate"\cf4 \strokec4 , \cf8 \strokec8 vip_fill_rate\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 short_term_fill_rate_slider\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 slider\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1050 \u1088 \u1072 \u1090 \u1082 \u1086 \u1089 \u1088 \u1086 \u1095 \u1085 \u1086 \u1077 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf6 \strokec6 int\cf4 \strokec4 (\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "short_term_fill_rate"\cf4 \strokec4 ) \cf9 \strokec9 *\cf4 \strokec4  \cf12 \strokec12 100\cf4 \strokec4 ),\cb1 \
\cb3             \cf12 \strokec12 5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1055 \u1088 \u1086 \u1094 \u1077 \u1085 \u1090  \u1079 \u1072 \u1087 \u1086 \u1083 \u1085 \u1077 \u1085 \u1080 \u1103  \u1082 \u1088 \u1072 \u1090 \u1082 \u1086 \u1089 \u1088 \u1086 \u1095 \u1085 \u1086 \u1075 \u1086  \u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1103 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 short_term_fill_rate\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 short_term_fill_rate_slider\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf12 \strokec12 100.0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "short_term_fill_rate"\cf4 \strokec4 , \cf8 \strokec8 short_term_fill_rate\cf4 \strokec4 )\cb1 \
\
\cb3     \cf2 \strokec2 # --- \uc0\u1055 \u1083 \u1086 \u1090 \u1085 \u1086 \u1089 \u1090 \u1100  (\u1074 \u1077 \u1097 \u1077 \u1081 /\u1084 \'b2) ---\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 sidebar\cf4 \strokec4 .\cf7 \strokec7 expander\cf4 \strokec4 (\cf10 \strokec10 "### \uc0\u1055 \u1083 \u1086 \u1090 \u1085 \u1086 \u1089 \u1090 \u1100  (\u1074 \u1077 \u1097 \u1077 \u1081 /\u1084 \'b2)"\cf4 \strokec4 ):\cb1 \
\cb3         \cf8 \strokec8 storage_items_density\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1055 \u1088 \u1086 \u1089 \u1090 \u1086 \u1077 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "storage_items_density"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %i\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1055 \u1083 \u1086 \u1090 \u1085 \u1086 \u1089 \u1090 \u1100  \u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1103  (\u1074 \u1077 \u1097 \u1077 \u1081  \u1085 \u1072  \u1084 \'b2) \u1076 \u1083 \u1103  \u1087 \u1088 \u1086 \u1089 \u1090 \u1086 \u1075 \u1086 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "storage_items_density"\cf4 \strokec4 , \cf8 \strokec8 storage_items_density\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 loan_items_density\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1047 \u1072 \u1081 \u1084 \u1099 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "loan_items_density"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %i\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1055 \u1083 \u1086 \u1090 \u1085 \u1086 \u1089 \u1090 \u1100  \u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1103  \u1076 \u1083 \u1103  \u1079 \u1072 \u1081 \u1084 \u1086 \u1074  (\u1074 \u1077 \u1097 \u1080 /\u1084 \'b2)."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "loan_items_density"\cf4 \strokec4 , \cf8 \strokec8 loan_items_density\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 vip_items_density\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "VIP"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "vip_items_density"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %i\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1055 \u1083 \u1086 \u1090 \u1085 \u1086 \u1089 \u1090 \u1100  \u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1103  \u1076 \u1083 \u1103  VIP (\u1074 \u1077 \u1097 \u1080 /\u1084 \'b2)."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "vip_items_density"\cf4 \strokec4 , \cf8 \strokec8 vip_items_density\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 short_term_items_density\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1050 \u1088 \u1072 \u1090 \u1082 \u1086 \u1089 \u1088 \u1086 \u1095 \u1085 \u1086 \u1077 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "short_term_items_density"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %i\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1055 \u1083 \u1086 \u1090 \u1085 \u1086 \u1089 \u1090 \u1100  \u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1103  \u1076 \u1083 \u1103  \u1082 \u1088 \u1072 \u1090 \u1082 \u1086 \u1089 \u1088 \u1086 \u1095 \u1085 \u1086 \u1075 \u1086  (\u1074 \u1077 \u1097 \u1080 /\u1084 \'b2)."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "short_term_items_density"\cf4 \strokec4 , \cf8 \strokec8 short_term_items_density\cf4 \strokec4 )\cb1 \
\
\cb3     \cf2 \strokec2 # --- \uc0\u1054 \u1090 \u1090 \u1086 \u1082  \u1082 \u1083 \u1080 \u1077 \u1085 \u1090 \u1086 \u1074 /\u1074 \u1077 \u1097 \u1077 \u1081  (%) ---\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 sidebar\cf4 \strokec4 .\cf7 \strokec7 expander\cf4 \strokec4 (\cf10 \strokec10 "### \uc0\u1054 \u1090 \u1090 \u1086 \u1082  \u1082 \u1083 \u1080 \u1077 \u1085 \u1090 \u1086 \u1074 /\u1074 \u1077 \u1097 \u1077 \u1081  (%)"\cf4 \strokec4 ):\cb1 \
\cb3         \cf8 \strokec8 storage_monthly_churn_num\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1055 \u1088 \u1086 \u1089 \u1090 \u1086 \u1077  (%)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "storage_monthly_churn"\cf4 \strokec4 ) \cf9 \strokec9 *\cf4 \strokec4  \cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 0.1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 max_value\cf9 \strokec9 =\cf12 \strokec12 100.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %.1f\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1045 \u1078 \u1077 \u1084 \u1077 \u1089 \u1103 \u1095 \u1085 \u1099 \u1081  \u1086 \u1090 \u1090 \u1086 \u1082  \u1087 \u1088 \u1086 \u1089 \u1090 \u1086 \u1075 \u1086  \u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1103 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 storage_monthly_churn\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 storage_monthly_churn_num\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf12 \strokec12 100.0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "storage_monthly_churn"\cf4 \strokec4 , \cf8 \strokec8 storage_monthly_churn\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 loan_monthly_churn_num\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1047 \u1072 \u1081 \u1084 \u1099  (%)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "loan_monthly_churn"\cf4 \strokec4 ) \cf9 \strokec9 *\cf4 \strokec4  \cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 0.1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 max_value\cf9 \strokec9 =\cf12 \strokec12 100.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %.1f\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1054 \u1090 \u1090 \u1086 \u1082  \u1087 \u1086  \u1079 \u1072 \u1081 \u1084 \u1072 \u1084 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 loan_monthly_churn\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 loan_monthly_churn_num\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf12 \strokec12 100.0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "loan_monthly_churn"\cf4 \strokec4 , \cf8 \strokec8 loan_monthly_churn\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 vip_monthly_churn_num\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "VIP (%)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "vip_monthly_churn"\cf4 \strokec4 ) \cf9 \strokec9 *\cf4 \strokec4  \cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 0.1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 max_value\cf9 \strokec9 =\cf12 \strokec12 100.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %.1f\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1054 \u1090 \u1090 \u1086 \u1082  VIP."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 vip_monthly_churn\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 vip_monthly_churn_num\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf12 \strokec12 100.0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "vip_monthly_churn"\cf4 \strokec4 , \cf8 \strokec8 vip_monthly_churn\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 short_term_monthly_churn_num\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1050 \u1088 \u1072 \u1090 \u1082 \u1086 \u1089 \u1088 \u1086 \u1095 \u1085 \u1086 \u1077  (%)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "short_term_monthly_churn"\cf4 \strokec4 ) \cf9 \strokec9 *\cf4 \strokec4  \cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 0.1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 max_value\cf9 \strokec9 =\cf12 \strokec12 100.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %.1f\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1054 \u1090 \u1090 \u1086 \u1082  \u1087 \u1086  \u1082 \u1088 \u1072 \u1090 \u1082 \u1086 \u1089 \u1088 \u1086 \u1095 \u1085 \u1086 \u1084 \u1091 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 short_term_monthly_churn\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 short_term_monthly_churn_num\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf12 \strokec12 100.0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "short_term_monthly_churn"\cf4 \strokec4 , \cf8 \strokec8 short_term_monthly_churn\cf4 \strokec4 )\cb1 \
\
\cb3     \cf2 \strokec2 # --- \uc0\u1060 \u1080 \u1085 \u1072 \u1085 \u1089 \u1099  (\u1077 \u1078 \u1077 \u1084 \u1077 \u1089 \u1103 \u1095 \u1085 \u1099 \u1077 ) ---\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 sidebar\cf4 \strokec4 .\cf7 \strokec7 expander\cf4 \strokec4 (\cf10 \strokec10 "### \uc0\u1060 \u1080 \u1085 \u1072 \u1085 \u1089 \u1099  (\u1077 \u1078 \u1077 \u1084 \u1077 \u1089 \u1103 \u1095 \u1085 \u1099 \u1077 )"\cf4 \strokec4 ):\cb1 \
\cb3         \cf8 \strokec8 salary_expense\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1047 \u1072 \u1088 \u1087 \u1083 \u1072 \u1090 \u1072  (\u1088 \u1091 \u1073 ./\u1084 \u1077 \u1089 .)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "salary_expense"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 10000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %i\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1054 \u1073 \u1097 \u1080 \u1077  \u1079 \u1072 \u1090 \u1088 \u1072 \u1090 \u1099  \u1085 \u1072  \u1079 \u1072 \u1088 \u1087 \u1083 \u1072 \u1090 \u1091  (\u1088 \u1091 \u1073 ./\u1084 \u1077 \u1089 .)."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "salary_expense"\cf4 \strokec4 , \cf8 \strokec8 salary_expense\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 miscellaneous_expenses\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1055 \u1088 \u1086 \u1095 \u1080 \u1077  (\u1088 \u1091 \u1073 ./\u1084 \u1077 \u1089 .)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "miscellaneous_expenses"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 5000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %i\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1055 \u1088 \u1086 \u1095 \u1080 \u1077  \u1077 \u1078 \u1077 \u1084 \u1077 \u1089 \u1103 \u1095 \u1085 \u1099 \u1077  \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1099 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "miscellaneous_expenses"\cf4 \strokec4 , \cf8 \strokec8 miscellaneous_expenses\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 depreciation_expense\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1040 \u1084 \u1086 \u1088 \u1090 \u1080 \u1079 \u1072 \u1094 \u1080 \u1103  (\u1088 \u1091 \u1073 ./\u1084 \u1077 \u1089 .)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "depreciation_expense"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 5000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %i\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1045 \u1078 \u1077 \u1084 \u1077 \u1089 \u1103 \u1095 \u1085 \u1072 \u1103  \u1072 \u1084 \u1086 \u1088 \u1090 \u1080 \u1079 \u1072 \u1094 \u1080 \u1103 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "depreciation_expense"\cf4 \strokec4 , \cf8 \strokec8 depreciation_expense\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 marketing_expenses\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1052 \u1072 \u1088 \u1082 \u1077 \u1090 \u1080 \u1085 \u1075  (\u1088 \u1091 \u1073 ./\u1084 \u1077 \u1089 .)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "marketing_expenses"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 5000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %i\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1047 \u1072 \u1090 \u1088 \u1072 \u1090 \u1099  \u1085 \u1072  \u1084 \u1072 \u1088 \u1082 \u1077 \u1090 \u1080 \u1085 \u1075 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "marketing_expenses"\cf4 \strokec4 , \cf8 \strokec8 marketing_expenses\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 insurance_expenses\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1057 \u1090 \u1088 \u1072 \u1093 \u1086 \u1074 \u1072 \u1085 \u1080 \u1077  (\u1088 \u1091 \u1073 ./\u1084 \u1077 \u1089 .)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "insurance_expenses"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 1000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %i\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1045 \u1078 \u1077 \u1084 \u1077 \u1089 \u1103 \u1095 \u1085 \u1072 \u1103  \u1089 \u1090 \u1088 \u1072 \u1093 \u1086 \u1074 \u1082 \u1072 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "insurance_expenses"\cf4 \strokec4 , \cf8 \strokec8 insurance_expenses\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 taxes\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1053 \u1072 \u1083 \u1086 \u1075 \u1080  (\u1088 \u1091 \u1073 ./\u1084 \u1077 \u1089 .)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "taxes"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 5000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %i\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1053 \u1072 \u1083 \u1086 \u1075 \u1086 \u1074 \u1099 \u1077  \u1086 \u1090 \u1095 \u1080 \u1089 \u1083 \u1077 \u1085 \u1080 \u1103  (\u1088 \u1091 \u1073 ./\u1084 \u1077 \u1089 )."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "taxes"\cf4 \strokec4 , \cf8 \strokec8 taxes\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 utilities_expenses\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1050 \u1086 \u1084 \u1084 \u1091 \u1085 \u1072 \u1083 \u1082 \u1072  (\u1088 \u1091 \u1073 ./\u1084 \u1077 \u1089 .)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "utilities_expenses"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 5000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %i\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1050 \u1086 \u1084 \u1084 \u1091 \u1085 \u1072 \u1083 \u1100 \u1085 \u1099 \u1077  \u1091 \u1089 \u1083 \u1091 \u1075 \u1080  (\u1088 \u1091 \u1073 ./\u1084 \u1077 \u1089 .)."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "utilities_expenses"\cf4 \strokec4 , \cf8 \strokec8 utilities_expenses\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 maintenance_expenses\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1054 \u1073 \u1089 \u1083 \u1091 \u1078 \u1080 \u1074 \u1072 \u1085 \u1080 \u1077  (\u1088 \u1091 \u1073 ./\u1084 \u1077 \u1089 .)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "maintenance_expenses"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 5000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %i\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1054 \u1073 \u1089 \u1083 \u1091 \u1078 \u1080 \u1074 \u1072 \u1085 \u1080 \u1077  \u1089 \u1082 \u1083 \u1072 \u1076 \u1072  (\u1088 \u1091 \u1073 ./\u1084 \u1077 \u1089 )."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "maintenance_expenses"\cf4 \strokec4 , \cf8 \strokec8 maintenance_expenses\cf4 \strokec4 )\cb1 \
\
\cb3     \cf2 \strokec2 # --- \uc0\u1060 \u1080 \u1085 \u1072 \u1085 \u1089 \u1099  (\u1077 \u1076 \u1080 \u1085 \u1086 \u1074 \u1088 \u1077 \u1084 \u1077 \u1085 \u1085 \u1099 \u1077 ) ---\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 sidebar\cf4 \strokec4 .\cf7 \strokec7 expander\cf4 \strokec4 (\cf10 \strokec10 "### \uc0\u1060 \u1080 \u1085 \u1072 \u1085 \u1089 \u1099  (\u1077 \u1076 \u1080 \u1085 \u1086 \u1074 \u1088 \u1077 \u1084 \u1077 \u1085 \u1085 \u1099 \u1077 )"\cf4 \strokec4 ):\cb1 \
\cb3         \cf8 \strokec8 one_time_setup_cost\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1053 \u1072 \u1089 \u1090 \u1088 \u1086 \u1081 \u1082 \u1072  (\u1088 \u1091 \u1073 .)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "one_time_setup_cost"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 5000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %i\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1045 \u1076 \u1080 \u1085 \u1086 \u1074 \u1088 \u1077 \u1084 \u1077 \u1085 \u1085 \u1099 \u1077  \u1079 \u1072 \u1090 \u1088 \u1072 \u1090 \u1099  \u1085 \u1072  \u1085 \u1072 \u1089 \u1090 \u1088 \u1086 \u1081 \u1082 \u1091  \u1089 \u1082 \u1083 \u1072 \u1076 \u1072 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "one_time_setup_cost"\cf4 \strokec4 , \cf8 \strokec8 one_time_setup_cost\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 one_time_equipment_cost\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1054 \u1073 \u1086 \u1088 \u1091 \u1076 \u1086 \u1074 \u1072 \u1085 \u1080 \u1077  (\u1088 \u1091 \u1073 .)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "one_time_equipment_cost"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 5000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %i\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1045 \u1076 \u1080 \u1085 \u1086 \u1074 \u1088 \u1077 \u1084 \u1077 \u1085 \u1085 \u1099 \u1077  \u1079 \u1072 \u1090 \u1088 \u1072 \u1090 \u1099  \u1085 \u1072  \u1086 \u1073 \u1086 \u1088 \u1091 \u1076 \u1086 \u1074 \u1072 \u1085 \u1080 \u1077 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "one_time_equipment_cost"\cf4 \strokec4 , \cf8 \strokec8 one_time_equipment_cost\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 one_time_other_costs\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1044 \u1088 \u1091 \u1075 \u1080 \u1077  (\u1088 \u1091 \u1073 .)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "one_time_other_costs"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 5000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %i\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1055 \u1088 \u1086 \u1095 \u1080 \u1077  \u1077 \u1076 \u1080 \u1085 \u1086 \u1074 \u1088 \u1077 \u1084 \u1077 \u1085 \u1085 \u1099 \u1077  \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1099 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "one_time_other_costs"\cf4 \strokec4 , \cf8 \strokec8 one_time_other_costs\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 one_time_legal_cost\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1070 \u1088 \u1080 \u1076 \u1080 \u1095 \u1077 \u1089 \u1082 \u1080 \u1077  (\u1088 \u1091 \u1073 .)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "one_time_legal_cost"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 5000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %i\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1045 \u1076 \u1080 \u1085 \u1086 \u1074 \u1088 \u1077 \u1084 \u1077 \u1085 \u1085 \u1099 \u1077  \u1102 \u1088 \u1080 \u1076 \u1080 \u1095 \u1077 \u1089 \u1082 \u1080 \u1077  \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1099 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "one_time_legal_cost"\cf4 \strokec4 , \cf8 \strokec8 one_time_legal_cost\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 one_time_logistics_cost\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1051 \u1086 \u1075 \u1080 \u1089 \u1090 \u1080 \u1082 \u1072  (\u1088 \u1091 \u1073 .)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "one_time_logistics_cost"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 5000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %i\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1045 \u1076 \u1080 \u1085 \u1086 \u1074 \u1088 \u1077 \u1084 \u1077 \u1085 \u1085 \u1099 \u1077  \u1083 \u1086 \u1075 \u1080 \u1089 \u1090 \u1080 \u1095 \u1077 \u1089 \u1082 \u1080 \u1077  \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1099 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "one_time_logistics_cost"\cf4 \strokec4 , \cf8 \strokec8 one_time_logistics_cost\cf4 \strokec4 )\cb1 \
\
\cb3     \cf2 \strokec2 # --- \uc0\u1055 \u1077 \u1088 \u1077 \u1084 \u1077 \u1085 \u1085 \u1099 \u1077  \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1099  (\u1091 \u1087 \u1072 \u1082 \u1086 \u1074 \u1082 \u1072  + \u1101 \u1083 \u1077 \u1082 \u1090 \u1088 \u1080 \u1095 \u1077 \u1089 \u1090 \u1074 \u1086 ) ---\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 sidebar\cf4 \strokec4 .\cf7 \strokec7 expander\cf4 \strokec4 (\cf10 \strokec10 "### \uc0\u1055 \u1077 \u1088 \u1077 \u1084 \u1077 \u1085 \u1085 \u1099 \u1077  \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1099 "\cf4 \strokec4 ):\cb1 \
\cb3         \cf8 \strokec8 packaging_cost_per_m2\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1059 \u1087 \u1072 \u1082 \u1086 \u1074 \u1082 \u1072  (\u1088 \u1091 \u1073 ./\u1084 \'b2)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "packaging_cost_per_m2"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 5.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %.2f\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1057 \u1090 \u1086 \u1080 \u1084 \u1086 \u1089 \u1090 \u1100  \u1091 \u1087 \u1072 \u1082 \u1086 \u1074 \u1082 \u1080  \u1085 \u1072  1 \u1084 \'b2 \u1087 \u1083 \u1086 \u1097 \u1072 \u1076 \u1080 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "packaging_cost_per_m2"\cf4 \strokec4 , \cf8 \strokec8 packaging_cost_per_m2\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 packaging_cost_per_m2\cf4 \strokec4  \cf9 \strokec9 <\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 error\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1057 \u1090 \u1086 \u1080 \u1084 \u1086 \u1089 \u1090 \u1100  \u1091 \u1087 \u1072 \u1082 \u1086 \u1074 \u1082 \u1080  \u1076 \u1086 \u1083 \u1078 \u1085 \u1072  \u1073 \u1099 \u1090 \u1100  \u8805  0."\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 electricity_cost_per_m2\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1069 \u1083 \u1077 \u1082 \u1090 \u1088 \u1080 \u1095 \u1077 \u1089 \u1090 \u1074 \u1086  (\u1088 \u1091 \u1073 ./\u1084 \'b2)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "electricity_cost_per_m2"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 10.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %.1f\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1057 \u1090 \u1086 \u1080 \u1084 \u1086 \u1089 \u1090 \u1100  \u1101 \u1083 \u1077 \u1082 \u1090 \u1088 \u1086 \u1101 \u1085 \u1077 \u1088 \u1075 \u1080 \u1080  \u1085 \u1072  1 \u1084 \'b2."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "electricity_cost_per_m2"\cf4 \strokec4 , \cf8 \strokec8 electricity_cost_per_m2\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 electricity_cost_per_m2\cf4 \strokec4  \cf9 \strokec9 <\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 error\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1057 \u1090 \u1086 \u1080 \u1084 \u1086 \u1089 \u1090 \u1100  \u1101 \u1083 \u1077 \u1082 \u1090 \u1088 \u1080 \u1095 \u1077 \u1089 \u1090 \u1074 \u1072  \u1076 \u1086 \u1083 \u1078 \u1085 \u1072  \u1073 \u1099 \u1090 \u1100  \u8805  0."\cf4 \strokec4 )\cb1 \
\
\cb3     \cf2 \strokec2 # --- \uc0\u1048 \u1085 \u1092 \u1083 \u1103 \u1094 \u1080 \u1103  \u1080  \u1088 \u1086 \u1089 \u1090  ---\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 sidebar\cf4 \strokec4 .\cf7 \strokec7 expander\cf4 \strokec4 (\cf10 \strokec10 "### \uc0\u1048 \u1085 \u1092 \u1083 \u1103 \u1094 \u1080 \u1103  \u1080  \u1088 \u1086 \u1089 \u1090 "\cf4 \strokec4 ):\cb1 \
\cb3         \cf8 \strokec8 monthly_inflation_rate_val\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1048 \u1085 \u1092 \u1083 \u1103 \u1094 \u1080 \u1103  (%/\u1084 \u1077 \u1089 .)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "monthly_inflation_rate"\cf4 \strokec4 ) \cf9 \strokec9 *\cf4 \strokec4  \cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 0.1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %.1f\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1045 \u1078 \u1077 \u1084 \u1077 \u1089 \u1103 \u1095 \u1085 \u1072 \u1103  \u1080 \u1085 \u1092 \u1083 \u1103 \u1094 \u1080 \u1103  (%)."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 monthly_inflation_rate\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 monthly_inflation_rate_val\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf12 \strokec12 100.0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "monthly_inflation_rate"\cf4 \strokec4 , \cf8 \strokec8 monthly_inflation_rate\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 monthly_rent_growth_val\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u55357 \u56520  \u1056 \u1086 \u1089 \u1090  \u1072 \u1088 \u1077 \u1085 \u1076 \u1099  (%/\u1084 \u1077 \u1089 .)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "monthly_rent_growth"\cf4 \strokec4 ) \cf9 \strokec9 *\cf4 \strokec4  \cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 0.5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %.1f\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1056 \u1086 \u1089 \u1090  \u1072 \u1088 \u1077 \u1085 \u1076 \u1099  \u1074  \u1084 \u1077 \u1089 \u1103 \u1094  (%)."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 monthly_rent_growth\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 monthly_rent_growth_val\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf12 \strokec12 100.0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "monthly_rent_growth"\cf4 \strokec4 , \cf8 \strokec8 monthly_rent_growth\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 monthly_salary_growth_val\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u55357 \u56520  \u1056 \u1086 \u1089 \u1090  \u1079 \u1072 \u1088 \u1087 \u1083 \u1072 \u1090 \u1099  (%/\u1084 \u1077 \u1089 .)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "monthly_salary_growth"\cf4 \strokec4 ) \cf9 \strokec9 *\cf4 \strokec4  \cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 0.1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %.1f\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1045 \u1078 \u1077 \u1084 \u1077 \u1089 \u1103 \u1095 \u1085 \u1099 \u1081  \u1088 \u1086 \u1089 \u1090  \u1079 \u1072 \u1088 \u1087 \u1083 \u1072 \u1090 \u1099  (%)."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 monthly_salary_growth\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 monthly_salary_growth_val\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf12 \strokec12 100.0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "monthly_salary_growth"\cf4 \strokec4 , \cf8 \strokec8 monthly_salary_growth\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 monthly_other_expenses_growth_val\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u55357 \u56520  \u1056 \u1086 \u1089 \u1090  \u1087 \u1088 \u1086 \u1095 \u1080 \u1093  \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1086 \u1074  (%/\u1084 \u1077 \u1089 .)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "monthly_other_expenses_growth"\cf4 \strokec4 ) \cf9 \strokec9 *\cf4 \strokec4  \cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 0.1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %.1f\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1045 \u1078 \u1077 \u1084 \u1077 \u1089 \u1103 \u1095 \u1085 \u1099 \u1081  \u1088 \u1086 \u1089 \u1090  \u1087 \u1088 \u1086 \u1095 \u1080 \u1093  \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1086 \u1074  (%)."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 monthly_other_expenses_growth\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 monthly_other_expenses_growth_val\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf12 \strokec12 100.0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "monthly_other_expenses_growth"\cf4 \strokec4 , \cf8 \strokec8 monthly_other_expenses_growth\cf4 \strokec4 )\cb1 \
\
\cb3     \cf2 \strokec2 # --- \uc0\u1056 \u1072 \u1089 \u1096 \u1080 \u1088 \u1077 \u1085 \u1085 \u1099 \u1077  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1099  ---\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 sidebar\cf4 \strokec4 .\cf7 \strokec7 expander\cf4 \strokec4 (\cf10 \strokec10 "### \uc0\u1056 \u1072 \u1089 \u1096 \u1080 \u1088 \u1077 \u1085 \u1085 \u1099 \u1077  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1099  \u1080  \u1087 \u1088 \u1086 \u1075 \u1085 \u1086 \u1079 \u1080 \u1088 \u1086 \u1074 \u1072 \u1085 \u1080 \u1077 "\cf4 \strokec4 ):\cb1 \
\cb3         \cf8 \strokec8 disable_extended\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 checkbox\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u55357 \u57003  \u1054 \u1090 \u1082 \u1083 \u1102 \u1095 \u1080 \u1090 \u1100  \u1088 \u1072 \u1089 \u1096 \u1080 \u1088 \u1077 \u1085 \u1085 \u1099 \u1077  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1099 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "disable_extended"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1045 \u1089 \u1083 \u1080  \u1074 \u1082 \u1083 \u1102 \u1095 \u1077 \u1085 \u1086 , \u1088 \u1072 \u1089 \u1096 \u1080 \u1088 \u1077 \u1085 \u1085 \u1099 \u1077  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1099  \u1080 \u1075 \u1085 \u1086 \u1088 \u1080 \u1088 \u1091 \u1102 \u1090 \u1089 \u1103 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "disable_extended"\cf4 \strokec4 , \cf8 \strokec8 disable_extended\cf4 \strokec4 )\cb1 \
\
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf11 \strokec11 not\cf4 \strokec4  \cf8 \strokec8 disable_extended\cf4 \strokec4 :\cb1 \
\cb3             \cf8 \strokec8 time_horizon_val\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 slider\cf4 \strokec4 (\cb1 \
\cb3                 \cf10 \strokec10 "\uc0\u55357 \u56658  \u1043 \u1086 \u1088 \u1080 \u1079 \u1086 \u1085 \u1090  \u1087 \u1088 \u1086 \u1075 \u1085 \u1086 \u1079 \u1072  (\u1084 \u1077 \u1089 .)"\cf4 \strokec4 ,\cb1 \
\cb3                 \cf12 \strokec12 1\cf4 \strokec4 , \cf12 \strokec12 24\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "time_horizon"\cf4 \strokec4 ),\cb1 \
\cb3                 \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1057 \u1082 \u1086 \u1083 \u1100 \u1082 \u1086  \u1084 \u1077 \u1089 \u1103 \u1094 \u1077 \u1074  \u1087 \u1088 \u1086 \u1075 \u1085 \u1086 \u1079 \u1080 \u1088 \u1091 \u1077 \u1084 ."\cf4 \strokec4 ,\cb1 \
\cb3             )\cb1 \
\cb3             \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "time_horizon"\cf4 \strokec4 , \cf8 \strokec8 time_horizon_val\cf4 \strokec4 )\cb1 \
\
\cb3             \cf8 \strokec8 default_probability_val\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3                 \cf10 \strokec10 "\uc0\u9888 \u65039  \u1042 \u1077 \u1088 \u1086 \u1103 \u1090 \u1085 \u1086 \u1089 \u1090 \u1100  \u1085 \u1077 \u1074 \u1086 \u1079 \u1074 \u1088 \u1072 \u1090 \u1072  (%)"\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "default_probability"\cf4 \strokec4 ) \cf9 \strokec9 *\cf4 \strokec4  \cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0.0\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 max_value\cf9 \strokec9 =\cf12 \strokec12 100.0\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %.1f\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1042 \u1077 \u1088 \u1086 \u1103 \u1090 \u1085 \u1086 \u1089 \u1090 \u1100  \u1085 \u1077 \u1074 \u1086 \u1079 \u1074 \u1088 \u1072 \u1090 \u1072  (\u1076 \u1083 \u1103  \u1079 \u1072 \u1081 \u1084 \u1086 \u1074 )."\cf4 \strokec4 ,\cb1 \
\cb3             )\cb1 \
\cb3             \cf8 \strokec8 default_probability\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 default_probability_val\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf12 \strokec12 100.0\cf4 \cb1 \strokec4 \
\cb3             \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "default_probability"\cf4 \strokec4 , \cf8 \strokec8 default_probability\cf4 \strokec4 )\cb1 \
\
\cb3             \cf8 \strokec8 liquidity_factor_val\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3                 \cf10 \strokec10 "\uc0\u55357 \u56487  \u1051 \u1080 \u1082 \u1074 \u1080 \u1076 \u1085 \u1086 \u1089 \u1090 \u1100 "\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "liquidity_factor"\cf4 \strokec4 ),\cb1 \
\cb3                 \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 0.1\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0.1\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %.1f\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1050 \u1086 \u1101 \u1092 \u1092 \u1080 \u1094 \u1080 \u1077 \u1085 \u1090  \u1083 \u1080 \u1082 \u1074 \u1080 \u1076 \u1085 \u1086 \u1089 \u1090 \u1080 ."\cf4 \strokec4 ,\cb1 \
\cb3             )\cb1 \
\cb3             \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "liquidity_factor"\cf4 \strokec4 , \cf8 \strokec8 liquidity_factor_val\cf4 \strokec4 )\cb1 \
\
\cb3             \cf8 \strokec8 safety_factor_val\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3                 \cf10 \strokec10 "\uc0\u55357 \u57057  \u1047 \u1072 \u1087 \u1072 \u1089 "\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "safety_factor"\cf4 \strokec4 ),\cb1 \
\cb3                 \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 0.1\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0.1\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %.1f\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1050 \u1086 \u1101 \u1092 \u1092 \u1080 \u1094 \u1080 \u1077 \u1085 \u1090  \u1079 \u1072 \u1087 \u1072 \u1089 \u1072  \u1076 \u1083 \u1103  \u1091 \u1089 \u1090 \u1086 \u1081 \u1095 \u1080 \u1074 \u1086 \u1089 \u1090 \u1080 ."\cf4 \strokec4 ,\cb1 \
\cb3             )\cb1 \
\cb3             \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "safety_factor"\cf4 \strokec4 , \cf8 \strokec8 safety_factor_val\cf4 \strokec4 )\cb1 \
\
\cb3             \cf8 \strokec8 loan_grace_period_val\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3                 \cf10 \strokec10 "\uc0\u9203  \u1051 \u1100 \u1075 \u1086 \u1090 \u1085 \u1099 \u1081  \u1087 \u1077 \u1088 \u1080 \u1086 \u1076  (\u1084 \u1077 \u1089 .)"\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "loan_grace_period"\cf4 \strokec4 ),\cb1 \
\cb3                 \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 1\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %i\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1051 \u1100 \u1075 \u1086 \u1090 \u1085 \u1099 \u1081  \u1087 \u1077 \u1088 \u1080 \u1086 \u1076  \u1087 \u1086  \u1079 \u1072 \u1081 \u1084 \u1072 \u1084  (\u1084 \u1077 \u1089 )."\cf4 \strokec4 ,\cb1 \
\cb3             )\cb1 \
\cb3             \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "loan_grace_period"\cf4 \strokec4 , \cf8 \strokec8 loan_grace_period_val\cf4 \strokec4 )\cb1 \
\
\cb3             \cf8 \strokec8 monthly_income_growth_val\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3                 \cf10 \strokec10 "\uc0\u55357 \u56520  \u1056 \u1086 \u1089 \u1090  \u1076 \u1086 \u1093 \u1086 \u1076 \u1086 \u1074  (%/\u1084 \u1077 \u1089 .)"\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "monthly_income_growth"\cf4 \strokec4 ) \cf9 \strokec9 *\cf4 \strokec4  \cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 0.5\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %.1f\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1055 \u1088 \u1077 \u1076 \u1087 \u1086 \u1083 \u1072 \u1075 \u1072 \u1077 \u1084 \u1099 \u1081  \u1088 \u1086 \u1089 \u1090  \u1076 \u1086 \u1093 \u1086 \u1076 \u1086 \u1074  \u1074  \u1084 \u1077 \u1089 \u1103 \u1094 ."\cf4 \strokec4 ,\cb1 \
\cb3             )\cb1 \
\cb3             \cf8 \strokec8 monthly_income_growth\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 monthly_income_growth_val\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf12 \strokec12 100.0\cf4 \cb1 \strokec4 \
\cb3             \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "monthly_income_growth"\cf4 \strokec4 , \cf8 \strokec8 monthly_income_growth\cf4 \strokec4 )\cb1 \
\
\cb3             \cf8 \strokec8 monthly_expenses_growth_val\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3                 \cf10 \strokec10 "\uc0\u55357 \u56521  \u1056 \u1086 \u1089 \u1090  \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1086 \u1074  (%/\u1084 \u1077 \u1089 .)"\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "monthly_expenses_growth"\cf4 \strokec4 ) \cf9 \strokec9 *\cf4 \strokec4  \cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 0.5\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %.1f\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1055 \u1088 \u1077 \u1076 \u1087 \u1086 \u1083 \u1072 \u1075 \u1072 \u1077 \u1084 \u1099 \u1081  \u1088 \u1086 \u1089 \u1090  \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1086 \u1074  \u1074  \u1084 \u1077 \u1089 \u1103 \u1094 ."\cf4 \strokec4 ,\cb1 \
\cb3             )\cb1 \
\cb3             \cf8 \strokec8 monthly_expenses_growth\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 monthly_expenses_growth_val\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf12 \strokec12 100.0\cf4 \cb1 \strokec4 \
\cb3             \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "monthly_expenses_growth"\cf4 \strokec4 , \cf8 \strokec8 monthly_expenses_growth\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 else\cf4 \strokec4 :\cb1 \
\cb3             \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "time_horizon"\cf4 \strokec4 , \cf12 \strokec12 1\cf4 \strokec4 )\cb1 \
\cb3             \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "default_probability"\cf4 \strokec4 , \cf12 \strokec12 0.0\cf4 \strokec4 )\cb1 \
\cb3             \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "liquidity_factor"\cf4 \strokec4 , \cf12 \strokec12 1.0\cf4 \strokec4 )\cb1 \
\cb3             \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "safety_factor"\cf4 \strokec4 , \cf12 \strokec12 1.2\cf4 \strokec4 )\cb1 \
\cb3             \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "loan_grace_period"\cf4 \strokec4 , \cf12 \strokec12 0\cf4 \strokec4 )\cb1 \
\cb3             \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "monthly_income_growth"\cf4 \strokec4 , \cf12 \strokec12 0.0\cf4 \strokec4 )\cb1 \
\cb3             \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "monthly_expenses_growth"\cf4 \strokec4 , \cf12 \strokec12 0.0\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 fm_options\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  [\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1041 \u1072 \u1079 \u1086 \u1074 \u1099 \u1081 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "ML (\uc0\u1083 \u1080 \u1085 \u1077 \u1081 \u1085 \u1072 \u1103  \u1088 \u1077 \u1075 \u1088 \u1077 \u1089 \u1089 \u1080 \u1103 )"\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "ML (\uc0\u1087 \u1086 \u1083 \u1080 \u1085 \u1086 \u1084 \u1080 \u1072 \u1083 \u1100 \u1085 \u1072 \u1103  \u1088 \u1077 \u1075 \u1088 \u1077 \u1089 \u1089 \u1080 \u1103 )"\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1057 \u1080 \u1084 \u1091 \u1083 \u1103 \u1094 \u1080 \u1103  \u1052 \u1086 \u1085 \u1090 \u1077 -\u1050 \u1072 \u1088 \u1083 \u1086 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "ML (\uc0\u1089 \u1083 \u1091 \u1095 \u1072 \u1081 \u1085 \u1099 \u1081  \u1083 \u1077 \u1089 )"\cf4 \strokec4 ,\cb1 \
\cb3         ]\cb1 \
\cb3         \cf8 \strokec8 current_fm\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "forecast_method"\cf4 \strokec4 ) \cf11 \strokec11 or\cf4 \strokec4  \cf10 \strokec10 "\uc0\u1041 \u1072 \u1079 \u1086 \u1074 \u1099 \u1081 "\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 fm_index\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 fm_options\cf4 \strokec4 .\cf7 \strokec7 index\cf4 \strokec4 (\cf8 \strokec8 current_fm\cf4 \strokec4 ) \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 current_fm\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 fm_options\cf4 \strokec4  \cf5 \strokec5 else\cf4 \strokec4  \cf12 \strokec12 0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 forecast_method_sel\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 selectbox\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u55357 \u56522  \u1052 \u1077 \u1090 \u1086 \u1076  \u1087 \u1088 \u1086 \u1075 \u1085 \u1086 \u1079 \u1080 \u1088 \u1086 \u1074 \u1072 \u1085 \u1080 \u1103 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 fm_options\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 index\cf9 \strokec9 =\cf8 \strokec8 fm_index\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1042 \u1099 \u1073 \u1077 \u1088 \u1080 \u1090 \u1077  \u1084 \u1077 \u1090 \u1086 \u1076  \u1087 \u1088 \u1086 \u1075 \u1085 \u1086 \u1079 \u1072 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "forecast_method"\cf4 \strokec4 , \cf8 \strokec8 forecast_method_sel\cf4 \strokec4 )\cb1 \
\
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 forecast_method_sel\cf4 \strokec4  \cf9 \strokec9 ==\cf4 \strokec4  \cf10 \strokec10 "\uc0\u1057 \u1080 \u1084 \u1091 \u1083 \u1103 \u1094 \u1080 \u1103  \u1052 \u1086 \u1085 \u1090 \u1077 -\u1050 \u1072 \u1088 \u1083 \u1086 "\cf4 \strokec4 :\cb1 \
\cb3             \cf8 \strokec8 monte_carlo_simulations_val\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3                 \cf10 \strokec10 "\uc0\u55356 \u57266  \u1057 \u1080 \u1084 \u1091 \u1083 \u1103 \u1094 \u1080 \u1081  \u1052 \u1086 \u1085 \u1090 \u1077 -\u1050 \u1072 \u1088 \u1083 \u1086 "\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "monte_carlo_simulations"\cf4 \strokec4 ),\cb1 \
\cb3                 \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 10\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 10\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %i\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1063 \u1080 \u1089 \u1083 \u1086  \u1089 \u1080 \u1084 \u1091 \u1083 \u1103 \u1094 \u1080 \u1081  \u1074  \u1052 \u1086 \u1085 \u1090 \u1077 -\u1050 \u1072 \u1088 \u1083 \u1086 ."\cf4 \strokec4 ,\cb1 \
\cb3             )\cb1 \
\cb3             \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "monte_carlo_simulations"\cf4 \strokec4 , \cf8 \strokec8 monte_carlo_simulations_val\cf4 \strokec4 )\cb1 \
\
\cb3             \cf8 \strokec8 monte_carlo_deviation_val\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3                 \cf10 \strokec10 "\uc0\u55357 \u56576  \u1054 \u1090 \u1082 \u1083 \u1086 \u1085 \u1077 \u1085 \u1080 \u1103  (0.1 = \'b110%)"\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "monte_carlo_deviation"\cf4 \strokec4 ),\cb1 \
\cb3                 \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 0.01\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 0.01\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %.2f\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1054 \u1090 \u1082 \u1083 \u1086 \u1085 \u1077 \u1085 \u1080 \u1077  \u1076 \u1083 \u1103  \u1052 \u1086 \u1085 \u1090 \u1077 -\u1050 \u1072 \u1088 \u1083 \u1086  (\u1076 \u1086 \u1083 \u1103 )."\cf4 \strokec4 ,\cb1 \
\cb3             )\cb1 \
\cb3             \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "monte_carlo_deviation"\cf4 \strokec4 , \cf8 \strokec8 monte_carlo_deviation_val\cf4 \strokec4 )\cb1 \
\
\cb3             \cf8 \strokec8 monte_carlo_seed_val\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3                 \cf10 \strokec10 "\uc0\u55357 \u56593  Seed"\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "monte_carlo_seed"\cf4 \strokec4 ),\cb1 \
\cb3                 \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 1\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %i\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1047 \u1077 \u1088 \u1085 \u1086  \u1089 \u1083 \u1091 \u1095 \u1072 \u1081 \u1085 \u1086 \u1089 \u1090 \u1080  (\u1052 \u1086 \u1085 \u1090 \u1077 -\u1050 \u1072 \u1088 \u1083 \u1086 )."\cf4 \strokec4 ,\cb1 \
\cb3             )\cb1 \
\cb3             \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "monte_carlo_seed"\cf4 \strokec4 , \cf8 \strokec8 monte_carlo_seed_val\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 enable_ml_settings_val\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 checkbox\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u55358 \u56598  \u1042 \u1082 \u1083 \u1102 \u1095 \u1080 \u1090 \u1100  \u1088 \u1072 \u1089 \u1096 \u1080 \u1088 \u1077 \u1085 \u1085 \u1099 \u1081  ML-\u1087 \u1088 \u1086 \u1075 \u1085 \u1086 \u1079 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "enable_ml_settings"\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1044 \u1086 \u1087 . \u1085 \u1072 \u1089 \u1090 \u1088 \u1086 \u1081 \u1082 \u1080  \u1076 \u1083 \u1103  ML-\u1087 \u1088 \u1086 \u1075 \u1085 \u1086 \u1079 \u1072 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "enable_ml_settings"\cf4 \strokec4 , \cf8 \strokec8 enable_ml_settings_val\cf4 \strokec4 )\cb1 \
\
\cb3         \cf2 \strokec2 # \uc0\u1055 \u1086 \u1083 \u1080 \u1085 \u1086 \u1084 \u1080 \u1072 \u1083 \u1100 \u1085 \u1072 \u1103  \u1088 \u1077 \u1075 \u1088 \u1077 \u1089 \u1089 \u1080 \u1103 \cf4 \cb1 \strokec4 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 forecast_method_sel\cf4 \strokec4  \cf9 \strokec9 ==\cf4 \strokec4  \cf10 \strokec10 "ML (\uc0\u1087 \u1086 \u1083 \u1080 \u1085 \u1086 \u1084 \u1080 \u1072 \u1083 \u1100 \u1085 \u1072 \u1103  \u1088 \u1077 \u1075 \u1088 \u1077 \u1089 \u1089 \u1080 \u1103 )"\cf4 \strokec4  \cf11 \strokec11 and\cf4 \strokec4  \cf8 \strokec8 enable_ml_settings_val\cf4 \strokec4 :\cb1 \
\cb3             \cf8 \strokec8 poly_degree_val\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 number_input\cf4 \strokec4 (\cb1 \
\cb3                 \cf10 \strokec10 "\uc0\u1057 \u1090 \u1077 \u1087 \u1077 \u1085 \u1100  \u1087 \u1086 \u1083 \u1080 \u1085 \u1086 \u1084 \u1072 "\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 min_value\cf9 \strokec9 =\cf12 \strokec12 1\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 max_value\cf9 \strokec9 =\cf12 \strokec12 5\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "poly_degree"\cf4 \strokec4 ) \cf5 \strokec5 or\cf4 \strokec4  \cf12 \strokec12 2\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 step\cf9 \strokec9 =\cf12 \strokec12 1\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %i\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1057 \u1090 \u1077 \u1087 \u1077 \u1085 \u1100  \u1087 \u1086 \u1083 \u1080 \u1085 \u1086 \u1084 \u1072  \u1076 \u1083 \u1103  \u1087 \u1086 \u1083 \u1080 \u1085 \u1086 \u1084 \u1080 \u1072 \u1083 \u1100 \u1085 \u1086 \u1081  \u1088 \u1077 \u1075 \u1088 \u1077 \u1089 \u1089 \u1080 \u1080 ."\cf4 \strokec4 ,\cb1 \
\cb3             )\cb1 \
\cb3             \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "poly_degree"\cf4 \strokec4 , \cf8 \strokec8 poly_degree_val\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 else\cf4 \strokec4 :\cb1 \
\cb3             \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "poly_degree"\cf4 \strokec4 , \cf12 \strokec12 2\cf4 \strokec4 )\cb1 \
\
\cb3     \cf2 \strokec2 # \uc0\u1047 \u1072 \u1075 \u1088 \u1091 \u1079 \u1082 \u1072  \u1076 \u1072 \u1085 \u1085 \u1099 \u1093  \u1076 \u1083 \u1103  ML, \u1077 \u1089 \u1083 \u1080  \u1085 \u1091 \u1078 \u1085 \u1086 \cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 forecast_method\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "forecast_method"\cf4 \strokec4 ) \cf11 \strokec11 or\cf4 \strokec4  \cf10 \strokec10 "\uc0\u1041 \u1072 \u1079 \u1086 \u1074 \u1099 \u1081 "\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 enable_ml_settings_val\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "enable_ml_settings"\cf4 \strokec4 )\cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 enable_ml_settings_val\cf4 \strokec4  \cf11 \strokec11 and\cf4 \strokec4  \cf8 \strokec8 forecast_method\cf4 \strokec4 .\cf7 \strokec7 startswith\cf4 \strokec4 (\cf10 \strokec10 "ML"\cf4 \strokec4 ):\cb1 \
\cb3         \cf8 \strokec8 uploaded_file\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 file_uploader\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1047 \u1072 \u1075 \u1088 \u1091 \u1079 \u1080 \u1090 \u1100  \u1076 \u1072 \u1085 \u1085 \u1099 \u1077  \u1076 \u1083 \u1103  ML-\u1084 \u1086 \u1076 \u1077 \u1083 \u1080  (CSV/Excel)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 type\cf9 \strokec9 =\cf4 \strokec4 [\cf10 \strokec10 "csv"\cf4 \strokec4 , \cf10 \strokec10 "xlsx"\cf4 \strokec4 ],\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1047 \u1072 \u1075 \u1088 \u1091 \u1079 \u1080 \u1090 \u1077  \u1092 \u1072 \u1081 \u1083  \u1089  \u1080 \u1089 \u1090 \u1086 \u1088 \u1080 \u1095 \u1077 \u1089 \u1082 \u1080 \u1084 \u1080  \u1076 \u1072 \u1085 \u1085 \u1099 \u1084 \u1080  \u1076 \u1083 \u1103  ML."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 uploaded_file\cf4 \strokec4  \cf11 \strokec11 is\cf4 \strokec4  \cf11 \strokec11 not\cf4 \strokec4  \cf11 \strokec11 None\cf4 \strokec4 :\cb1 \
\cb3             \cf8 \strokec8 file_extension\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 os\cf4 \strokec4 .\cf8 \strokec8 path\cf4 \strokec4 .\cf7 \strokec7 splitext\cf4 \strokec4 (\cf8 \strokec8 uploaded_file\cf4 \strokec4 .\cf8 \strokec8 name\cf4 \strokec4 )[\cf12 \strokec12 1\cf4 \strokec4 ]\cb1 \
\cb3             \cf5 \strokec5 try\cf4 \strokec4 :\cb1 \
\cb3                 \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 file_extension\cf4 \strokec4  \cf9 \strokec9 ==\cf4 \strokec4  \cf10 \strokec10 ".csv"\cf4 \strokec4 :\cb1 \
\cb3                     \cf8 \strokec8 df_for_ml\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 pd\cf4 \strokec4 .\cf7 \strokec7 read_csv\cf4 \strokec4 (\cf8 \strokec8 uploaded_file\cf4 \strokec4 )\cb1 \
\cb3                 \cf5 \strokec5 elif\cf4 \strokec4  \cf8 \strokec8 file_extension\cf4 \strokec4  \cf9 \strokec9 ==\cf4 \strokec4  \cf10 \strokec10 ".xlsx"\cf4 \strokec4 :\cb1 \
\cb3                     \cf8 \strokec8 df_for_ml\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 pd\cf4 \strokec4 .\cf7 \strokec7 read_excel\cf4 \strokec4 (\cf8 \strokec8 uploaded_file\cf4 \strokec4 )\cb1 \
\cb3                 \cf5 \strokec5 else\cf4 \strokec4 :\cb1 \
\cb3                     \cf5 \strokec5 raise\cf4 \strokec4  \cf6 \strokec6 ValueError\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1060 \u1086 \u1088 \u1084 \u1072 \u1090  \u1085 \u1077  \u1087 \u1086 \u1076 \u1076 \u1077 \u1088 \u1078 \u1080 \u1074 \u1072 \u1077 \u1090 \u1089 \u1103  (\u1090 \u1086 \u1083 \u1100 \u1082 \u1086  CSV \u1080 \u1083 \u1080  Excel)."\cf4 \strokec4 )\cb1 \
\cb3                 \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 success\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1060 \u1072 \u1081 \u1083  \u1091 \u1089 \u1087 \u1077 \u1096 \u1085 \u1086  \u1079 \u1072 \u1075 \u1088 \u1091 \u1078 \u1077 \u1085  \u1076 \u1083 \u1103  ML."\cf4 \strokec4 )\cb1 \
\cb3                 \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "df_for_ml"\cf4 \strokec4 , \cf8 \strokec8 df_for_ml\cf4 \strokec4 )\cb1 \
\cb3             \cf5 \strokec5 except\cf4 \strokec4  \cf6 \strokec6 Exception\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf8 \strokec8 e\cf4 \strokec4 :\cb1 \
\cb3                 \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 error\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1054 \u1096 \u1080 \u1073 \u1082 \u1072  \u1079 \u1072 \u1075 \u1088 \u1091 \u1079 \u1082 \u1080  \u1092 \u1072 \u1081 \u1083 \u1072 : \cf11 \strokec11 \{\cf8 \strokec8 e\cf11 \strokec11 \}\cf10 \strokec10 "\cf4 \strokec4 )\cb1 \
\cb3                 \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "df_for_ml"\cf4 \strokec4 , \cf11 \strokec11 None\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 else\cf4 \strokec4 :\cb1 \
\cb3             \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "df_for_ml"\cf4 \strokec4 , \cf11 \strokec11 None\cf4 \strokec4 )\cb1 \
\cb3     \cf5 \strokec5 else\cf4 \strokec4 :\cb1 \
\cb3         \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "df_for_ml"\cf4 \strokec4 , \cf11 \strokec11 None\cf4 \strokec4 )\cb1 \
\
\cb3     \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 sidebar\cf4 \strokec4 .\cf7 \strokec7 markdown\cf4 \strokec4 (\cf10 \strokec10 "---"\cf4 \strokec4 )\cb1 \
\cb3     \cf2 \strokec2 # \uc0\u1050 \u1085 \u1086 \u1087 \u1082 \u1072  "\u1057 \u1086 \u1093 \u1088 \u1072 \u1085 \u1080 \u1090 \u1100  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1099 "\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 sidebar\cf4 \strokec4 .\cf7 \strokec7 button\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1057 \u1086 \u1093 \u1088 \u1072 \u1085 \u1080 \u1090 \u1100  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1099 "\cf4 \strokec4 ):\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf10 \strokec10 "saved_params"\cf4 \strokec4  \cf11 \strokec11 not\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 session_state\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 session_state\cf4 \strokec4 .saved_params \cf9 \strokec9 =\cf4 \strokec4  \{\}\cb1 \
\cb3         \cf8 \strokec8 param_name\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1057 \u1086 \u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1085 \u1099 \u1077  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1099  \cf11 \strokec11 \{\cf7 \strokec7 len\cf4 \strokec4 (\cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 session_state\cf4 \strokec4 .saved_params) \cf9 \strokec9 +\cf4 \strokec4  \cf12 \strokec12 1\cf11 \strokec11 \}\cf10 \strokec10 "\cf4 \cb1 \strokec4 \
\
\cb3         \cf2 \strokec2 # \uc0\u1057 \u1086 \u1073 \u1080 \u1088 \u1072 \u1077 \u1084  \u1090 \u1077 \u1082 \u1091 \u1097 \u1080 \u1077  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1099 \cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 params_to_save\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \{\}\cb1 \
\cb3         \cf5 \strokec5 for\cf4 \strokec4  \cf8 \strokec8 k\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 default_params\cf4 \strokec4 .keys():\cb1 \
\cb3             \cf8 \strokec8 params_to_save\cf4 \strokec4 [\cf8 \strokec8 k\cf4 \strokec4 ] \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf8 \strokec8 k\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 params_to_save\cf4 \strokec4 [\cf10 \strokec10 "shares"\cf4 \strokec4 ] \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 dict\cf4 \strokec4 (\cf8 \strokec8 app_state\cf4 \strokec4 .\cf8 \strokec8 shares\cf4 \strokec4 )\cb1 \
\
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 session_state\cf4 \strokec4 .saved_params[\cf8 \strokec8 param_name\cf4 \strokec4 ] \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 params_to_save\cf4 \cb1 \strokec4 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 success\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1055 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1099  \u1089 \u1086 \u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1099 : \cf11 \strokec11 \{\cf8 \strokec8 param_name\cf11 \strokec11 \}\cf10 \strokec10 "\cf4 \strokec4 )\cb1 \
\
\cb3     \cf2 \strokec2 # \uc0\u1057 \u1077 \u1082 \u1094 \u1080 \u1103  "\u1047 \u1072 \u1075 \u1088 \u1091 \u1079 \u1082 \u1072  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1086 \u1074 "\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 uploaded_file_sess\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 sidebar\cf4 \strokec4 .\cf7 \strokec7 file_uploader\cf4 \strokec4 (\cb1 \
\cb3         \cf10 \strokec10 "\uc0\u1047 \u1072 \u1075 \u1088 \u1091 \u1079 \u1080 \u1090 \u1100  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1099  (JSON \u1080 \u1083 \u1080  YAML)"\cf4 \strokec4 ,\cb1 \
\cb3         \cf8 \strokec8 type\cf9 \strokec9 =\cf4 \strokec4 [\cf10 \strokec10 "json"\cf4 \strokec4 , \cf10 \strokec10 "yaml"\cf4 \strokec4 , \cf10 \strokec10 "yml"\cf4 \strokec4 ],\cb1 \
\cb3         \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1047 \u1072 \u1075 \u1088 \u1091 \u1079 \u1080 \u1090 \u1077  \u1088 \u1072 \u1085 \u1077 \u1077  \u1089 \u1086 \u1093 \u1088 \u1072 \u1085 \u1105 \u1085 \u1085 \u1099 \u1081  \u1092 \u1072 \u1081 \u1083  \u1089  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1072 \u1084 \u1080 ."\cf4 \strokec4 ,\cb1 \
\cb3     )\cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 uploaded_file_sess\cf4 \strokec4 :\cb1 \
\cb3         \cf5 \strokec5 try\cf4 \strokec4 :\cb1 \
\cb3             \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 uploaded_file_sess\cf4 \strokec4 .\cf8 \strokec8 name\cf4 \strokec4 .endswith(\cf10 \strokec10 ".json"\cf4 \strokec4 ):\cb1 \
\cb3                 \cf8 \strokec8 loaded_params\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 json\cf4 \strokec4 .\cf7 \strokec7 load\cf4 \strokec4 (\cf8 \strokec8 uploaded_file_sess\cf4 \strokec4 )\cb1 \
\cb3             \cf5 \strokec5 elif\cf4 \strokec4  \cf8 \strokec8 uploaded_file_sess\cf4 \strokec4 .\cf8 \strokec8 name\cf4 \strokec4 .endswith(\cf10 \strokec10 ".yaml"\cf4 \strokec4 ) \cf11 \strokec11 or\cf4 \strokec4  \cf8 \strokec8 uploaded_file_sess\cf4 \strokec4 .\cf8 \strokec8 name\cf4 \strokec4 .endswith(\cf10 \strokec10 ".yml"\cf4 \strokec4 ):\cb1 \
\cb3                 \cf8 \strokec8 loaded_params\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 yaml\cf4 \strokec4 .\cf7 \strokec7 safe_load\cf4 \strokec4 (\cf8 \strokec8 uploaded_file_sess\cf4 \strokec4 )\cb1 \
\cb3             \cf5 \strokec5 else\cf4 \strokec4 :\cb1 \
\cb3                 \cf5 \strokec5 raise\cf4 \strokec4  \cf6 \strokec6 ValueError\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1053 \u1077 \u1087 \u1086 \u1076 \u1076 \u1077 \u1088 \u1078 \u1080 \u1074 \u1072 \u1077 \u1084 \u1099 \u1081  \u1092 \u1086 \u1088 \u1084 \u1072 \u1090  (\u1076 \u1086 \u1083 \u1078 \u1077 \u1085  \u1073 \u1099 \u1090 \u1100  JSON \u1080 \u1083 \u1080  YAML)."\cf4 \strokec4 )\cb1 \
\
\cb3             \cf5 \strokec5 for\cf4 \strokec4  \cf8 \strokec8 key\cf4 \strokec4 , \cf8 \strokec8 value\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 loaded_params\cf4 \strokec4 .items():\cb1 \
\cb3                 \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 key\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 default_params\cf4 \strokec4 :\cb1 \
\cb3                     \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf8 \strokec8 key\cf4 \strokec4 , \cf8 \strokec8 value\cf4 \strokec4 )\cb1 \
\cb3             \cf5 \strokec5 if\cf4 \strokec4  \cf10 \strokec10 "shares"\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 loaded_params\cf4 \strokec4 :\cb1 \
\cb3                 \cf8 \strokec8 app_state\cf4 \strokec4 .\cf8 \strokec8 shares\cf4 \strokec4 .update(\cf8 \strokec8 loaded_params\cf4 \strokec4 [\cf10 \strokec10 "shares"\cf4 \strokec4 ])\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 success\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1055 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1099  \u1091 \u1089 \u1087 \u1077 \u1096 \u1085 \u1086  \u1079 \u1072 \u1075 \u1088 \u1091 \u1078 \u1077 \u1085 \u1099  \u1080 \u1079  \u1092 \u1072 \u1081 \u1083 \u1072 ."\cf4 \strokec4 )\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf7 \strokec7 rerun\cf4 \strokec4 ()\cb1 \
\cb3         \cf5 \strokec5 except\cf4 \strokec4  \cf6 \strokec6 Exception\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf8 \strokec8 e\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 error\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1054 \u1096 \u1080 \u1073 \u1082 \u1072  \u1087 \u1088 \u1080  \u1079 \u1072 \u1075 \u1088 \u1091 \u1079 \u1082 \u1077  \u1092 \u1072 \u1081 \u1083 \u1072 : \cf11 \strokec11 \{\cf8 \strokec8 e\cf11 \strokec11 \}\cf10 \strokec10 "\cf4 \strokec4 )\cb1 \
\
\cb3     \cf2 \strokec2 # \uc0\u1050 \u1085 \u1086 \u1087 \u1082 \u1072  "\u1057 \u1086 \u1093 \u1088 \u1072 \u1085 \u1080 \u1090 \u1100  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1099  \u1074  \u1092 \u1072 \u1081 \u1083 "\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 sidebar\cf4 \strokec4 .\cf7 \strokec7 button\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1057 \u1086 \u1093 \u1088 \u1072 \u1085 \u1080 \u1090 \u1100  \u1074  \u1092 \u1072 \u1081 \u1083 "\cf4 \strokec4 ):\cb1 \
\cb3         \cf5 \strokec5 try\cf4 \strokec4 :\cb1 \
\cb3             \cf8 \strokec8 filename\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 text_input\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1048 \u1084 \u1103  \u1092 \u1072 \u1081 \u1083 \u1072  \u1076 \u1083 \u1103  \u1089 \u1086 \u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1103 "\cf4 \strokec4 , \cf10 \strokec10 "warehouse_params"\cf4 \strokec4 )\cb1 \
\cb3             \cf8 \strokec8 file_format\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 selectbox\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1060 \u1086 \u1088 \u1084 \u1072 \u1090  \u1092 \u1072 \u1081 \u1083 \u1072 "\cf4 \strokec4 , [\cf10 \strokec10 "json"\cf4 \strokec4 , \cf10 \strokec10 "yaml"\cf4 \strokec4 ])\cb1 \
\cb3             \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 filename\cf4 \strokec4 :\cb1 \
\cb3                 \cf2 \strokec2 # \uc0\u1057 \u1086 \u1073 \u1080 \u1088 \u1072 \u1077 \u1084  \u1076 \u1083 \u1103  \u1089 \u1086 \u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1103 \cf4 \cb1 \strokec4 \
\cb3                 \cf8 \strokec8 params_to_save\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \{\}\cb1 \
\cb3                 \cf5 \strokec5 for\cf4 \strokec4  \cf8 \strokec8 k\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 default_params\cf4 \strokec4 .keys():\cb1 \
\cb3                     \cf8 \strokec8 params_to_save\cf4 \strokec4 [\cf8 \strokec8 k\cf4 \strokec4 ] \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf8 \strokec8 k\cf4 \strokec4 )\cb1 \
\cb3                 \cf8 \strokec8 params_to_save\cf4 \strokec4 [\cf10 \strokec10 "shares"\cf4 \strokec4 ] \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 dict\cf4 \strokec4 (\cf8 \strokec8 app_state\cf4 \strokec4 .\cf8 \strokec8 shares\cf4 \strokec4 )\cb1 \
\
\cb3                 \cf8 \strokec8 file_data\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 save_params_to_file\cf4 \strokec4 (\cf8 \strokec8 params_to_save\cf4 \strokec4 , \cf8 \strokec8 filename\cf4 \strokec4 , \cf8 \strokec8 file_format\cf4 \strokec4 )\cb1 \
\cb3                 \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 download_button\cf4 \strokec4 (\cb1 \
\cb3                     \cf8 \strokec8 label\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1057 \u1082 \u1072 \u1095 \u1072 \u1090 \u1100  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1099 "\cf4 \strokec4 ,\cb1 \
\cb3                     \cf8 \strokec8 data\cf9 \strokec9 =\cf8 \strokec8 file_data\cf4 \strokec4 ,\cb1 \
\cb3                     \cf8 \strokec8 file_name\cf9 \strokec9 =\cf11 \strokec11 f\cf10 \strokec10 "\cf11 \strokec11 \{\cf8 \strokec8 filename\cf11 \strokec11 \}\cf10 \strokec10 .\cf11 \strokec11 \{\cf8 \strokec8 file_format\cf11 \strokec11 \}\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3                     \cf8 \strokec8 mime\cf9 \strokec9 =\cf11 \strokec11 f\cf10 \strokec10 "application/\cf11 \strokec11 \{\cf8 \strokec8 file_format\cf11 \strokec11 \}\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3                 )\cb1 \
\cb3         \cf5 \strokec5 except\cf4 \strokec4  \cf6 \strokec6 Exception\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf8 \strokec8 e\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 error\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1054 \u1096 \u1080 \u1073 \u1082 \u1072  \u1087 \u1088 \u1080  \u1089 \u1086 \u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1080  \u1074  \u1092 \u1072 \u1081 \u1083 : \cf11 \strokec11 \{\cf8 \strokec8 e\cf11 \strokec11 \}\cf10 \strokec10 "\cf4 \strokec4 )\cb1 \
\
\cf2 \cb3 \strokec2 # \uc0\u1058 \u1077 \u1087 \u1077 \u1088 \u1100  \u1092 \u1086 \u1088 \u1084 \u1080 \u1088 \u1091 \u1077 \u1084  WarehouseParams\cf4 \cb1 \strokec4 \
\cf8 \cb3 \strokec8 forecast_method\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "forecast_method"\cf4 \strokec4 ) \cf11 \strokec11 or\cf4 \strokec4  \cf10 \strokec10 "\uc0\u1041 \u1072 \u1079 \u1086 \u1074 \u1099 \u1081 "\cf4 \cb1 \strokec4 \
\cf8 \cb3 \strokec8 params\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 WarehouseParams\cf4 \strokec4 (\cb1 \
\cb3     \cf8 \strokec8 total_area\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "total_area"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 rental_cost_per_m2\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "rental_cost_per_m2"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 useful_area_ratio\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "useful_area_ratio"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 mode\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "mode"\cf4 \strokec4 ) \cf5 \strokec5 or\cf4 \strokec4  \cf10 \strokec10 "\uc0\u1056 \u1091 \u1095 \u1085 \u1086 \u1081 "\cf4 \strokec4 ,  \cf2 \strokec2 # \uc0\u1048 \u1083 \u1080  "\u1056 \u1091 \u1095 \u1085 \u1086 \u1081 "\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 storage_share\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf8 \strokec8 shares\cf4 \strokec4 [\cf10 \strokec10 "storage_share"\cf4 \strokec4 ],\cb1 \
\cb3     \cf8 \strokec8 loan_share\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf8 \strokec8 shares\cf4 \strokec4 [\cf10 \strokec10 "loan_share"\cf4 \strokec4 ],\cb1 \
\cb3     \cf8 \strokec8 vip_share\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf8 \strokec8 shares\cf4 \strokec4 [\cf10 \strokec10 "vip_share"\cf4 \strokec4 ],\cb1 \
\cb3     \cf8 \strokec8 short_term_share\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf8 \strokec8 shares\cf4 \strokec4 [\cf10 \strokec10 "short_term_share"\cf4 \strokec4 ],\cb1 \
\cb3     \cf8 \strokec8 storage_area_manual\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "storage_area_manual"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 loan_area_manual\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "loan_area_manual"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 vip_area_manual\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "vip_area_manual"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 short_term_area_manual\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "short_term_area_manual"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 storage_fee\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "storage_fee"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 shelves_per_m2\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "shelves_per_m2"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 short_term_daily_rate\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "short_term_daily_rate"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 vip_extra_fee\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "vip_extra_fee"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 item_evaluation\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "item_evaluation"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 item_realization_markup\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "item_realization_markup"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 average_item_value\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "average_item_value"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 loan_interest_rate\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "loan_interest_rate"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 loan_term_days\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "loan_term_days"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 realization_share_storage\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "realization_share_storage"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 realization_share_loan\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "realization_share_loan"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 realization_share_vip\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "realization_share_vip"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 realization_share_short_term\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "realization_share_short_term"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 storage_items_density\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "storage_items_density"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 loan_items_density\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "loan_items_density"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 vip_items_density\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "vip_items_density"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 short_term_items_density\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "short_term_items_density"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 storage_fill_rate\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "storage_fill_rate"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 loan_fill_rate\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "loan_fill_rate"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 vip_fill_rate\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "vip_fill_rate"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 short_term_fill_rate\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "short_term_fill_rate"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 storage_monthly_churn\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "storage_monthly_churn"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 loan_monthly_churn\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "loan_monthly_churn"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 vip_monthly_churn\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "vip_monthly_churn"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 short_term_monthly_churn\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "short_term_monthly_churn"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 salary_expense\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "salary_expense"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 miscellaneous_expenses\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "miscellaneous_expenses"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 depreciation_expense\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "depreciation_expense"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 marketing_expenses\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "marketing_expenses"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 insurance_expenses\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "insurance_expenses"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 taxes\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "taxes"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 utilities_expenses\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "utilities_expenses"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 maintenance_expenses\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "maintenance_expenses"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 one_time_setup_cost\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "one_time_setup_cost"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 one_time_equipment_cost\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "one_time_equipment_cost"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 one_time_other_costs\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "one_time_other_costs"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 one_time_legal_cost\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "one_time_legal_cost"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 one_time_logistics_cost\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "one_time_logistics_cost"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 time_horizon\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "time_horizon"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 monthly_rent_growth\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "monthly_rent_growth"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 default_probability\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "default_probability"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 liquidity_factor\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "liquidity_factor"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 safety_factor\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "safety_factor"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 loan_grace_period\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "loan_grace_period"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 monthly_income_growth\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "monthly_income_growth"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 monthly_expenses_growth\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "monthly_expenses_growth"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 forecast_method\cf9 \strokec9 =\cf8 \strokec8 forecast_method\cf4 \strokec4 ,\cb1 \
\cb3     \cf8 \strokec8 monte_carlo_simulations\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "monte_carlo_simulations"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 monte_carlo_deviation\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "monte_carlo_deviation"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 monte_carlo_seed\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "monte_carlo_seed"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 enable_ml_settings\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "enable_ml_settings"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 electricity_cost_per_m2\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "electricity_cost_per_m2"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 monthly_inflation_rate\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "monthly_inflation_rate"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 monthly_salary_growth\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "monthly_salary_growth"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 monthly_other_expenses_growth\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "monthly_other_expenses_growth"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 packaging_cost_per_m2\cf9 \strokec9 =\cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf10 \strokec10 "packaging_cost_per_m2"\cf4 \strokec4 ),\cb1 \
\cb3     \cf8 \strokec8 poly_degree\cf9 \strokec9 =\cf8 \strokec8 poly_degree\cf4 \strokec4 ,\cb1 \
\cb3 )\cb1 \
\
\cf2 \cb3 \strokec2 # \uc0\u1042 \u1072 \u1083 \u1080 \u1076 \u1080 \u1088 \u1091 \u1077 \u1084 \cf4 \cb1 \strokec4 \
\cf8 \cb3 \strokec8 is_valid\cf4 \strokec4 , \cf8 \strokec8 error_message\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 validate_inputs\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\cf5 \cb3 \strokec5 if\cf4 \strokec4  \cf11 \strokec11 not\cf4 \strokec4  \cf8 \strokec8 is_valid\cf4 \strokec4 :\cb1 \
\cb3     \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 error\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1054 \u1096 \u1080 \u1073 \u1082 \u1072  \u1074 \u1074 \u1086 \u1076 \u1072  \u1076 \u1072 \u1085 \u1085 \u1099 \u1093 : \cf11 \strokec11 \{\cf8 \strokec8 error_message\cf11 \strokec11 \}\cf10 \strokec10 "\cf4 \strokec4 )\cb1 \
\cf5 \cb3 \strokec5 else\cf4 \strokec4 :\cb1 \
\cb3     \cf2 \strokec2 # \uc0\u1057 \u1095 \u1080 \u1090 \u1072 \u1077 \u1084  \u1088 \u1072 \u1089 \u1087 \u1088 \u1077 \u1076 \u1077 \u1083 \u1077 \u1085 \u1080 \u1077  \u1087 \u1083 \u1086 \u1097 \u1072 \u1076 \u1077 \u1081 \cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 areas\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_areas\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\cb3     \cf5 \strokec5 for\cf4 \strokec4  \cf8 \strokec8 k\cf4 \strokec4 , \cf8 \strokec8 v\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 areas\cf4 \strokec4 .\cf7 \strokec7 items\cf4 \strokec4 ():\cb1 \
\cb3         \cf7 \strokec7 setattr\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 k\cf4 \strokec4 , \cf8 \strokec8 v\cf4 \strokec4 )\cb1 \
\
\cb3     \cf2 \strokec2 # \uc0\u1054 \u1089 \u1085 \u1086 \u1074 \u1085 \u1086 \u1081  \u1088 \u1072 \u1089 \u1095 \u1105 \u1090 \cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 base_financials\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_financials\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 disable_extended\cf9 \strokec9 =\cf11 \strokec11 False\cf4 \strokec4 )\cb1 \
\
\cb3     \cf2 \strokec2 # IRR\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 irr_val\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_irr\cf4 \strokec4 ([\cf9 \strokec9 -\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 one_time_expenses\cf4 \strokec4 ] \cf9 \strokec9 +\cf4 \strokec4  [\cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "profit"\cf4 \strokec4 ]]\cf9 \strokec9 *\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 time_horizon\cf4 \strokec4 )\cb1 \
\
\cb3     \cf2 \strokec2 # BEP\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 bep_val\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_total_bep\cf4 \strokec4 (\cf8 \strokec8 base_financials\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\cb3     \cf8 \strokec8 monthly_bep_values\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_monthly_bep\cf4 \strokec4 (\cf8 \strokec8 base_financials\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\
\cb3     \cf2 \strokec2 # \uc0\u1044 \u1086 \u1087 . \u1084 \u1077 \u1090 \u1088 \u1080 \u1082 \u1080 \cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 pm\cf4 \strokec4 , \cf8 \strokec8 pr\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_additional_metrics\cf4 \strokec4 (\cb1 \
\cb3         \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "total_income"\cf4 \strokec4 ],\cb1 \
\cb3         \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "total_expenses"\cf4 \strokec4 ],\cb1 \
\cb3         \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "profit"\cf4 \strokec4 ],\cb1 \
\cb3     )\cb1 \
\cb3     \cf8 \strokec8 roi_val\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_roi\cf4 \strokec4 (\cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "total_income"\cf4 \strokec4 ], \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "total_expenses"\cf4 \strokec4 ])\cb1 \
\
\cb3     \cf2 \strokec2 # \uc0\u1042 \u1082 \u1083 \u1072 \u1076 \u1082 \u1080 \cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 tab1\cf4 \strokec4 , \cf8 \strokec8 tab2_\cf4 \strokec4 , \cf8 \strokec8 tab3_\cf4 \strokec4 , \cf8 \strokec8 tab4_\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 tabs\cf4 \strokec4 ([\cb1 \
\cb3         \cf10 \strokec10 "\uc0\u55357 \u56522  \u1054 \u1073 \u1097 \u1080 \u1077  \u1088 \u1077 \u1079 \u1091 \u1083 \u1100 \u1090 \u1072 \u1090 \u1099 "\cf4 \strokec4 ,\cb1 \
\cb3         \cf10 \strokec10 "\uc0\u55357 \u56520  \u1055 \u1088 \u1086 \u1075 \u1085 \u1086 \u1079 \u1080 \u1088 \u1086 \u1074 \u1072 \u1085 \u1080 \u1077 "\cf4 \strokec4 ,\cb1 \
\cb3         \cf10 \strokec10 "\uc0\u55357 \u56589  \u1058 \u1086 \u1095 \u1082 \u1072  \u1073 \u1077 \u1079 \u1091 \u1073 \u1099 \u1090 \u1086 \u1095 \u1085 \u1086 \u1089 \u1090 \u1080 "\cf4 \strokec4 ,\cb1 \
\cb3         \cf10 \strokec10 "\uc0\u55357 \u56523  \u1044 \u1077 \u1090 \u1072 \u1083 \u1080 \u1079 \u1072 \u1094 \u1080 \u1103 "\cf4 \strokec4 ,\cb1 \
\cb3     ])\cb1 \
\
\cb3     \cf2 \strokec2 # \uc0\u1042 \u1082 \u1083 \u1072 \u1076 \u1082 \u1072  1\cf4 \cb1 \strokec4 \
\cb3     \cf2 \strokec2 # \uc0\u1042 \u1085 \u1077 \u1089 \u1105 \u1084  \u1095 \u1091 \u1090 \u1100  \u1073 \u1086 \u1083 \u1100 \u1096 \u1077  \u1076 \u1072 \u1085 \u1085 \u1099 \u1093 , \u1082 \u1072 \u1082  \u1074 \u1099  \u1087 \u1088 \u1086 \u1089 \u1080 \u1083 \u1080 , \u1085 \u1072 \u1087 \u1088 \u1080 \u1084 \u1077 \u1088 , \u1076 \u1086 \u1073 \u1072 \u1074 \u1080 \u1084  info-\u1073 \u1083 \u1086 \u1082 \cf4 \cb1 \strokec4 \
\cb3     \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 session_state\cf4 \strokec4 [\cf10 \strokec10 "extra_info"\cf4 \strokec4 ] \cf9 \strokec9 =\cf4 \strokec4  (\cb1 \
\cb3         \cf10 \strokec10 "\uc0\u1047 \u1076 \u1077 \u1089 \u1100  \u1074 \u1099  \u1074 \u1080 \u1076 \u1080 \u1090 \u1077  \u1082 \u1083 \u1102 \u1095 \u1077 \u1074 \u1099 \u1077  \u1087 \u1086 \u1082 \u1072 \u1079 \u1072 \u1090 \u1077 \u1083 \u1080  (ROI, IRR, \u1084 \u1072 \u1088 \u1078 \u1072 , \u1088 \u1077 \u1085 \u1090 \u1072 \u1073 \u1077 \u1083 \u1100 \u1085 \u1086 \u1089 \u1090 \u1100 ). "\cf4 \cb1 \strokec4 \
\cb3         \cf10 \strokec10 "\uc0\u1048 \u1089 \u1087 \u1086 \u1083 \u1100 \u1079 \u1091 \u1081 \u1090 \u1077  \u1101 \u1090 \u1080  \u1084 \u1077 \u1090 \u1088 \u1080 \u1082 \u1080  \u1076 \u1083 \u1103  \u1086 \u1094 \u1077 \u1085 \u1082 \u1080  \u1101 \u1092 \u1092 \u1077 \u1082 \u1090 \u1080 \u1074 \u1085 \u1086 \u1089 \u1090 \u1080  \u1089 \u1082 \u1083 \u1072 \u1076 \u1072 . \u1053 \u1080 \u1078 \u1077  \u1074  \u1074 \u1082 \u1083 \u1072 \u1076 \u1082 \u1072 \u1093  \'97 "\cf4 \cb1 \strokec4 \
\cb3         \cf10 \strokec10 "\uc0\u1076 \u1086 \u1087 . \u1075 \u1088 \u1072 \u1092 \u1080 \u1082 \u1080  \u1080  \u1072 \u1085 \u1072 \u1083 \u1080 \u1079  \u1095 \u1091 \u1074 \u1089 \u1090 \u1074 \u1080 \u1090 \u1077 \u1083 \u1100 \u1085 \u1086 \u1089 \u1090 \u1080 ."\cf4 \cb1 \strokec4 \
\cb3     )\cb1 \
\cb3     \cf7 \strokec7 display_tab1\cf4 \strokec4 (\cf8 \strokec8 tab1\cf4 \strokec4 , \cf8 \strokec8 base_financials\cf4 \strokec4 , \cf8 \strokec8 pm\cf4 \strokec4 , \cf8 \strokec8 pr\cf4 \strokec4 , \cf8 \strokec8 roi_val\cf4 \strokec4 , \cf8 \strokec8 irr_val\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\
\cb3     \cf2 \strokec2 # \uc0\u1042 \u1082 \u1083 \u1072 \u1076 \u1082 \u1072  2\cf4 \cb1 \strokec4 \
\cb3     \cf7 \strokec7 display_tab2_header\cf4 \strokec4 (\cf8 \strokec8 tab2_\cf4 \strokec4 )\cb1 \
\cb3     \cf2 \strokec2 # \uc0\u1055 \u1088 \u1086 \u1074 \u1077 \u1088 \u1103 \u1077 \u1084  forecast_method\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 forecast_method\cf4 \strokec4  \cf9 \strokec9 ==\cf4 \strokec4  \cf10 \strokec10 "\uc0\u1041 \u1072 \u1079 \u1086 \u1074 \u1099 \u1081 "\cf4 \strokec4 :\cb1 \
\cb3         \cf7 \strokec7 display_tab2_basic_forecast\cf4 \strokec4 (\cf8 \strokec8 tab2_\cf4 \strokec4 , \cf8 \strokec8 base_financials\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\cb3     \cf5 \strokec5 elif\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 forecast_method\cf4 \strokec4 .\cf7 \strokec7 startswith\cf4 \strokec4 (\cf10 \strokec10 "ML"\cf4 \strokec4 ):\cb1 \
\cb3         \cf2 \strokec2 # \uc0\u1045 \u1089 \u1083 \u1080  \u1077 \u1089 \u1090 \u1100  df_for_ml, \u1087 \u1086 \u1076 \u1075 \u1086 \u1090 \u1072 \u1074 \u1083 \u1080 \u1074 \u1072 \u1077 \u1084  \u1080  \u1079 \u1072 \u1075 \u1088 \u1091 \u1078 \u1072 \u1077 \u1084  \u1084 \u1086 \u1076 \u1077 \u1083 \u1100 \cf4 \cb1 \strokec4 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 df_for_ml\cf4 \strokec4  \cf11 \strokec11 is\cf4 \strokec4  \cf11 \strokec11 not\cf4 \strokec4  \cf11 \strokec11 None\cf4 \strokec4 :\cb1 \
\cb3             \cf8 \strokec8 df_prepared\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 prepare_ml_data\cf4 \strokec4 (\cf8 \strokec8 df_for_ml\cf4 \strokec4 , \cf8 \strokec8 target_column\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1044 \u1086 \u1093 \u1086 \u1076 \u1099 "\cf4 \strokec4 )\cb1 \
\cb3             \cf8 \strokec8 ml_model\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 load_ml_model\cf4 \strokec4 (\cb1 \
\cb3                 \cf8 \strokec8 df_prepared\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 target_column\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1044 \u1086 \u1093 \u1086 \u1076 \u1099 "\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 model_type\cf9 \strokec9 =\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 forecast_method\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 poly_degree\cf9 \strokec9 =\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 poly_degree\cf4 \strokec4 ,\cb1 \
\cb3             )\cb1 \
\cb3             \cf8 \strokec8 app_state\cf4 \strokec4 .\cf7 \strokec7 set\cf4 \strokec4 (\cf10 \strokec10 "ml_model"\cf4 \strokec4 , \cf8 \strokec8 ml_model\cf4 \strokec4 )\cb1 \
\cb3         \cf7 \strokec7 display_tab2_ml_forecast\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 tab2_\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 enable_ml_settings\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 selected_forecast_method\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 ml_model\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 df_for_ml\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 base_financials\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\cb3     \cf5 \strokec5 elif\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 forecast_method\cf4 \strokec4  \cf9 \strokec9 ==\cf4 \strokec4  \cf10 \strokec10 "\uc0\u1057 \u1080 \u1084 \u1091 \u1083 \u1103 \u1094 \u1080 \u1103  \u1052 \u1086 \u1085 \u1090 \u1077 -\u1050 \u1072 \u1088 \u1083 \u1086 "\cf4 \strokec4 :\cb1 \
\cb3         \cf7 \strokec7 display_tab2_monte_carlo\cf4 \strokec4 (\cf8 \strokec8 tab2_\cf4 \strokec4 , \cf8 \strokec8 base_financials\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\
\cb3     \cf2 \strokec2 # \uc0\u1042 \u1082 \u1083 \u1072 \u1076 \u1082 \u1072  3\cf4 \cb1 \strokec4 \
\cb3     \cf7 \strokec7 display_tab3_header\cf4 \strokec4 (\cf8 \strokec8 tab3_\cf4 \strokec4 )\cb1 \
\cb3     \cf7 \strokec7 display_tab3_bep_info\cf4 \strokec4 (\cf8 \strokec8 tab3_\cf4 \strokec4 , \cf8 \strokec8 base_financials\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\cb3     \cf7 \strokec7 display_tab3_monthly_bep\cf4 \strokec4 (\cf8 \strokec8 tab3_\cf4 \strokec4 , \cf8 \strokec8 base_financials\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\cb3     \cf7 \strokec7 display_tab3_sensitivity\cf4 \strokec4 (\cf8 \strokec8 tab3_\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 disable_extended\cf9 \strokec9 =\cf11 \strokec11 False\cf4 \strokec4 )\cb1 \
\
\cb3     \cf2 \strokec2 # \uc0\u1042 \u1082 \u1083 \u1072 \u1076 \u1082 \u1072  4\cf4 \cb1 \strokec4 \
\cb3     \cf7 \strokec7 display_tab4_header\cf4 \strokec4 (\cf8 \strokec8 tab4_\cf4 \strokec4 )\cb1 \
\cb3     \cf7 \strokec7 display_tab4_area_metrics\cf4 \strokec4 (\cf8 \strokec8 tab4_\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\cb3     \cf7 \strokec7 display_tab4_storage_table\cf4 \strokec4 (\cf8 \strokec8 tab4_\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 base_financials\cf4 \strokec4 )\cb1 \
\cb3     \cf7 \strokec7 display_tab4_profit_table\cf4 \strokec4 (\cf8 \strokec8 tab4_\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 base_financials\cf4 \strokec4 )\cb1 \
\cb3     \cf7 \strokec7 display_tab4_results\cf4 \strokec4 (\cf8 \strokec8 tab4_\cf4 \strokec4 , \cf8 \strokec8 base_financials\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 irr_val\cf4 \strokec4 )\cb1 \
\pard\pardeftab560\slleading20\pardirnatural\partightenfactor0

\f0\fs26 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 \
\
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 \'b4\'b4\'b4\
\pard\pardeftab560\slleading20\pardirnatural\partightenfactor0
\cf0 \
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 \uc0\u1060 \u1072 \u1081 \u1083 : calculations.py\
\
\'b4\'b4\'b4python\
\pard\pardeftab720\partightenfactor0

\f1\fs24 \cf2 \cb3 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 # calculations.py\cf4 \cb1 \strokec4 \
\
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 numpy\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf6 \strokec6 np\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 pandas\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf6 \strokec6 pd\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 logging\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 numpy_financial\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf6 \strokec6 npf\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 streamlit\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf6 \strokec6 st\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 from\cf4 \strokec4  \cf6 \strokec6 data_model\cf4 \strokec4  \cf5 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 WarehouseParams\cf4 \cb1 \strokec4 \
\
\cf6 \cb3 \strokec6 logging\cf4 \strokec4 .\cf7 \strokec7 basicConfig\cf4 \strokec4 (\cf8 \strokec8 level\cf9 \strokec9 =\cf6 \strokec6 logging\cf4 \strokec4 .\cf8 \strokec8 INFO\cf4 \strokec4 , \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %(asctime)s\cf10 \strokec10  - \cf11 \strokec11 %(levelname)s\cf10 \strokec10  - \cf11 \strokec11 %(message)s\cf10 \strokec10 "\cf4 \strokec4 )\cb1 \
\
\
\cf7 \cb3 \strokec7 @\cf6 \strokec6 st\cf7 \strokec7 .\cf8 \strokec8 cache_data\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 calculate_irr\cf4 \strokec4 (\cf8 \strokec8 cash_flows\cf4 \strokec4 ):\cb1 \
\cb3     \cf10 \strokec10 """\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     \uc0\u1056 \u1072 \u1089 \u1089 \u1095 \u1080 \u1090 \u1099 \u1074 \u1072 \u1077 \u1090  IRR (\u1074 \u1085 \u1091 \u1090 \u1088 \u1077 \u1085 \u1085 \u1103 \u1103  \u1085 \u1086 \u1088 \u1084 \u1072  \u1076 \u1086 \u1093 \u1086 \u1076 \u1085 \u1086 \u1089 \u1090 \u1080 ) \u1074  \u1087 \u1088 \u1086 \u1094 \u1077 \u1085 \u1090 \u1072 \u1093 .\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     """\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 try\cf4 \strokec4 :\cb1 \
\cb3         \cf8 \strokec8 irr\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 npf\cf4 \strokec4 .\cf7 \strokec7 irr\cf4 \strokec4 (\cf8 \strokec8 cash_flows\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 irr\cf4 \strokec4  \cf11 \strokec11 is\cf4 \strokec4  \cf11 \strokec11 not\cf4 \strokec4  \cf11 \strokec11 None\cf4 \strokec4  \cf11 \strokec11 and\cf4 \strokec4  \cf11 \strokec11 not\cf4 \strokec4  \cf6 \strokec6 np\cf4 \strokec4 .\cf8 \strokec8 isnan\cf4 \strokec4 (\cf8 \strokec8 irr\cf4 \strokec4 ):\cb1 \
\cb3             \cf5 \strokec5 return\cf4 \strokec4  \cf8 \strokec8 irr\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf12 \strokec12 100\cf4 \cb1 \strokec4 \
\cb3         \cf5 \strokec5 else\cf4 \strokec4 :\cb1 \
\cb3             \cf5 \strokec5 return\cf4 \strokec4  \cf12 \strokec12 0.0\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 except\cf4 \strokec4  \cf6 \strokec6 Exception\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf8 \strokec8 e\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 logging\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1054 \u1096 \u1080 \u1073 \u1082 \u1072  \u1087 \u1088 \u1080  \u1088 \u1072 \u1089 \u1095 \u1105 \u1090 \u1077  IRR: \cf11 \strokec11 \{\cf8 \strokec8 e\cf11 \strokec11 \}\cf10 \strokec10 "\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf12 \strokec12 0.0\cf4 \cb1 \strokec4 \
\
\
\cf7 \cb3 \strokec7 @\cf6 \strokec6 st\cf7 \strokec7 .\cf8 \strokec8 cache_data\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 calculate_areas\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 : \cf6 \strokec6 WarehouseParams\cf4 \strokec4 ):\cb1 \
\cb3     \cf10 \strokec10 """\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     \uc0\u1056 \u1072 \u1089 \u1087 \u1088 \u1077 \u1076 \u1077 \u1083 \u1077 \u1085 \u1080 \u1077  \u1087 \u1083 \u1086 \u1097 \u1072 \u1076 \u1077 \u1081 .\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     \uc0\u1045 \u1089 \u1083 \u1080  \u1089 \u1091 \u1084 \u1084 \u1072  \u1088 \u1091 \u1095 \u1085 \u1099 \u1093  \u1087 \u1083 \u1086 \u1097 \u1072 \u1076 \u1077 \u1081  \u1087 \u1088 \u1077 \u1074 \u1099 \u1096 \u1072 \u1077 \u1090  usable_area, \u1087 \u1088 \u1086 \u1087 \u1086 \u1088 \u1094 \u1080 \u1086 \u1085 \u1072 \u1083 \u1100 \u1085 \u1086  \u1091 \u1084 \u1077 \u1085 \u1100 \u1096 \u1072 \u1077 \u1084 .\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     \uc0\u1045 \u1089 \u1083 \u1080  area=0 -> \u1101 \u1090 \u1086  \u1079 \u1085 \u1072 \u1095 \u1080 \u1090  \u1085 \u1077  \u1087 \u1088 \u1080 \u1085 \u1086 \u1089 \u1080 \u1084  \u1076 \u1086 \u1093 \u1086 \u1076 \u1072  \u1080  \u1085 \u1077  \u1085 \u1077 \u1089 \u1105 \u1084  \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1086 \u1074  \u1074  \u1101 \u1090 \u1086 \u1084  \u1090 \u1080 \u1087 \u1077 .\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     """\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 try\cf4 \strokec4 :\cb1 \
\cb3         \cf8 \strokec8 usable_area\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 total_area\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 useful_area_ratio\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 total_manual\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 storage_area_manual\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 loan_area_manual\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 vip_area_manual\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 short_term_area_manual\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 total_manual\cf4 \strokec4  \cf9 \strokec9 >\cf4 \strokec4  \cf8 \strokec8 usable_area\cf4 \strokec4  \cf11 \strokec11 and\cf4 \strokec4  \cf8 \strokec8 usable_area\cf4 \strokec4  \cf9 \strokec9 >\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 :\cb1 \
\cb3             \cf8 \strokec8 factor\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 usable_area\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf8 \strokec8 total_manual\cf4 \cb1 \strokec4 \
\cb3             \cf8 \strokec8 storage_area\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 storage_area_manual\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 factor\cf4 \cb1 \strokec4 \
\cb3             \cf8 \strokec8 loan_area\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 loan_area_manual\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 factor\cf4 \cb1 \strokec4 \
\cb3             \cf8 \strokec8 vip_area\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 vip_area_manual\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 factor\cf4 \cb1 \strokec4 \
\cb3             \cf8 \strokec8 short_term_area\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 short_term_area_manual\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 factor\cf4 \cb1 \strokec4 \
\cb3         \cf5 \strokec5 else\cf4 \strokec4 :\cb1 \
\cb3             \cf8 \strokec8 storage_area\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 storage_area_manual\cf4 \cb1 \strokec4 \
\cb3             \cf8 \strokec8 loan_area\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 loan_area_manual\cf4 \cb1 \strokec4 \
\cb3             \cf8 \strokec8 vip_area\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 vip_area_manual\cf4 \cb1 \strokec4 \
\cb3             \cf8 \strokec8 short_term_area\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 short_term_area_manual\cf4 \cb1 \strokec4 \
\
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \{\cb1 \
\cb3             \cf10 \strokec10 "usable_area"\cf4 \strokec4 : \cf8 \strokec8 usable_area\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "storage_area"\cf4 \strokec4 : \cf8 \strokec8 storage_area\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "loan_area"\cf4 \strokec4 : \cf8 \strokec8 loan_area\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "vip_area"\cf4 \strokec4 : \cf8 \strokec8 vip_area\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "short_term_area"\cf4 \strokec4 : \cf8 \strokec8 short_term_area\cf4 \strokec4 ,\cb1 \
\cb3         \}\cb1 \
\cb3     \cf5 \strokec5 except\cf4 \strokec4  \cf6 \strokec6 Exception\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf8 \strokec8 e\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 logging\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1054 \u1096 \u1080 \u1073 \u1082 \u1072  \u1087 \u1088 \u1080  \u1088 \u1072 \u1089 \u1095 \u1105 \u1090 \u1077  \u1087 \u1083 \u1086 \u1097 \u1072 \u1076 \u1077 \u1081 : \cf11 \strokec11 \{\cf8 \strokec8 e\cf11 \strokec11 \}\cf10 \strokec10 "\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \{\cb1 \
\cb3             \cf10 \strokec10 "usable_area"\cf4 \strokec4 : \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "storage_area"\cf4 \strokec4 : \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "loan_area"\cf4 \strokec4 : \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "vip_area"\cf4 \strokec4 : \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "short_term_area"\cf4 \strokec4 : \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3         \}\cb1 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 calculate_items\cf4 \strokec4 (\cf8 \strokec8 area\cf4 \strokec4 , \cf8 \strokec8 shelves\cf4 \strokec4 , \cf8 \strokec8 density\cf4 \strokec4 , \cf8 \strokec8 fill_rate\cf4 \strokec4 ):\cb1 \
\cb3     \cf10 \strokec10 """\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     \uc0\u1057 \u1095 \u1080 \u1090 \u1072 \u1077 \u1090  \u1082 \u1086 \u1083 \u1080 \u1095 \u1077 \u1089 \u1090 \u1074 \u1086  \u1074 \u1077 \u1097 \u1077 \u1081 :\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10       area (\uc0\u1084 \'b2) * shelves (\u1087 \u1086 \u1083 \u1086 \u1082 /\u1084 \'b2) * density (\u1074 \u1077 \u1097 \u1077 \u1081 /\u1087 \u1086 \u1083 \u1082 \u1091 ) * fill_rate\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     \uc0\u1045 \u1089 \u1083 \u1080  area=0, \u1088 \u1077 \u1079 \u1091 \u1083 \u1100 \u1090 \u1072 \u1090  \u1073 \u1091 \u1076 \u1077 \u1090  0.\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     """\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 try\cf4 \strokec4 :\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf8 \strokec8 area\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 shelves\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 density\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 fill_rate\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 except\cf4 \strokec4  \cf6 \strokec6 Exception\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf8 \strokec8 e\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 logging\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1054 \u1096 \u1080 \u1073 \u1082 \u1072  \u1087 \u1088 \u1080  \u1088 \u1072 \u1089 \u1095 \u1105 \u1090 \u1077  \u1082 \u1086 \u1083 \u1080 \u1095 \u1077 \u1089 \u1090 \u1074 \u1072  \u1074 \u1077 \u1097 \u1077 \u1081 : \cf11 \strokec11 \{\cf8 \strokec8 e\cf11 \strokec11 \}\cf10 \strokec10 "\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf12 \strokec12 0\cf4 \cb1 \strokec4 \
\
\
\cf7 \cb3 \strokec7 @\cf6 \strokec6 st\cf7 \strokec7 .\cf8 \strokec8 cache_data\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 calculate_financials\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 : \cf6 \strokec6 WarehouseParams\cf4 \strokec4 , \cf8 \strokec8 disable_extended\cf4 \strokec4 : \cf6 \strokec6 bool\cf4 \strokec4 ):\cb1 \
\cb3     \cf10 \strokec10 """\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     \uc0\u1045 \u1078 \u1077 \u1084 \u1077 \u1089 \u1103 \u1095 \u1085 \u1099 \u1081  \u1088 \u1072 \u1089 \u1095 \u1105 \u1090  (\u1076 \u1086 \u1093 \u1086 \u1076 \u1099 , \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1099 , \u1087 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100 ):\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10       - \uc0\u1044 \u1086 \u1093 \u1086 \u1076  (\u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1077 , \u1079 \u1072 \u1081 \u1084 \u1099 , \u1088 \u1077 \u1072 \u1083 \u1080 \u1079 \u1072 \u1094 \u1080 \u1103 )\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10       - \uc0\u1056 \u1072 \u1089 \u1093 \u1086 \u1076 \u1099  (\u1072 \u1088 \u1077 \u1085 \u1076 \u1072 , \u1079 \u1072 \u1088 \u1087 \u1083 \u1072 \u1090 \u1072 , \u1091 \u1087 \u1072 \u1082 \u1086 \u1074 \u1082 \u1072 , \u1101 \u1083 \u1077 \u1082 \u1090 \u1088 \u1080 \u1095 \u1077 \u1089 \u1090 \u1074 \u1086  \u1080  \u1087 \u1088 .)\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10       - \uc0\u1055 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100  (\u1079 \u1072  1 \u1084 \u1077 \u1089 \u1103 \u1094 )\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     """\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 try\cf4 \strokec4 :\cb1 \
\cb3         \cf2 \strokec2 # \uc0\u1050 \u1086 \u1083 \u1080 \u1095 \u1077 \u1089 \u1090 \u1074 \u1086  \u1074 \u1077 \u1097 \u1077 \u1081 \cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 storage_items\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_items\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 storage_area\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 shelves_per_m2\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 storage_items_density\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 storage_fill_rate\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 loan_items\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_items\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 loan_area\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 shelves_per_m2\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 loan_items_density\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 loan_fill_rate\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 vip_items\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_items\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 vip_area\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 shelves_per_m2\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 vip_items_density\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 vip_fill_rate\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 short_term_items\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_items\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 short_term_area\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 shelves_per_m2\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 short_term_items_density\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 short_term_fill_rate\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\
\cb3         \cf2 \strokec2 # \uc0\u1044 \u1086 \u1093 \u1086 \u1076  \u1086 \u1090  \u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1103 \cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 storage_income\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 storage_area\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 storage_fee\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 vip_income\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 vip_area\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 storage_fee\cf4 \strokec4  \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 vip_extra_fee\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 short_term_income\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 short_term_area\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 short_term_daily_rate\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf12 \strokec12 30\cf4 \cb1 \strokec4 \
\
\cb3         \cf2 \strokec2 # \uc0\u1047 \u1072 \u1081 \u1084 \u1099 \cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 loan_items_interest\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 loan_items\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  (\cf12 \strokec12 1\cf4 \strokec4  \cf9 \strokec9 -\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 realization_share_loan\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 loan_items_realized\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 loan_items\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 realization_share_loan\cf4 \cb1 \strokec4 \
\
\cb3         \cf8 \strokec8 loan_evaluated_interest\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 average_item_value\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 item_evaluation\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 loan_items_interest\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 daily_loan_rate\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 max\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 loan_interest_rate\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf12 \strokec12 100.0\cf4 \strokec4 , \cf12 \strokec12 0\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 loan_interest_income\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cb1 \
\cb3             \cf8 \strokec8 loan_evaluated_interest\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 daily_loan_rate\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 loan_term_days\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 *\cf4 \strokec4  (\cf12 \strokec12 1\cf4 \strokec4  \cf9 \strokec9 -\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 default_probability\cf4 \strokec4 )\cb1 \
\cb3         )\cb1 \
\
\cb3         \cf8 \strokec8 loan_evaluated_real\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 average_item_value\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 item_evaluation\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 loan_items_realized\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 loan_realization\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 loan_evaluated_real\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 item_realization_markup\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf12 \strokec12 100.0\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 loan_income\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 loan_interest_income\cf4 \strokec4  \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 loan_realization\cf4 \cb1 \strokec4 \
\
\cb3         \cf2 \strokec2 # \uc0\u1056 \u1077 \u1072 \u1083 \u1080 \u1079 \u1072 \u1094 \u1080 \u1103  storage/vip/short_term\cf4 \cb1 \strokec4 \
\cb3         \cf11 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 calc_realization\cf4 \strokec4 (\cf8 \strokec8 items\cf4 \strokec4 , \cf8 \strokec8 markup\cf4 \strokec4 ):\cb1 \
\cb3             \cf5 \strokec5 return\cf4 \strokec4  (\cb1 \
\cb3                 \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 average_item_value\cf4 \cb1 \strokec4 \
\cb3                 \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 item_evaluation\cf4 \cb1 \strokec4 \
\cb3                 \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 items\cf4 \cb1 \strokec4 \
\cb3                 \cf9 \strokec9 *\cf4 \strokec4  (\cf8 \strokec8 markup\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf12 \strokec12 100.0\cf4 \strokec4 )\cb1 \
\cb3             )\cb1 \
\
\cb3         \cf8 \strokec8 storage_realization\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calc_realization\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 storage_items\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 realization_share_storage\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 item_realization_markup\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 vip_realization\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calc_realization\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 vip_items\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 realization_share_vip\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 item_realization_markup\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 short_term_realization\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calc_realization\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 short_term_items\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 realization_share_short_term\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 item_realization_markup\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 realization_income\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cb1 \
\cb3             \cf8 \strokec8 storage_realization\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 vip_realization\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 short_term_realization\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\
\cb3         \cf8 \strokec8 total_income\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cb1 \
\cb3             \cf8 \strokec8 storage_income\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 vip_income\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 short_term_income\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 loan_income\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 realization_income\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\
\cb3         \cf2 \strokec2 # \uc0\u1056 \u1072 \u1089 \u1093 \u1086 \u1076 \u1099 \cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 monthly_rent\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 total_area\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 rental_cost_per_m2\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 electricity_cost\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 total_area\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 electricity_cost_per_m2\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 packaging_cost\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 total_area\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 packaging_cost_per_m2\cf4 \cb1 \strokec4 \
\
\cb3         \cf8 \strokec8 total_monthly_expenses\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cb1 \
\cb3             \cf8 \strokec8 monthly_rent\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 salary_expense\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 miscellaneous_expenses\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 depreciation_expense\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 marketing_expenses\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 insurance_expenses\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 taxes\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 utilities_expenses\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 maintenance_expenses\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 electricity_cost\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 packaging_cost\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\
\cb3         \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 one_time_expenses\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 one_time_setup_cost\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 one_time_equipment_cost\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 one_time_other_costs\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 one_time_legal_cost\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 one_time_logistics_cost\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 time_horizon\cf4 \strokec4  \cf9 \strokec9 >\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 :\cb1 \
\cb3             \cf8 \strokec8 profit\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cb1 \
\cb3                 \cf8 \strokec8 total_income\cf4 \cb1 \strokec4 \
\cb3                 \cf9 \strokec9 -\cf4 \strokec4  \cf8 \strokec8 total_monthly_expenses\cf4 \cb1 \strokec4 \
\cb3                 \cf9 \strokec9 -\cf4 \strokec4  (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 one_time_expenses\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 time_horizon\cf4 \strokec4 )\cb1 \
\cb3             )\cb1 \
\cb3         \cf5 \strokec5 else\cf4 \strokec4 :\cb1 \
\cb3             \cf8 \strokec8 profit\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 total_income\cf4 \strokec4  \cf9 \strokec9 -\cf4 \strokec4  \cf8 \strokec8 total_monthly_expenses\cf4 \cb1 \strokec4 \
\
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \{\cb1 \
\cb3             \cf10 \strokec10 "total_income"\cf4 \strokec4 : \cf8 \strokec8 total_income\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "total_expenses"\cf4 \strokec4 : \cf8 \strokec8 total_monthly_expenses\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "profit"\cf4 \strokec4 : \cf8 \strokec8 profit\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "storage_income"\cf4 \strokec4 : \cf8 \strokec8 storage_income\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "vip_income"\cf4 \strokec4 : \cf8 \strokec8 vip_income\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "short_term_income"\cf4 \strokec4 : \cf8 \strokec8 short_term_income\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "loan_income_after_realization"\cf4 \strokec4 : \cf8 \strokec8 loan_income\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "loan_income"\cf4 \strokec4 : \cf8 \strokec8 loan_income\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "realization_income"\cf4 \strokec4 : \cf8 \strokec8 realization_income\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "storage_realization"\cf4 \strokec4 : \cf8 \strokec8 storage_realization\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "vip_realization"\cf4 \strokec4 : \cf8 \strokec8 vip_realization\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "short_term_realization"\cf4 \strokec4 : \cf8 \strokec8 short_term_realization\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "loan_realization"\cf4 \strokec4 : \cf8 \strokec8 loan_realization\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "storage_items"\cf4 \strokec4 : \cf8 \strokec8 storage_items\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "loan_items"\cf4 \strokec4 : \cf8 \strokec8 loan_items\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "vip_items"\cf4 \strokec4 : \cf8 \strokec8 vip_items\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "short_term_items"\cf4 \strokec4 : \cf8 \strokec8 short_term_items\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "loan_interest_income"\cf4 \strokec4 : \cf8 \strokec8 loan_interest_income\cf4 \strokec4 ,\cb1 \
\cb3         \}\cb1 \
\cb3     \cf5 \strokec5 except\cf4 \strokec4  \cf6 \strokec6 Exception\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf8 \strokec8 e\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 logging\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1054 \u1096 \u1080 \u1073 \u1082 \u1072  \u1074  calculate_financials: \cf11 \strokec11 \{\cf8 \strokec8 e\cf11 \strokec11 \}\cf10 \strokec10 "\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \{\cb1 \
\cb3             \cf10 \strokec10 "total_income"\cf4 \strokec4 : \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "total_expenses"\cf4 \strokec4 : \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "profit"\cf4 \strokec4 : \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "storage_income"\cf4 \strokec4 : \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "vip_income"\cf4 \strokec4 : \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "short_term_income"\cf4 \strokec4 : \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "loan_income_after_realization"\cf4 \strokec4 : \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "loan_income"\cf4 \strokec4 : \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "realization_income"\cf4 \strokec4 : \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "storage_realization"\cf4 \strokec4 : \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "vip_realization"\cf4 \strokec4 : \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "short_term_realization"\cf4 \strokec4 : \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "loan_realization"\cf4 \strokec4 : \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "storage_items"\cf4 \strokec4 : \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "loan_items"\cf4 \strokec4 : \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "vip_items"\cf4 \strokec4 : \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "short_term_items"\cf4 \strokec4 : \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "loan_interest_income"\cf4 \strokec4 : \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3         \}\cb1 \
\
\
\cf7 \cb3 \strokec7 @\cf6 \strokec6 st\cf7 \strokec7 .\cf8 \strokec8 cache_data\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 calculate_total_bep\cf4 \strokec4 (\cf8 \strokec8 financials\cf4 \strokec4 : \cf6 \strokec6 dict\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 : \cf6 \strokec6 WarehouseParams\cf4 \strokec4 ):\cb1 \
\cb3     \cf10 \strokec10 """\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     \uc0\u1054 \u1073 \u1097 \u1072 \u1103  \u1090 \u1086 \u1095 \u1082 \u1072  \u1073 \u1077 \u1079 \u1091 \u1073 \u1099 \u1090 \u1086 \u1095 \u1085 \u1086 \u1089 \u1090 \u1080  (BEP).\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     \uc0\u1045 \u1089 \u1083 \u1080  total_income=0 => float('inf').\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     """\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 try\cf4 \strokec4 :\cb1 \
\cb3         \cf8 \strokec8 total_expenses\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 float\cf4 \strokec4 (\cf8 \strokec8 financials\cf4 \strokec4 [\cf10 \strokec10 "total_expenses"\cf4 \strokec4 ])\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 time_horizon\cf4 \strokec4  \cf9 \strokec9 >\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 :\cb1 \
\cb3             \cf8 \strokec8 total_expenses\cf4 \strokec4  \cf9 \strokec9 +=\cf4 \strokec4  \cf6 \strokec6 float\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 one_time_expenses\cf4 \strokec4 ) \cf9 \strokec9 /\cf4 \strokec4  \cf6 \strokec6 float\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 time_horizon\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 financials\cf4 \strokec4 [\cf10 \strokec10 "total_income"\cf4 \strokec4 ] \cf9 \strokec9 ==\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 :\cb1 \
\cb3             \cf5 \strokec5 return\cf4 \strokec4  \cf6 \strokec6 float\cf4 \strokec4 (\cf10 \strokec10 "inf"\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf8 \strokec8 total_expenses\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 except\cf4 \strokec4  \cf6 \strokec6 Exception\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf8 \strokec8 e\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 logging\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1054 \u1096 \u1080 \u1073 \u1082 \u1072  \u1087 \u1088 \u1080  \u1088 \u1072 \u1089 \u1095 \u1105 \u1090 \u1077  BEP: \cf11 \strokec11 \{\cf8 \strokec8 e\cf11 \strokec11 \}\cf10 \strokec10 "\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf6 \strokec6 float\cf4 \strokec4 (\cf10 \strokec10 "inf"\cf4 \strokec4 )\cb1 \
\
\
\cf7 \cb3 \strokec7 @\cf6 \strokec6 st\cf7 \strokec7 .\cf8 \strokec8 cache_data\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 calculate_monthly_bep\cf4 \strokec4 (\cf8 \strokec8 financials\cf4 \strokec4 : \cf6 \strokec6 dict\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 : \cf6 \strokec6 WarehouseParams\cf4 \strokec4 ):\cb1 \
\cb3     \cf10 \strokec10 """\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     \uc0\u1055 \u1086 \u1084 \u1077 \u1089 \u1103 \u1095 \u1085 \u1072 \u1103  \u1090 \u1086 \u1095 \u1082 \u1072  \u1073 \u1077 \u1079 \u1091 \u1073 \u1099 \u1090 \u1086 \u1095 \u1085 \u1086 \u1089 \u1090 \u1080 .\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     \uc0\u1042 \u1086 \u1079 \u1074 \u1088 \u1072 \u1097 \u1072 \u1077 \u1090  DataFrame: ["\u1052 \u1077 \u1089 \u1103 \u1094 ", "\u1053 \u1077 \u1086 \u1073 \u1093 \u1086 \u1076 \u1080 \u1084 \u1099 \u1081  \u1076 \u1086 \u1093 \u1086 \u1076  \u1076 \u1083 \u1103  BEP"].\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     """\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 try\cf4 \strokec4 :\cb1 \
\cb3         \cf8 \strokec8 months\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 np\cf4 \strokec4 .\cf7 \strokec7 arange\cf4 \strokec4 (\cf12 \strokec12 1\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 time_horizon\cf4 \strokec4  \cf9 \strokec9 +\cf4 \strokec4  \cf12 \strokec12 1\cf4 \strokec4 , \cf8 \strokec8 dtype\cf9 \strokec9 =\cf6 \strokec6 float\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 rent\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cb1 \
\cb3             \cf6 \strokec6 float\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 total_area\cf4 \strokec4 )\cb1 \
\cb3             \cf9 \strokec9 *\cf4 \strokec4  \cf6 \strokec6 float\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 rental_cost_per_m2\cf4 \strokec4 )\cb1 \
\cb3             \cf9 \strokec9 *\cf4 \strokec4  (\cf12 \strokec12 1\cf4 \strokec4  \cf9 \strokec9 +\cf4 \strokec4  \cf6 \strokec6 float\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 monthly_rent_growth\cf4 \strokec4 )) \cf9 \strokec9 **\cf4 \strokec4  \cf8 \strokec8 months\cf4 \cb1 \strokec4 \
\cb3         ).\cf7 \strokec7 astype\cf4 \strokec4 (\cf6 \strokec6 float\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 salary\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cb1 \
\cb3             \cf6 \strokec6 float\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 salary_expense\cf4 \strokec4 )\cb1 \
\cb3             \cf9 \strokec9 *\cf4 \strokec4  (\cf12 \strokec12 1\cf4 \strokec4  \cf9 \strokec9 +\cf4 \strokec4  \cf6 \strokec6 float\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 monthly_salary_growth\cf4 \strokec4 )) \cf9 \strokec9 **\cf4 \strokec4  \cf8 \strokec8 months\cf4 \cb1 \strokec4 \
\cb3         ).\cf7 \strokec7 astype\cf4 \strokec4 (\cf6 \strokec6 float\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 other_exp\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cb1 \
\cb3             \cf6 \strokec6 float\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 miscellaneous_expenses\cf4 \strokec4 )\cb1 \
\cb3             \cf9 \strokec9 *\cf4 \strokec4  (\cf12 \strokec12 1\cf4 \strokec4  \cf9 \strokec9 +\cf4 \strokec4  \cf6 \strokec6 float\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 monthly_other_expenses_growth\cf4 \strokec4 )) \cf9 \strokec9 **\cf4 \strokec4  \cf8 \strokec8 months\cf4 \cb1 \strokec4 \
\cb3         ).\cf7 \strokec7 astype\cf4 \strokec4 (\cf6 \strokec6 float\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 total_exp\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cb1 \
\cb3             \cf8 \strokec8 rent\cf4 \cb1 \strokec4 \
\cb3             \cf7 \strokec7 +\cf4 \strokec4  \cf8 \strokec8 salary\cf4 \cb1 \strokec4 \
\cb3             \cf7 \strokec7 +\cf4 \strokec4  \cf8 \strokec8 other_exp\cf4 \cb1 \strokec4 \
\cb3             \cf7 \strokec7 +\cf4 \strokec4  \cf6 \strokec6 float\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 depreciation_expense\cf4 \strokec4 )\cb1 \
\cb3             \cf7 \strokec7 +\cf4 \strokec4  \cf6 \strokec6 float\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 marketing_expenses\cf4 \strokec4 )\cb1 \
\cb3             \cf7 \strokec7 +\cf4 \strokec4  \cf6 \strokec6 float\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 insurance_expenses\cf4 \strokec4 )\cb1 \
\cb3             \cf7 \strokec7 +\cf4 \strokec4  \cf6 \strokec6 float\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 taxes\cf4 \strokec4 )\cb1 \
\cb3             \cf7 \strokec7 +\cf4 \strokec4  \cf6 \strokec6 float\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 utilities_expenses\cf4 \strokec4 )\cb1 \
\cb3             \cf7 \strokec7 +\cf4 \strokec4  \cf6 \strokec6 float\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 maintenance_expenses\cf4 \strokec4 )\cb1 \
\cb3         ).\cf7 \strokec7 astype\cf4 \strokec4 (\cf6 \strokec6 float\cf4 \strokec4 )\cb1 \
\
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 time_horizon\cf4 \strokec4  \cf9 \strokec9 >\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 :\cb1 \
\cb3             \cf8 \strokec8 addition\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 float\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 one_time_expenses\cf4 \strokec4 ) \cf9 \strokec9 /\cf4 \strokec4  \cf6 \strokec6 float\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 time_horizon\cf4 \strokec4 )\cb1 \
\cb3             \cf8 \strokec8 total_exp\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 total_exp\cf4 \strokec4  \cf7 \strokec7 +\cf4 \strokec4  \cf8 \strokec8 addition\cf4 \cb1 \strokec4 \
\
\cb3         \cf8 \strokec8 df_bep\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 pd\cf4 \strokec4 .\cf6 \strokec6 DataFrame\cf4 \strokec4 (\{\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1052 \u1077 \u1089 \u1103 \u1094 "\cf4 \strokec4 : \cf8 \strokec8 months\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1053 \u1077 \u1086 \u1073 \u1093 \u1086 \u1076 \u1080 \u1084 \u1099 \u1081  \u1076 \u1086 \u1093 \u1086 \u1076  \u1076 \u1083 \u1103  BEP"\cf4 \strokec4 : \cf8 \strokec8 total_exp\cf4 \cb1 \strokec4 \
\cb3         \})\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf8 \strokec8 df_bep\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 except\cf4 \strokec4  \cf6 \strokec6 Exception\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf8 \strokec8 e\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 logging\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1054 \u1096 \u1080 \u1073 \u1082 \u1072  \u1087 \u1088 \u1080  \u1088 \u1072 \u1089 \u1095 \u1105 \u1090 \u1077  \u1087 \u1086 \u1084 \u1077 \u1089 \u1103 \u1095 \u1085 \u1086 \u1075 \u1086  BEP: \cf11 \strokec11 \{\cf8 \strokec8 e\cf11 \strokec11 \}\cf10 \strokec10 "\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf6 \strokec6 pd\cf4 \strokec4 .\cf6 \strokec6 DataFrame\cf4 \strokec4 ()\cb1 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 calculate_additional_metrics\cf4 \strokec4 (\cf8 \strokec8 total_income\cf4 \strokec4 , \cf8 \strokec8 total_expenses\cf4 \strokec4 , \cf8 \strokec8 profit\cf4 \strokec4 ):\cb1 \
\cb3     \cf10 \strokec10 """\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     \uc0\u1042 \u1086 \u1079 \u1074 \u1088 \u1072 \u1097 \u1072 \u1077 \u1090  (profit_margin, profitability).\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     profit_margin = (profit / total_income)*100\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     profitability = (profit / total_expenses)*100\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     """\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 try\cf4 \strokec4 :\cb1 \
\cb3         \cf8 \strokec8 profit_margin\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cf8 \strokec8 profit\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf8 \strokec8 total_income\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf12 \strokec12 100\cf4 \strokec4 ) \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 total_income\cf4 \strokec4  \cf5 \strokec5 else\cf4 \strokec4  \cf12 \strokec12 0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 profitability\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cf8 \strokec8 profit\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf8 \strokec8 total_expenses\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf12 \strokec12 100\cf4 \strokec4 ) \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 total_expenses\cf4 \strokec4  \cf5 \strokec5 else\cf4 \strokec4  \cf12 \strokec12 0\cf4 \cb1 \strokec4 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf8 \strokec8 profit_margin\cf4 \strokec4 , \cf8 \strokec8 profitability\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 except\cf4 \strokec4  \cf6 \strokec6 Exception\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf8 \strokec8 e\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 logging\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1054 \u1096 \u1080 \u1073 \u1082 \u1072  \u1087 \u1088 \u1080  \u1088 \u1072 \u1089 \u1095 \u1105 \u1090 \u1077  \u1076 \u1086 \u1087 \u1086 \u1083 \u1085 \u1080 \u1090 \u1077 \u1083 \u1100 \u1085 \u1099 \u1093  \u1084 \u1077 \u1090 \u1088 \u1080 \u1082 : \cf11 \strokec11 \{\cf8 \strokec8 e\cf11 \strokec11 \}\cf10 \strokec10 "\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 , \cf12 \strokec12 0\cf4 \cb1 \strokec4 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 calculate_roi\cf4 \strokec4 (\cf8 \strokec8 total_income\cf4 \strokec4 , \cf8 \strokec8 total_expenses\cf4 \strokec4 ):\cb1 \
\cb3     \cf10 \strokec10 """\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     ROI = ((total_income - total_expenses)/total_expenses)*100, \uc0\u1077 \u1089 \u1083 \u1080  total_expenses>0, \u1080 \u1085 \u1072 \u1095 \u1077  None.\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     """\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 try\cf4 \strokec4 :\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 total_expenses\cf4 \strokec4  \cf9 \strokec9 ==\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 :\cb1 \
\cb3             \cf5 \strokec5 return\cf4 \strokec4  \cf11 \strokec11 None\cf4 \cb1 \strokec4 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  (\cf8 \strokec8 total_income\cf4 \strokec4  \cf9 \strokec9 -\cf4 \strokec4  \cf8 \strokec8 total_expenses\cf4 \strokec4 ) \cf9 \strokec9 /\cf4 \strokec4  \cf8 \strokec8 total_expenses\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf12 \strokec12 100\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 except\cf4 \strokec4  \cf6 \strokec6 Exception\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf8 \strokec8 e\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 logging\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1054 \u1096 \u1080 \u1073 \u1082 \u1072  \u1087 \u1088 \u1080  \u1088 \u1072 \u1089 \u1095 \u1105 \u1090 \u1077  ROI: \cf11 \strokec11 \{\cf8 \strokec8 e\cf11 \strokec11 \}\cf10 \strokec10 "\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf11 \strokec11 None\cf4 \cb1 \strokec4 \
\
\
\cf7 \cb3 \strokec7 @\cf6 \strokec6 st\cf7 \strokec7 .\cf8 \strokec8 cache_data\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 monte_carlo_simulation\cf4 \strokec4 (\cb1 \
\cb3     \cf8 \strokec8 base_income\cf4 \strokec4 ,\cb1 \
\cb3     \cf8 \strokec8 base_expenses\cf4 \strokec4 ,\cb1 \
\cb3     \cf8 \strokec8 time_horizon\cf4 \strokec4 ,\cb1 \
\cb3     \cf8 \strokec8 simulations\cf4 \strokec4 ,\cb1 \
\cb3     \cf8 \strokec8 deviation\cf4 \strokec4 ,\cb1 \
\cb3     \cf8 \strokec8 seed\cf4 \strokec4 ,\cb1 \
\cb3     \cf8 \strokec8 monthly_income_growth\cf4 \strokec4 ,\cb1 \
\cb3     \cf8 \strokec8 monthly_expenses_growth\cf4 \strokec4 ,\cb1 \
\cb3 ):\cb1 \
\cb3     \cf10 \strokec10 """\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     \uc0\u1055 \u1088 \u1086 \u1089 \u1090 \u1077 \u1081 \u1096 \u1072 \u1103  \u1089 \u1080 \u1084 \u1091 \u1083 \u1103 \u1094 \u1080 \u1103  \u1052 \u1086 \u1085 \u1090 \u1077 -\u1050 \u1072 \u1088 \u1083 \u1086  \u1076 \u1083 \u1103  \u1076 \u1086 \u1093 \u1086 \u1076 \u1086 \u1074  \u1080  \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1086 \u1074 .\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     \uc0\u1042 \u1086 \u1079 \u1074 \u1088 \u1072 \u1097 \u1072 \u1077 \u1090  DataFrame \u1089  ['\u1052 \u1077 \u1089 \u1103 \u1094 ','\u1057 \u1088 \u1077 \u1076 \u1085 \u1080 \u1081  \u1044 \u1086 \u1093 \u1086 \u1076 ','\u1057 \u1088 \u1077 \u1076 \u1085 \u1080 \u1081  \u1056 \u1072 \u1089 \u1093 \u1086 \u1076 ','\u1057 \u1088 \u1077 \u1076 \u1085 \u1103 \u1103  \u1055 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100 '].\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     """\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 try\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 np\cf4 \strokec4 .\cf6 \strokec6 random\cf4 \strokec4 .\cf8 \strokec8 seed\cf4 \strokec4 (\cf8 \strokec8 seed\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 months\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 np\cf4 \strokec4 .\cf7 \strokec7 arange\cf4 \strokec4 (\cf12 \strokec12 1\cf4 \strokec4 , \cf8 \strokec8 time_horizon\cf4 \strokec4  \cf9 \strokec9 +\cf4 \strokec4  \cf12 \strokec12 1\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 inc_growth\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cf12 \strokec12 1\cf4 \strokec4  \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 monthly_income_growth\cf4 \strokec4 ) \cf9 \strokec9 **\cf4 \strokec4  \cf8 \strokec8 months\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 exp_growth\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cf12 \strokec12 1\cf4 \strokec4  \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 monthly_expenses_growth\cf4 \strokec4 ) \cf9 \strokec9 **\cf4 \strokec4  \cf8 \strokec8 months\cf4 \cb1 \strokec4 \
\
\cb3         \cf8 \strokec8 inc_factors\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 np\cf4 \strokec4 .\cf6 \strokec6 random\cf4 \strokec4 .\cf8 \strokec8 uniform\cf4 \strokec4 (\cf12 \strokec12 1\cf4 \strokec4  \cf9 \strokec9 -\cf4 \strokec4  \cf8 \strokec8 deviation\cf4 \strokec4 , \cf12 \strokec12 1\cf4 \strokec4  \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 deviation\cf4 \strokec4 , (\cf8 \strokec8 simulations\cf4 \strokec4 , \cf8 \strokec8 time_horizon\cf4 \strokec4 ))\cb1 \
\cb3         \cf8 \strokec8 exp_factors\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 np\cf4 \strokec4 .\cf6 \strokec6 random\cf4 \strokec4 .\cf8 \strokec8 uniform\cf4 \strokec4 (\cf12 \strokec12 1\cf4 \strokec4  \cf9 \strokec9 -\cf4 \strokec4  \cf8 \strokec8 deviation\cf4 \strokec4 , \cf12 \strokec12 1\cf4 \strokec4  \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 deviation\cf4 \strokec4 , (\cf8 \strokec8 simulations\cf4 \strokec4 , \cf8 \strokec8 time_horizon\cf4 \strokec4 ))\cb1 \
\
\cb3         \cf8 \strokec8 incomes\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 base_income\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 inc_growth\cf4 \strokec4  \cf7 \strokec7 *\cf4 \strokec4  \cf8 \strokec8 inc_factors\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 expenses\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 base_expenses\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 exp_growth\cf4 \strokec4  \cf7 \strokec7 *\cf4 \strokec4  \cf8 \strokec8 exp_factors\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 profits\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 incomes\cf4 \strokec4  \cf9 \strokec9 -\cf4 \strokec4  \cf8 \strokec8 expenses\cf4 \cb1 \strokec4 \
\
\cb3         \cf8 \strokec8 df_mc\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 pd\cf4 \strokec4 .\cf6 \strokec6 DataFrame\cf4 \strokec4 (\{\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1052 \u1077 \u1089 \u1103 \u1094 "\cf4 \strokec4 : \cf8 \strokec8 months\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1057 \u1088 \u1077 \u1076 \u1085 \u1080 \u1081  \u1044 \u1086 \u1093 \u1086 \u1076 "\cf4 \strokec4 : \cf8 \strokec8 incomes\cf4 \strokec4 .mean(\cf8 \strokec8 axis\cf9 \strokec9 =\cf12 \strokec12 0\cf4 \strokec4 ),\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1057 \u1088 \u1077 \u1076 \u1085 \u1080 \u1081  \u1056 \u1072 \u1089 \u1093 \u1086 \u1076 "\cf4 \strokec4 : \cf8 \strokec8 expenses\cf4 \strokec4 .mean(\cf8 \strokec8 axis\cf9 \strokec9 =\cf12 \strokec12 0\cf4 \strokec4 ),\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1057 \u1088 \u1077 \u1076 \u1085 \u1103 \u1103  \u1055 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100 "\cf4 \strokec4 : \cf8 \strokec8 profits\cf4 \strokec4 .mean(\cf8 \strokec8 axis\cf9 \strokec9 =\cf12 \strokec12 0\cf4 \strokec4 ),\cb1 \
\cb3         \})\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf8 \strokec8 df_mc\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 except\cf4 \strokec4  \cf6 \strokec6 Exception\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf8 \strokec8 e\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 logging\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1054 \u1096 \u1080 \u1073 \u1082 \u1072  \u1087 \u1088 \u1080  \u1089 \u1080 \u1084 \u1091 \u1083 \u1103 \u1094 \u1080 \u1080  \u1052 \u1086 \u1085 \u1090 \u1077 -\u1050 \u1072 \u1088 \u1083 \u1086 : \cf11 \strokec11 \{\cf8 \strokec8 e\cf11 \strokec11 \}\cf10 \strokec10 "\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf6 \strokec6 pd\cf4 \strokec4 .\cf6 \strokec6 DataFrame\cf4 \strokec4 ()\cb1 \
\
\
\cf7 \cb3 \strokec7 @\cf6 \strokec6 st\cf7 \strokec7 .\cf8 \strokec8 cache_data\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 min_loan_amount_for_bep\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 : \cf6 \strokec6 WarehouseParams\cf4 \strokec4 , \cf8 \strokec8 fin\cf4 \strokec4 : \cf6 \strokec6 dict\cf4 \strokec4 ):\cb1 \
\cb3     \cf10 \strokec10 """\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     \uc0\u1052 \u1080 \u1085 \u1080 \u1084 \u1072 \u1083 \u1100 \u1085 \u1072 \u1103  \u1089 \u1091 \u1084 \u1084 \u1072  \u1079 \u1072 \u1081 \u1084 \u1072  \u1076 \u1083 \u1103  \u1087 \u1086 \u1082 \u1088 \u1099 \u1090 \u1080 \u1103  \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1086 \u1074  (BEP).\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     """\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 try\cf4 \strokec4 :\cb1 \
\cb3         \cf8 \strokec8 total_exp\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 float\cf4 \strokec4 (\cf8 \strokec8 fin\cf4 \strokec4 [\cf10 \strokec10 "total_expenses"\cf4 \strokec4 ])\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 time_horizon\cf4 \strokec4  \cf9 \strokec9 >\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 :\cb1 \
\cb3             \cf8 \strokec8 total_exp\cf4 \strokec4  \cf9 \strokec9 +=\cf4 \strokec4  \cf6 \strokec6 float\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 one_time_expenses\cf4 \strokec4 ) \cf9 \strokec9 /\cf4 \strokec4  \cf6 \strokec6 float\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 time_horizon\cf4 \strokec4 )\cb1 \
\
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 fin\cf4 \strokec4 [\cf10 \strokec10 "loan_items"\cf4 \strokec4 ] \cf9 \strokec9 <=\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 :\cb1 \
\cb3             \cf5 \strokec5 return\cf4 \strokec4  \cf12 \strokec12 0.0\cf4 \cb1 \strokec4 \
\
\cb3         \cf8 \strokec8 daily_rate\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 max\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 loan_interest_rate\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf12 \strokec12 100.0\cf4 \strokec4 , \cf12 \strokec12 0.0001\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 value\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cf8 \strokec8 total_exp\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf8 \strokec8 fin\cf4 \strokec4 [\cf10 \strokec10 "loan_items"\cf4 \strokec4 ]) \cf9 \strokec9 /\cf4 \strokec4  (\cf8 \strokec8 daily_rate\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 loan_term_days\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf7 \strokec7 max\cf4 \strokec4 (\cf8 \strokec8 value\cf4 \strokec4 , \cf12 \strokec12 0.0\cf4 \strokec4 )\cb1 \
\cb3     \cf5 \strokec5 except\cf4 \strokec4  \cf6 \strokec6 Exception\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf8 \strokec8 e\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 logging\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1054 \u1096 \u1080 \u1073 \u1082 \u1072  \u1087 \u1088 \u1080  \u1088 \u1072 \u1089 \u1095 \u1105 \u1090 \u1077  min_loan_amount_for_bep: \cf11 \strokec11 \{\cf8 \strokec8 e\cf11 \strokec11 \}\cf10 \strokec10 "\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf12 \strokec12 0.0\cf4 \cb1 \strokec4 \
\
\
\cf7 \cb3 \strokec7 @\cf6 \strokec6 st\cf7 \strokec7 .\cf8 \strokec8 cache_data\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 calculate_monthly_projection\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 : \cf6 \strokec6 WarehouseParams\cf4 \strokec4 , \cf8 \strokec8 base_financials\cf4 \strokec4 : \cf6 \strokec6 dict\cf4 \strokec4 ):\cb1 \
\cb3     \cf10 \strokec10 """\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     \uc0\u1055 \u1088 \u1080 \u1084 \u1077 \u1088  \u1087 \u1086 \u1084 \u1077 \u1089 \u1103 \u1095 \u1085 \u1086 \u1075 \u1086  \u1087 \u1088 \u1086 \u1075 \u1085 \u1086 \u1079 \u1072  \u1076 \u1086 \u1093 \u1086 \u1076 \u1086 \u1074 /\u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1086 \u1074 /\u1087 \u1088 \u1080 \u1073 \u1099 \u1083 \u1080 .\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     \uc0\u1042 \u1086 \u1079 \u1074 \u1088 \u1072 \u1097 \u1072 \u1077 \u1090  DataFrame("\u1052 \u1077 \u1089 \u1103 \u1094 ","\u1044 \u1086 \u1093 \u1086 \u1076 ","\u1056 \u1072 \u1089 \u1093 \u1086 \u1076 ","\u1055 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100 ").\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     """\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 try\cf4 \strokec4 :\cb1 \
\cb3         \cf8 \strokec8 months\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 np\cf4 \strokec4 .\cf7 \strokec7 arange\cf4 \strokec4 (\cf12 \strokec12 1\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 time_horizon\cf4 \strokec4  \cf9 \strokec9 +\cf4 \strokec4  \cf12 \strokec12 1\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 start_income\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "total_income"\cf4 \strokec4 ]\cb1 \
\
\cb3         \cf8 \strokec8 rent\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 total_area\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 rental_cost_per_m2\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 *\cf4 \strokec4  (\cf12 \strokec12 1\cf4 \strokec4  \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 monthly_rent_growth\cf4 \strokec4 ) \cf9 \strokec9 **\cf4 \strokec4  (\cf8 \strokec8 months\cf4 \strokec4  \cf7 \strokec7 -\cf4 \strokec4  \cf12 \strokec12 1\cf4 \strokec4 )\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 salary\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 salary_expense\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 *\cf4 \strokec4  (\cf12 \strokec12 1\cf4 \strokec4  \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 monthly_salary_growth\cf4 \strokec4 ) \cf9 \strokec9 **\cf4 \strokec4  (\cf8 \strokec8 months\cf4 \strokec4  \cf7 \strokec7 -\cf4 \strokec4  \cf12 \strokec12 1\cf4 \strokec4 )\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 other_exp\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 miscellaneous_expenses\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 *\cf4 \strokec4  (\cf12 \strokec12 1\cf4 \strokec4  \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 monthly_other_expenses_growth\cf4 \strokec4 ) \cf9 \strokec9 **\cf4 \strokec4  (\cf8 \strokec8 months\cf4 \strokec4  \cf7 \strokec7 -\cf4 \strokec4  \cf12 \strokec12 1\cf4 \strokec4 )\cb1 \
\cb3         )\cb1 \
\
\cb3         \cf8 \strokec8 marketing\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 np\cf4 \strokec4 .\cf7 \strokec7 full\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 time_horizon\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 marketing_expenses\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 insurance\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 np\cf4 \strokec4 .\cf7 \strokec7 full\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 time_horizon\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 insurance_expenses\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 taxes\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 np\cf4 \strokec4 .\cf7 \strokec7 full\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 time_horizon\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 taxes\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 utilities\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 np\cf4 \strokec4 .\cf7 \strokec7 full\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 time_horizon\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 utilities_expenses\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 maintenance\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 np\cf4 \strokec4 .\cf7 \strokec7 full\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 time_horizon\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 maintenance_expenses\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 depreciation\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 np\cf4 \strokec4 .\cf7 \strokec7 full\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 time_horizon\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 depreciation_expense\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 electricity\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 total_area\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 electricity_cost_per_m2\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 packaging\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 total_area\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 packaging_cost_per_m2\cf4 \cb1 \strokec4 \
\
\cb3         \cf8 \strokec8 monthly_expenses\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cb1 \
\cb3             \cf8 \strokec8 rent\cf4 \cb1 \strokec4 \
\cb3             \cf7 \strokec7 +\cf4 \strokec4  \cf8 \strokec8 salary\cf4 \cb1 \strokec4 \
\cb3             \cf7 \strokec7 +\cf4 \strokec4  \cf8 \strokec8 other_exp\cf4 \cb1 \strokec4 \
\cb3             \cf7 \strokec7 +\cf4 \strokec4  \cf8 \strokec8 marketing\cf4 \cb1 \strokec4 \
\cb3             \cf7 \strokec7 +\cf4 \strokec4  \cf8 \strokec8 insurance\cf4 \cb1 \strokec4 \
\cb3             \cf7 \strokec7 +\cf4 \strokec4  \cf8 \strokec8 taxes\cf4 \cb1 \strokec4 \
\cb3             \cf7 \strokec7 +\cf4 \strokec4  \cf8 \strokec8 utilities\cf4 \cb1 \strokec4 \
\cb3             \cf7 \strokec7 +\cf4 \strokec4  \cf8 \strokec8 maintenance\cf4 \cb1 \strokec4 \
\cb3             \cf7 \strokec7 +\cf4 \strokec4  \cf8 \strokec8 depreciation\cf4 \cb1 \strokec4 \
\cb3             \cf7 \strokec7 +\cf4 \strokec4  \cf8 \strokec8 electricity\cf4 \cb1 \strokec4 \
\cb3             \cf7 \strokec7 +\cf4 \strokec4  \cf8 \strokec8 packaging\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 time_horizon\cf4 \strokec4  \cf9 \strokec9 >\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 :\cb1 \
\cb3             \cf8 \strokec8 monthly_expenses\cf4 \strokec4  \cf7 \strokec7 +=\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 one_time_expenses\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 time_horizon\cf4 \cb1 \strokec4 \
\
\cb3         \cf8 \strokec8 monthly_incomes\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 start_income\cf4 \strokec4  \cf7 \strokec7 *\cf4 \strokec4  (\cf12 \strokec12 1\cf4 \strokec4  \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 monthly_income_growth\cf4 \strokec4 ) \cf9 \strokec9 **\cf4 \strokec4  (\cf8 \strokec8 months\cf4 \strokec4  \cf7 \strokec7 -\cf4 \strokec4  \cf12 \strokec12 1\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 monthly_profit\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 monthly_incomes\cf4 \strokec4  \cf7 \strokec7 -\cf4 \strokec4  \cf8 \strokec8 monthly_expenses\cf4 \cb1 \strokec4 \
\
\cb3         \cf8 \strokec8 df\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 pd\cf4 \strokec4 .\cf6 \strokec6 DataFrame\cf4 \strokec4 (\{\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1052 \u1077 \u1089 \u1103 \u1094 "\cf4 \strokec4 : \cf8 \strokec8 months\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1044 \u1086 \u1093 \u1086 \u1076 "\cf4 \strokec4 : \cf8 \strokec8 monthly_incomes\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1056 \u1072 \u1089 \u1093 \u1086 \u1076 "\cf4 \strokec4 : \cf8 \strokec8 monthly_expenses\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1055 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100 "\cf4 \strokec4 : \cf8 \strokec8 monthly_profit\cf4 \strokec4 ,\cb1 \
\cb3         \})\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf8 \strokec8 df\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 except\cf4 \strokec4  \cf6 \strokec6 Exception\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf8 \strokec8 e\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 logging\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1054 \u1096 \u1080 \u1073 \u1082 \u1072  \u1074  calculate_monthly_projection: \cf11 \strokec11 \{\cf8 \strokec8 e\cf11 \strokec11 \}\cf10 \strokec10 "\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf6 \strokec6 pd\cf4 \strokec4 .\cf6 \strokec6 DataFrame\cf4 \strokec4 ()\cb1 \
\pard\pardeftab560\slleading20\pardirnatural\partightenfactor0

\f0\fs26 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 \
\
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 \'b4\'b4\'b4\uc0\u8232 \
\uc0\u1060 \u1072 \u1081 \u1083 : ui.py\
\
\'b4\'b4\'b4python\
\pard\pardeftab720\partightenfactor0

\f1\fs24 \cf2 \cb3 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 # ui.py\cf4 \cb1 \strokec4 \
\
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 streamlit\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf6 \strokec6 st\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 pandas\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf6 \strokec6 pd\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 numpy\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf6 \strokec6 np\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 plotly\cf4 \strokec4 .\cf6 \strokec6 express\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf6 \strokec6 px\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 from\cf4 \strokec4  \cf6 \strokec6 utils\cf4 \strokec4  \cf5 \strokec5 import\cf4 \strokec4  \cf7 \strokec7 generate_download_link\cf4 \strokec4 , \cf7 \strokec7 generate_excel_download\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 from\cf4 \strokec4  \cf6 \strokec6 calculations\cf4 \strokec4  \cf5 \strokec5 import\cf4 \strokec4  (\cb1 \
\cb3     \cf7 \strokec7 calculate_additional_metrics\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 calculate_roi\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 calculate_irr\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 calculate_total_bep\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 monte_carlo_simulation\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 calculate_financials\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 min_loan_amount_for_bep\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 calculate_monthly_bep\cf4 \strokec4 ,\cb1 \
\cb3 )\cb1 \
\cf5 \cb3 \strokec5 from\cf4 \strokec4  \cf6 \strokec6 ml_models\cf4 \strokec4  \cf5 \strokec5 import\cf4 \strokec4  \cf7 \strokec7 train_ml_model\cf4 \strokec4 , \cf7 \strokec7 predict_with_model\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 joblib\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 os\cf4 \cb1 \strokec4 \
\
\cf11 \cb3 \strokec11 class\cf4 \strokec4  \cf6 \strokec6 MetricDisplay\cf4 \strokec4 :\cb1 \
\cb3     \cf11 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 __init__\cf4 \strokec4 (\cf8 \strokec8 self\cf4 \strokec4 , \cf8 \strokec8 label\cf4 \strokec4 ):\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf8 \strokec8 label\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 label\cf4 \cb1 \strokec4 \
\
\cb3     \cf11 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 display\cf4 \strokec4 (\cf8 \strokec8 self\cf4 \strokec4 , \cf8 \strokec8 col\cf4 \strokec4 , \cf8 \strokec8 value\cf4 \strokec4 ):\cb1 \
\cb3         \cf8 \strokec8 col\cf4 \strokec4 .metric(\cf8 \strokec8 self\cf4 \strokec4 .\cf8 \strokec8 label\cf4 \strokec4 , \cf11 \strokec11 f\cf10 \strokec10 "\cf11 \strokec11 \{\cf8 \strokec8 value\cf11 \strokec11 :,.2f\}\cf10 \strokec10 "\cf4 \strokec4 )\cb1 \
\
\
\cf11 \cb3 \strokec11 class\cf4 \strokec4  \cf6 \strokec6 ChartDisplay\cf4 \strokec4 :\cb1 \
\cb3     \cf11 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 __init__\cf4 \strokec4 (\cf8 \strokec8 self\cf4 \strokec4 , \cf8 \strokec8 title\cf4 \strokec4 , \cf8 \strokec8 x_title\cf9 \strokec9 =\cf10 \strokec10 ""\cf4 \strokec4 , \cf8 \strokec8 y_title\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1056 \u1091 \u1073 \u1083 \u1080 "\cf4 \strokec4 , \cf8 \strokec8 color_map\cf9 \strokec9 =\cf11 \strokec11 None\cf4 \strokec4 ):\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf8 \strokec8 title\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 title\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf8 \strokec8 x_title\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 x_title\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf8 \strokec8 y_title\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 y_title\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf8 \strokec8 color_map\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 color_map\cf4 \cb1 \strokec4 \
\
\cb3     \cf11 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 display_bar\cf4 \strokec4 (\cf8 \strokec8 self\cf4 \strokec4 , \cf8 \strokec8 df\cf4 \strokec4 , \cf8 \strokec8 x\cf4 \strokec4 , \cf8 \strokec8 y\cf4 \strokec4 , \cf9 \strokec9 **\cf8 \strokec8 kwargs\cf4 \strokec4 ):\cb1 \
\cb3         \cf8 \strokec8 fig\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 px\cf4 \strokec4 .\cf7 \strokec7 bar\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 df\cf4 \strokec4 , \cf8 \strokec8 x\cf9 \strokec9 =\cf8 \strokec8 x\cf4 \strokec4 , \cf8 \strokec8 y\cf9 \strokec9 =\cf8 \strokec8 y\cf4 \strokec4 , \cf8 \strokec8 title\cf9 \strokec9 =\cf8 \strokec8 self\cf4 \strokec4 .\cf8 \strokec8 title\cf4 \strokec4 , \cf8 \strokec8 text\cf9 \strokec9 =\cf8 \strokec8 y\cf4 \strokec4 , \cf8 \strokec8 color\cf9 \strokec9 =\cf8 \strokec8 x\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 color_discrete_map\cf9 \strokec9 =\cf8 \strokec8 self\cf4 \strokec4 .\cf8 \strokec8 color_map\cf4 \strokec4 , \cf9 \strokec9 **\cf8 \strokec8 kwargs\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 fig\cf4 \strokec4 .\cf7 \strokec7 update_traces\cf4 \strokec4 (\cf8 \strokec8 textposition\cf9 \strokec9 =\cf10 \strokec10 "outside"\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 fig\cf4 \strokec4 .\cf7 \strokec7 update_layout\cf4 \strokec4 (\cf8 \strokec8 yaxis_title\cf9 \strokec9 =\cf8 \strokec8 self\cf4 \strokec4 .\cf8 \strokec8 y_title\cf4 \strokec4 , \cf8 \strokec8 xaxis_title\cf9 \strokec9 =\cf8 \strokec8 self\cf4 \strokec4 .\cf8 \strokec8 x_title\cf4 \strokec4 )\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 plotly_chart\cf4 \strokec4 (\cf8 \strokec8 fig\cf4 \strokec4 , \cf8 \strokec8 use_container_width\cf9 \strokec9 =\cf11 \strokec11 True\cf4 \strokec4 )\cb1 \
\
\cb3     \cf11 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 display_line\cf4 \strokec4 (\cf8 \strokec8 self\cf4 \strokec4 , \cf8 \strokec8 df\cf4 \strokec4 , \cf8 \strokec8 x\cf4 \strokec4 , \cf8 \strokec8 y\cf4 \strokec4 , \cf8 \strokec8 markers\cf9 \strokec9 =\cf11 \strokec11 True\cf4 \strokec4 , \cf8 \strokec8 color\cf9 \strokec9 =\cf11 \strokec11 None\cf4 \strokec4 , \cf8 \strokec8 y_range\cf9 \strokec9 =\cf11 \strokec11 None\cf4 \strokec4 , \cf9 \strokec9 **\cf8 \strokec8 kwargs\cf4 \strokec4 ):\cb1 \
\cb3         \cf8 \strokec8 fig\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 px\cf4 \strokec4 .\cf7 \strokec7 line\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 df\cf4 \strokec4 , \cf8 \strokec8 x\cf9 \strokec9 =\cf8 \strokec8 x\cf4 \strokec4 , \cf8 \strokec8 y\cf9 \strokec9 =\cf8 \strokec8 y\cf4 \strokec4 , \cf8 \strokec8 title\cf9 \strokec9 =\cf8 \strokec8 self\cf4 \strokec4 .\cf8 \strokec8 title\cf4 \strokec4 , \cf8 \strokec8 markers\cf9 \strokec9 =\cf8 \strokec8 markers\cf4 \strokec4 , \cf8 \strokec8 color\cf9 \strokec9 =\cf8 \strokec8 color\cf4 \strokec4 , \cf9 \strokec9 **\cf8 \strokec8 kwargs\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 y_range\cf4 \strokec4 :\cb1 \
\cb3             \cf8 \strokec8 fig\cf4 \strokec4 .\cf7 \strokec7 update_layout\cf4 \strokec4 (\cf8 \strokec8 yaxis\cf9 \strokec9 =\cf4 \strokec4 \{\cf10 \strokec10 "range"\cf4 \strokec4 : \cf8 \strokec8 y_range\cf4 \strokec4 \})\cb1 \
\cb3         \cf8 \strokec8 fig\cf4 \strokec4 .\cf7 \strokec7 update_layout\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 xaxis_title\cf9 \strokec9 =\cf8 \strokec8 self\cf4 \strokec4 .\cf8 \strokec8 x_title\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 yaxis_title\cf9 \strokec9 =\cf8 \strokec8 self\cf4 \strokec4 .\cf8 \strokec8 y_title\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 plotly_chart\cf4 \strokec4 (\cf8 \strokec8 fig\cf4 \strokec4 , \cf8 \strokec8 use_container_width\cf9 \strokec9 =\cf11 \strokec11 True\cf4 \strokec4 )\cb1 \
\
\
\cf11 \cb3 \strokec11 class\cf4 \strokec4  \cf6 \strokec6 TableDisplay\cf4 \strokec4 :\cb1 \
\cb3     \cf11 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 display\cf4 \strokec4 (\cf8 \strokec8 self\cf4 \strokec4 , \cf8 \strokec8 df\cf4 \strokec4 ):\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 dataframe\cf4 \strokec4 (\cf8 \strokec8 df\cf4 \strokec4 )\cb1 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 display_tab1_header\cf4 \strokec4 (\cf8 \strokec8 tab\cf4 \strokec4 ):\cb1 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf8 \strokec8 tab\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 header\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u55357 \u56522  \u1054 \u1073 \u1097 \u1080 \u1077  \u1088 \u1077 \u1079 \u1091 \u1083 \u1100 \u1090 \u1072 \u1090 \u1099 "\cf4 \strokec4 )\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 write\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1050 \u1083 \u1102 \u1095 \u1077 \u1074 \u1099 \u1077  \u1092 \u1080 \u1085 \u1072 \u1085 \u1089 \u1086 \u1074 \u1099 \u1077  \u1087 \u1086 \u1082 \u1072 \u1079 \u1072 \u1090 \u1077 \u1083 \u1080  \u1090 \u1077 \u1082 \u1091 \u1097 \u1077 \u1081  \u1082 \u1086 \u1085 \u1092 \u1080 \u1075 \u1091 \u1088 \u1072 \u1094 \u1080 \u1080  \u1089 \u1082 \u1083 \u1072 \u1076 \u1072 ."\cf4 \strokec4 )\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 info\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1047 \u1076 \u1077 \u1089 \u1100  \u1074 \u1099  \u1074 \u1080 \u1076 \u1080 \u1090 \u1077  \u1076 \u1086 \u1093 \u1086 \u1076 \u1099 , \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1099 , \u1087 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100 , ROI, IRR \u1080  \u1076 \u1088 . "\cf4 \cb1 \strokec4 \
\cb3             \cf10 \strokec10 "\uc0\u1048 \u1089 \u1087 \u1086 \u1083 \u1100 \u1079 \u1091 \u1081 \u1090 \u1077  \u1101 \u1090 \u1080  \u1087 \u1086 \u1082 \u1072 \u1079 \u1072 \u1090 \u1077 \u1083 \u1080 , \u1095 \u1090 \u1086 \u1073 \u1099  \u1086 \u1094 \u1077 \u1085 \u1080 \u1090 \u1100  \u1101 \u1092 \u1092 \u1077 \u1082 \u1090 \u1080 \u1074 \u1085 \u1086 \u1089 \u1090 \u1100  \u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1103 . "\cf4 \cb1 \strokec4 \
\cb3             \cf10 \strokec10 "\uc0\u1053 \u1072 \u1087 \u1088 \u1080 \u1084 \u1077 \u1088 , \u1077 \u1089 \u1083 \u1080  IRR \u1080  ROI \u1074 \u1099 \u1089 \u1086 \u1082 \u1080 \u1077 , \u1089 \u1082 \u1083 \u1072 \u1076  \u1084 \u1086 \u1078 \u1077 \u1090  \u1073 \u1099 \u1090 \u1100  \u1087 \u1088 \u1080 \u1074 \u1083 \u1077 \u1082 \u1072 \u1090 \u1077 \u1083 \u1100 \u1085 \u1099 \u1084  \u1076 \u1083 \u1103  \u1080 \u1085 \u1074 \u1077 \u1089 \u1090 \u1080 \u1094 \u1080 \u1081 ."\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 display_tab1_metrics\cf4 \strokec4 (\cf8 \strokec8 tab\cf4 \strokec4 , \cf8 \strokec8 base_financials\cf4 \strokec4 , \cf8 \strokec8 profit_margin\cf4 \strokec4 , \cf8 \strokec8 profitability\cf4 \strokec4 , \cf8 \strokec8 roi\cf4 \strokec4 , \cf8 \strokec8 irr\cf4 \strokec4 ):\cb1 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf8 \strokec8 tab\cf4 \strokec4 :\cb1 \
\cb3         \cf8 \strokec8 col1\cf4 \strokec4 , \cf8 \strokec8 col2\cf4 \strokec4 , \cf8 \strokec8 col3\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 columns\cf4 \strokec4 (\cf12 \strokec12 3\cf4 \strokec4 )\cb1 \
\cb3         \cf6 \strokec6 MetricDisplay\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1054 \u1073 \u1097 \u1080 \u1081  \u1076 \u1086 \u1093 \u1086 \u1076  (\u1088 \u1091 \u1073 .)"\cf4 \strokec4 ).\cf7 \strokec7 display\cf4 \strokec4 (\cf8 \strokec8 col1\cf4 \strokec4 , \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "total_income"\cf4 \strokec4 ])\cb1 \
\cb3         \cf6 \strokec6 MetricDisplay\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1054 \u1073 \u1097 \u1080 \u1077  \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1099  (\u1088 \u1091 \u1073 .)"\cf4 \strokec4 ).\cf7 \strokec7 display\cf4 \strokec4 (\cf8 \strokec8 col2\cf4 \strokec4 , \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "total_expenses"\cf4 \strokec4 ])\cb1 \
\cb3         \cf6 \strokec6 MetricDisplay\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1055 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100  (\u1088 \u1091 \u1073 .)"\cf4 \strokec4 ).\cf7 \strokec7 display\cf4 \strokec4 (\cf8 \strokec8 col3\cf4 \strokec4 , \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "profit"\cf4 \strokec4 ])\cb1 \
\
\cb3         \cf8 \strokec8 col4\cf4 \strokec4 , \cf8 \strokec8 col5\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 columns\cf4 \strokec4 (\cf12 \strokec12 2\cf4 \strokec4 )\cb1 \
\cb3         \cf6 \strokec6 MetricDisplay\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1052 \u1072 \u1088 \u1078 \u1072  \u1087 \u1088 \u1080 \u1073 \u1099 \u1083 \u1080  (%)"\cf4 \strokec4 ).\cf7 \strokec7 display\cf4 \strokec4 (\cf8 \strokec8 col4\cf4 \strokec4 , \cf8 \strokec8 profit_margin\cf4 \strokec4 )\cb1 \
\cb3         \cf6 \strokec6 MetricDisplay\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1056 \u1077 \u1085 \u1090 \u1072 \u1073 \u1077 \u1083 \u1100 \u1085 \u1086 \u1089 \u1090 \u1100  (%)"\cf4 \strokec4 ).\cf7 \strokec7 display\cf4 \strokec4 (\cf8 \strokec8 col5\cf4 \strokec4 , \cf8 \strokec8 profitability\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 col6\cf4 \strokec4 , \cf8 \strokec8 col7\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 columns\cf4 \strokec4 (\cf12 \strokec12 2\cf4 \strokec4 )\cb1 \
\cb3         \cf6 \strokec6 MetricDisplay\cf4 \strokec4 (\cf10 \strokec10 "ROI (%)"\cf4 \strokec4 ).\cf7 \strokec7 display\cf4 \strokec4 (\cf8 \strokec8 col6\cf4 \strokec4 , \cf8 \strokec8 roi\cf4 \strokec4  \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 roi\cf4 \strokec4  \cf5 \strokec5 is\cf4 \strokec4  \cf5 \strokec5 not\cf4 \strokec4  \cf11 \strokec11 None\cf4 \strokec4  \cf5 \strokec5 else\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 col7\cf4 \strokec4 .\cf7 \strokec7 metric\cf4 \strokec4 (\cf10 \strokec10 "IRR (%)"\cf4 \strokec4 , \cf11 \strokec11 f\cf10 \strokec10 "\cf11 \strokec11 \{\cf8 \strokec8 irr\cf11 \strokec11 :.2f\}\cf10 \strokec10 %"\cf4 \strokec4 )\cb1 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 display_tab1_bep\cf4 \strokec4 (\cf8 \strokec8 tab\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 base_financials\cf4 \strokec4 ):\cb1 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf8 \strokec8 tab\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 write\cf4 \strokec4 (\cf10 \strokec10 "---"\cf4 \strokec4 )\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 subheader\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1052 \u1080 \u1085 . \u1089 \u1091 \u1084 \u1084 \u1072  \u1079 \u1072 \u1081 \u1084 \u1072  \u1076 \u1083 \u1103  BEP (\u1079 \u1072 \u1081 \u1084 \u1099 )"\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 min_loan\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 min_loan_amount_for_bep\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 base_financials\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf6 \strokec6 np\cf4 \strokec4 .\cf8 \strokec8 isinf\cf4 \strokec4 (\cf8 \strokec8 min_loan\cf4 \strokec4 ):\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 write\cf4 \strokec4 (\cf10 \strokec10 "**\uc0\u1041 \u1077 \u1089 \u1082 \u1086 \u1085 \u1077 \u1095 \u1085 \u1086 \u1089 \u1090 \u1100 ** \'97 \u1085 \u1077 \u1074 \u1086 \u1079 \u1084 \u1086 \u1078 \u1085 \u1086  \u1087 \u1086 \u1082 \u1088 \u1099 \u1090 \u1100  \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1099 ."\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 else\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 write\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "**\cf11 \strokec11 \{\cf8 \strokec8 min_loan\cf11 \strokec11 :,.2f\}\cf10 \strokec10  \uc0\u1088 \u1091 \u1073 .** \'97 \u1084 \u1080 \u1085 \u1080 \u1084 \u1072 \u1083 \u1100 \u1085 \u1072 \u1103  \u1089 \u1091 \u1084 \u1084 \u1072  \u1079 \u1072 \u1081 \u1084 \u1072  \u1076 \u1083 \u1103  \u1090 \u1086 \u1095 \u1082 \u1080  \u1073 \u1077 \u1079 \u1091 \u1073 \u1099 \u1090 \u1086 \u1095 \u1085 \u1086 \u1089 \u1090 \u1080 ."\cf4 \strokec4 )\cb1 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 display_tab1_chart\cf4 \strokec4 (\cf8 \strokec8 tab\cf4 \strokec4 , \cf8 \strokec8 base_financials\cf4 \strokec4 ):\cb1 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf8 \strokec8 tab\cf4 \strokec4 :\cb1 \
\cb3         \cf8 \strokec8 df_plot\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 pd\cf4 \strokec4 .\cf6 \strokec6 DataFrame\cf4 \strokec4 (\{\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1050 \u1072 \u1090 \u1077 \u1075 \u1086 \u1088 \u1080 \u1103 "\cf4 \strokec4 : [\cf10 \strokec10 "\uc0\u1044 \u1086 \u1093 \u1086 \u1076 "\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1056 \u1072 \u1089 \u1093 \u1086 \u1076 "\cf4 \strokec4 ],\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1047 \u1085 \u1072 \u1095 \u1077 \u1085 \u1080 \u1077 "\cf4 \strokec4 : [\cb1 \
\cb3                 \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "total_income"\cf4 \strokec4 ],\cb1 \
\cb3                 \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "total_expenses"\cf4 \strokec4 ]\cb1 \
\cb3             ]\cb1 \
\cb3         \})\cb1 \
\cb3         \cf8 \strokec8 chart_display\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 ChartDisplay\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1044 \u1086 \u1093 \u1086 \u1076 \u1099  \u1080  \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1099 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 color_map\cf9 \strokec9 =\cf4 \strokec4 \{\cf10 \strokec10 "\uc0\u1044 \u1086 \u1093 \u1086 \u1076 "\cf4 \strokec4 : \cf10 \strokec10 "green"\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1056 \u1072 \u1089 \u1093 \u1086 \u1076 "\cf4 \strokec4 : \cf10 \strokec10 "red"\cf4 \strokec4 \}\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 chart_display\cf4 \strokec4 .\cf7 \strokec7 display_bar\cf4 \strokec4 (\cf8 \strokec8 df_plot\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1050 \u1072 \u1090 \u1077 \u1075 \u1086 \u1088 \u1080 \u1103 "\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1047 \u1085 \u1072 \u1095 \u1077 \u1085 \u1080 \u1077 "\cf4 \strokec4 )\cb1 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 display_tab1_analysis\cf4 \strokec4 (\cf8 \strokec8 tab\cf4 \strokec4 , \cf8 \strokec8 base_financials\cf4 \strokec4 , \cf8 \strokec8 profit_margin\cf4 \strokec4 , \cf8 \strokec8 profitability\cf4 \strokec4 , \cf8 \strokec8 roi\cf4 \strokec4 , \cf8 \strokec8 irr\cf4 \strokec4 ):\cb1 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf8 \strokec8 tab\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 write\cf4 \strokec4 (\cf10 \strokec10 "---"\cf4 \strokec4 )\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 subheader\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1040 \u1085 \u1072 \u1083 \u1080 \u1079  \u1088 \u1077 \u1079 \u1091 \u1083 \u1100 \u1090 \u1072 \u1090 \u1086 \u1074 "\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 profit\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "profit"\cf4 \strokec4 ]\cb1 \
\
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 profit\cf4 \strokec4  \cf9 \strokec9 >\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 success\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u9989  \u1050 \u1086 \u1085 \u1092 \u1080 \u1075 \u1091 \u1088 \u1072 \u1094 \u1080 \u1103  \u1087 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100 \u1085 \u1072 ."\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 elif\cf4 \strokec4  \cf8 \strokec8 profit\cf4 \strokec4  \cf9 \strokec9 <\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 error\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u10060  \u1050 \u1086 \u1085 \u1092 \u1080 \u1075 \u1091 \u1088 \u1072 \u1094 \u1080 \u1103  \u1091 \u1073 \u1099 \u1090 \u1086 \u1095 \u1085 \u1072 ."\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 else\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 info\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u9888 \u65039  \u1055 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100  = 0 (\u1090 \u1086 \u1095 \u1082 \u1072  \u1073 \u1077 \u1079 \u1091 \u1073 \u1099 \u1090 \u1086 \u1095 \u1085 \u1086 \u1089 \u1090 \u1080 )."\cf4 \strokec4 )\cb1 \
\
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 profit_margin\cf4 \strokec4  \cf9 \strokec9 >\cf4 \strokec4  \cf12 \strokec12 10\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 success\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u9989  \u1052 \u1072 \u1088 \u1078 \u1072  \u1087 \u1088 \u1080 \u1073 \u1099 \u1083 \u1080  \u1074 \u1099 \u1089 \u1086 \u1082 \u1072 \u1103  (\cf11 \strokec11 \{\cf8 \strokec8 profit_margin\cf11 \strokec11 :.2f\}\cf10 \strokec10 %)."\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 elif\cf4 \strokec4  \cf8 \strokec8 profit_margin\cf4 \strokec4  \cf9 \strokec9 <\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 error\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u10060  \u1052 \u1072 \u1088 \u1078 \u1072  \u1087 \u1088 \u1080 \u1073 \u1099 \u1083 \u1080  \u1086 \u1090 \u1088 \u1080 \u1094 \u1072 \u1090 \u1077 \u1083 \u1100 \u1085 \u1072 \u1103  (\cf11 \strokec11 \{\cf8 \strokec8 profit_margin\cf11 \strokec11 :.2f\}\cf10 \strokec10 %)."\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 else\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 info\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u9888 \u65039  \u1052 \u1072 \u1088 \u1078 \u1072  \u1087 \u1088 \u1080 \u1073 \u1099 \u1083 \u1080 : \cf11 \strokec11 \{\cf8 \strokec8 profit_margin\cf11 \strokec11 :.2f\}\cf10 \strokec10 %."\cf4 \strokec4 )\cb1 \
\
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 profitability\cf4 \strokec4  \cf9 \strokec9 >\cf4 \strokec4  \cf12 \strokec12 15\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 success\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u9989  \u1042 \u1099 \u1089 \u1086 \u1082 \u1072 \u1103  \u1088 \u1077 \u1085 \u1090 \u1072 \u1073 \u1077 \u1083 \u1100 \u1085 \u1086 \u1089 \u1090 \u1100  (\cf11 \strokec11 \{\cf8 \strokec8 profitability\cf11 \strokec11 :.2f\}\cf10 \strokec10 %)."\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 elif\cf4 \strokec4  \cf8 \strokec8 profitability\cf4 \strokec4  \cf9 \strokec9 <\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 error\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u10060  \u1056 \u1077 \u1085 \u1090 \u1072 \u1073 \u1077 \u1083 \u1100 \u1085 \u1086 \u1089 \u1090 \u1100  \u1086 \u1090 \u1088 \u1080 \u1094 \u1072 \u1090 \u1077 \u1083 \u1100 \u1085 \u1072 \u1103  (\cf11 \strokec11 \{\cf8 \strokec8 profitability\cf11 \strokec11 :.2f\}\cf10 \strokec10 %)."\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 else\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 info\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u9888 \u65039  \u1056 \u1077 \u1085 \u1090 \u1072 \u1073 \u1077 \u1083 \u1100 \u1085 \u1086 \u1089 \u1090 \u1100 : \cf11 \strokec11 \{\cf8 \strokec8 profitability\cf11 \strokec11 :.2f\}\cf10 \strokec10 %."\cf4 \strokec4 )\cb1 \
\
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 roi\cf4 \strokec4  \cf11 \strokec11 is\cf4 \strokec4  \cf11 \strokec11 not\cf4 \strokec4  \cf11 \strokec11 None\cf4 \strokec4 :\cb1 \
\cb3             \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 roi\cf4 \strokec4  \cf9 \strokec9 >\cf4 \strokec4  \cf12 \strokec12 10\cf4 \strokec4 :\cb1 \
\cb3                 \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 success\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u9989  ROI \u1074 \u1099 \u1089 \u1086 \u1082 \u1080 \u1081  (\cf11 \strokec11 \{\cf8 \strokec8 roi\cf11 \strokec11 :.2f\}\cf10 \strokec10 %)."\cf4 \strokec4 )\cb1 \
\cb3             \cf5 \strokec5 elif\cf4 \strokec4  \cf8 \strokec8 roi\cf4 \strokec4  \cf9 \strokec9 <\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 :\cb1 \
\cb3                 \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 error\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u10060  ROI \u1086 \u1090 \u1088 \u1080 \u1094 \u1072 \u1090 \u1077 \u1083 \u1100 \u1085 \u1099 \u1081  (\cf11 \strokec11 \{\cf8 \strokec8 roi\cf11 \strokec11 :.2f\}\cf10 \strokec10 %)."\cf4 \strokec4 )\cb1 \
\cb3             \cf5 \strokec5 else\cf4 \strokec4 :\cb1 \
\cb3                 \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 info\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u9888 \u65039  ROI: \cf11 \strokec11 \{\cf8 \strokec8 roi\cf11 \strokec11 :.2f\}\cf10 \strokec10 %."\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 else\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 warning\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u9888 \u65039  \u1053 \u1077 \u1074 \u1086 \u1079 \u1084 \u1086 \u1078 \u1085 \u1086  \u1074 \u1099 \u1095 \u1080 \u1089 \u1083 \u1080 \u1090 \u1100  ROI, \u1090 .\u1082 . \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1099  = 0."\cf4 \strokec4 )\cb1 \
\
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 irr\cf4 \strokec4  \cf9 \strokec9 >\cf4 \strokec4  \cf12 \strokec12 10\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 success\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u9989  IRR \u1074 \u1099 \u1089 \u1086 \u1082 \u1080 \u1081  (\cf11 \strokec11 \{\cf8 \strokec8 irr\cf11 \strokec11 :.2f\}\cf10 \strokec10 %)."\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 elif\cf4 \strokec4  \cf8 \strokec8 irr\cf4 \strokec4  \cf9 \strokec9 <\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 error\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u10060  IRR \u1086 \u1090 \u1088 \u1080 \u1094 \u1072 \u1090 \u1077 \u1083 \u1100 \u1085 \u1099 \u1081  (\cf11 \strokec11 \{\cf8 \strokec8 irr\cf11 \strokec11 :.2f\}\cf10 \strokec10 %)."\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 else\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 info\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u9888 \u65039  IRR: \cf11 \strokec11 \{\cf8 \strokec8 irr\cf11 \strokec11 :.2f\}\cf10 \strokec10 %."\cf4 \strokec4 )\cb1 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 display_tab1\cf4 \strokec4 (\cf8 \strokec8 tab\cf4 \strokec4 , \cf8 \strokec8 base_financials\cf4 \strokec4 , \cf8 \strokec8 pm\cf4 \strokec4 , \cf8 \strokec8 pr\cf4 \strokec4 , \cf8 \strokec8 roi\cf4 \strokec4 , \cf8 \strokec8 irr\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 selected_param\cf9 \strokec9 =\cf11 \strokec11 None\cf4 \strokec4 ):\cb1 \
\cb3     \cf7 \strokec7 display_tab1_header\cf4 \strokec4 (\cf8 \strokec8 tab\cf4 \strokec4 )\cb1 \
\cb3     \cf7 \strokec7 display_tab1_metrics\cf4 \strokec4 (\cf8 \strokec8 tab\cf4 \strokec4 , \cf8 \strokec8 base_financials\cf4 \strokec4 , \cf8 \strokec8 pm\cf4 \strokec4 , \cf8 \strokec8 pr\cf4 \strokec4 , \cf8 \strokec8 roi\cf4 \strokec4 , \cf8 \strokec8 irr\cf4 \strokec4 )\cb1 \
\cb3     \cf7 \strokec7 display_tab1_bep\cf4 \strokec4 (\cf8 \strokec8 tab\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 base_financials\cf4 \strokec4 )\cb1 \
\cb3     \cf7 \strokec7 display_tab1_chart\cf4 \strokec4 (\cf8 \strokec8 tab\cf4 \strokec4 , \cf8 \strokec8 base_financials\cf4 \strokec4 )\cb1 \
\cb3     \cf7 \strokec7 display_tab1_analysis\cf4 \strokec4 (\cf8 \strokec8 tab\cf4 \strokec4 , \cf8 \strokec8 base_financials\cf4 \strokec4 , \cf8 \strokec8 pm\cf4 \strokec4 , \cf8 \strokec8 pr\cf4 \strokec4 , \cf8 \strokec8 roi\cf4 \strokec4 , \cf8 \strokec8 irr\cf4 \strokec4 )\cb1 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf8 \strokec8 tab\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 markdown\cf4 \strokec4 (\cf10 \strokec10 """\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         <b>\uc0\u1054 \u1089 \u1085 \u1086 \u1074 \u1085 \u1099 \u1077  \u1090 \u1077 \u1088 \u1084 \u1080 \u1085 \u1099 :</b><br/>\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         <ul>\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10           <li><b>\uc0\u1055 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100 </b>: \u1076 \u1086 \u1093 \u1086 \u1076 \u1099  - \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1099 </li>\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10           <li><b>\uc0\u1052 \u1072 \u1088 \u1078 \u1072  \u1087 \u1088 \u1080 \u1073 \u1099 \u1083 \u1080 </b>: (\u1087 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100  / \u1076 \u1086 \u1093 \u1086 \u1076 \u1099 )*100</li>\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10           <li><b>\uc0\u1056 \u1077 \u1085 \u1090 \u1072 \u1073 \u1077 \u1083 \u1100 \u1085 \u1086 \u1089 \u1090 \u1100 </b>: (\u1087 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100  / \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1099 )*100</li>\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10           <li><b>ROI</b>: ((\uc0\u1076 \u1086 \u1093 \u1086 \u1076 \u1099  - \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1099 )/\u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1099 )*100, \u1087 \u1086 \u1082 \u1072 \u1079 \u1099 \u1074 \u1072 \u1077 \u1090  \u1074 \u1086 \u1079 \u1074 \u1088 \u1072 \u1090  \u1085 \u1072  \u1080 \u1085 \u1074 \u1077 \u1089 \u1090 \u1080 \u1094 \u1080 \u1080 </li>\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10           <li><b>IRR</b>: \uc0\u1074 \u1085 \u1091 \u1090 \u1088 \u1077 \u1085 \u1085 \u1103 \u1103  \u1085 \u1086 \u1088 \u1084 \u1072  \u1076 \u1086 \u1093 \u1086 \u1076 \u1085 \u1086 \u1089 \u1090 \u1080  (\u1087 \u1086 \u1082 \u1072 \u1079 \u1099 \u1074 \u1072 \u1077 \u1090  \u1076 \u1086 \u1093 \u1086 \u1076 \u1085 \u1086 \u1089 \u1090 \u1100  \u1087 \u1088 \u1086 \u1077 \u1082 \u1090 \u1072  \u1089  \u1091 \u1095 \u1105 \u1090 \u1086 \u1084  \u1076 \u1080 \u1089 \u1082 \u1086 \u1085 \u1090 \u1080 \u1088 \u1086 \u1074 \u1072 \u1085 \u1080 \u1103 )</li>\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         </ul>\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         """\cf4 \strokec4 , \cf8 \strokec8 unsafe_allow_html\cf9 \strokec9 =\cf11 \strokec11 True\cf4 \strokec4 )\cb1 \
\
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 selected_param\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 write\cf4 \strokec4 (\cf10 \strokec10 "---"\cf4 \strokec4 )\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 subheader\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1057 \u1088 \u1072 \u1074 \u1085 \u1077 \u1085 \u1080 \u1077  \u1089 \u1086 \u1093 \u1088 \u1072 \u1085 \u1105 \u1085 \u1085 \u1099 \u1093  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1086 \u1074 "\cf4 \strokec4 )\cb1 \
\cb3             \cf7 \strokec7 compare_params\cf4 \strokec4 (\cf8 \strokec8 tab\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 selected_param\cf4 \strokec4 )\cb1 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 display_tab2_header\cf4 \strokec4 (\cf8 \strokec8 tab\cf4 \strokec4 ):\cb1 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf8 \strokec8 tab\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 header\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u55357 \u56520  \u1055 \u1088 \u1086 \u1075 \u1085 \u1086 \u1079 \u1080 \u1088 \u1086 \u1074 \u1072 \u1085 \u1080 \u1077 "\cf4 \strokec4 )\cb1 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 display_tab2_basic_forecast\cf4 \strokec4 (\cf8 \strokec8 tab\cf4 \strokec4 , \cf8 \strokec8 base_financials\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 ):\cb1 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf8 \strokec8 tab\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 subheader\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1041 \u1072 \u1079 \u1086 \u1074 \u1099 \u1081  \u1087 \u1088 \u1086 \u1075 \u1085 \u1086 \u1079  (\u1083 \u1080 \u1085 \u1077 \u1081 \u1085 \u1072 \u1103  \u1076 \u1080 \u1085 \u1072 \u1084 \u1080 \u1082 \u1072 )"\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 df_projection\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 pd\cf4 \strokec4 .\cf6 \strokec6 DataFrame\cf4 \strokec4 (\{\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1052 \u1077 \u1089 \u1103 \u1094 "\cf4 \strokec4 : \cf6 \strokec6 range\cf4 \strokec4 (\cf12 \strokec12 1\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 .time_horizon \cf9 \strokec9 +\cf4 \strokec4  \cf12 \strokec12 1\cf4 \strokec4 ),\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1044 \u1086 \u1093 \u1086 \u1076 \u1099 "\cf4 \strokec4 : \cf6 \strokec6 np\cf4 \strokec4 .\cf7 \strokec7 linspace\cf4 \strokec4 (\cb1 \
\cb3                 \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "total_income"\cf4 \strokec4 ],\cb1 \
\cb3                 \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "total_income"\cf4 \strokec4 ] \cf9 \strokec9 *\cf4 \strokec4  (\cf12 \strokec12 1\cf4 \strokec4  \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .monthly_income_growth \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .time_horizon),\cb1 \
\cb3                 \cf8 \strokec8 params\cf4 \strokec4 .time_horizon,\cb1 \
\cb3             ),\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1056 \u1072 \u1089 \u1093 \u1086 \u1076 \u1099 "\cf4 \strokec4 : \cf6 \strokec6 np\cf4 \strokec4 .\cf7 \strokec7 linspace\cf4 \strokec4 (\cb1 \
\cb3                 \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "total_expenses"\cf4 \strokec4 ],\cb1 \
\cb3                 \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "total_expenses"\cf4 \strokec4 ] \cf9 \strokec9 *\cf4 \strokec4  (\cf12 \strokec12 1\cf4 \strokec4  \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .monthly_expenses_growth \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .time_horizon),\cb1 \
\cb3                 \cf8 \strokec8 params\cf4 \strokec4 .time_horizon,\cb1 \
\cb3             ),\cb1 \
\cb3         \})\cb1 \
\cb3         \cf8 \strokec8 df_projection\cf4 \strokec4 [\cf10 \strokec10 "\uc0\u1055 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100 "\cf4 \strokec4 ] \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 df_projection\cf4 \strokec4 [\cf10 \strokec10 "\uc0\u1044 \u1086 \u1093 \u1086 \u1076 \u1099 "\cf4 \strokec4 ] \cf7 \strokec7 -\cf4 \strokec4  \cf8 \strokec8 df_projection\cf4 \strokec4 [\cf10 \strokec10 "\uc0\u1056 \u1072 \u1089 \u1093 \u1086 \u1076 \u1099 "\cf4 \strokec4 ]\cb1 \
\
\cb3         \cf8 \strokec8 df_long\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 df_projection\cf4 \strokec4 .\cf7 \strokec7 melt\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 id_vars\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1052 \u1077 \u1089 \u1103 \u1094 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value_vars\cf9 \strokec9 =\cf4 \strokec4 [\cf10 \strokec10 "\uc0\u1044 \u1086 \u1093 \u1086 \u1076 \u1099 "\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1056 \u1072 \u1089 \u1093 \u1086 \u1076 \u1099 "\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1055 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100 "\cf4 \strokec4 ],\cb1 \
\cb3             \cf8 \strokec8 var_name\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1055 \u1086 \u1082 \u1072 \u1079 \u1072 \u1090 \u1077 \u1083 \u1100 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value_name\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1047 \u1085 \u1072 \u1095 \u1077 \u1085 \u1080 \u1077 "\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 chart\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 ChartDisplay\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1055 \u1088 \u1086 \u1075 \u1085 \u1086 \u1079  (\u1073 \u1072 \u1079 \u1086 \u1074 \u1099 \u1081 )"\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 chart\cf4 \strokec4 .\cf7 \strokec7 display_line\cf4 \strokec4 (\cf8 \strokec8 df_long\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1052 \u1077 \u1089 \u1103 \u1094 "\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1047 \u1085 \u1072 \u1095 \u1077 \u1085 \u1080 \u1077 "\cf4 \strokec4 , \cf8 \strokec8 color\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1055 \u1086 \u1082 \u1072 \u1079 \u1072 \u1090 \u1077 \u1083 \u1100 "\cf4 \strokec4 )\cb1 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 display_tab2_ml_forecast\cf4 \strokec4 (\cb1 \
\cb3     \cf8 \strokec8 tab\cf4 \strokec4 ,\cb1 \
\cb3     \cf8 \strokec8 enable_ml_settings\cf4 \strokec4 ,\cb1 \
\cb3     \cf8 \strokec8 selected_forecast_method\cf4 \strokec4 ,\cb1 \
\cb3     \cf8 \strokec8 ml_model\cf4 \strokec4 ,\cb1 \
\cb3     \cf8 \strokec8 df_prepared\cf4 \strokec4 ,\cb1 \
\cb3     \cf8 \strokec8 params\cf4 \strokec4 ,\cb1 \
\cb3     \cf8 \strokec8 base_financials\cf4 \cb1 \strokec4 \
\cb3 ):\cb1 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf8 \strokec8 tab\cf4 \strokec4 :\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 enable_ml_settings\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 subheader\cf4 \strokec4 (\cf10 \strokec10 "ML-\uc0\u1087 \u1088 \u1086 \u1075 \u1085 \u1086 \u1079  (\u1084 \u1072 \u1096 \u1080 \u1085 \u1085 \u1086 \u1077  \u1086 \u1073 \u1091 \u1095 \u1077 \u1085 \u1080 \u1077 )"\cf4 \strokec4 )\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 write\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1044 \u1072 \u1085 \u1085 \u1099 \u1081  \u1084 \u1077 \u1090 \u1086 \u1076  \u1080 \u1089 \u1087 \u1086 \u1083 \u1100 \u1079 \u1091 \u1077 \u1090  \u1080 \u1089 \u1090 \u1086 \u1088 \u1080 \u1095 \u1077 \u1089 \u1082 \u1080 \u1077  \u1076 \u1072 \u1085 \u1085 \u1099 \u1077  \u1076 \u1083 \u1103  \u1087 \u1088 \u1086 \u1075 \u1085 \u1086 \u1079 \u1080 \u1088 \u1086 \u1074 \u1072 \u1085 \u1080 \u1103  \u1076 \u1086 \u1093 \u1086 \u1076 \u1086 \u1074 ."\cf4 \strokec4 )\cb1 \
\cb3             \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 ml_model\cf4 \strokec4  \cf11 \strokec11 is\cf4 \strokec4  \cf11 \strokec11 not\cf4 \strokec4  \cf11 \strokec11 None\cf4 \strokec4  \cf11 \strokec11 and\cf4 \strokec4  \cf8 \strokec8 df_prepared\cf4 \strokec4  \cf11 \strokec11 is\cf4 \strokec4  \cf11 \strokec11 not\cf4 \strokec4  \cf11 \strokec11 None\cf4 \strokec4 :\cb1 \
\cb3                 \cf8 \strokec8 future_months\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 list\cf4 \strokec4 (\cf6 \strokec6 range\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .time_horizon \cf9 \strokec9 +\cf4 \strokec4  \cf12 \strokec12 1\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 .time_horizon \cf9 \strokec9 +\cf4 \strokec4  \cf12 \strokec12 7\cf4 \strokec4 ))\cb1 \
\cb3                 \cf8 \strokec8 predictions\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 predict_with_model\cf4 \strokec4 (\cf8 \strokec8 ml_model\cf4 \strokec4 , \cf8 \strokec8 future_months\cf4 \strokec4 )\cb1 \
\cb3                 \cf8 \strokec8 df_ml\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 pd\cf4 \strokec4 .\cf6 \strokec6 DataFrame\cf4 \strokec4 (\{\cf10 \strokec10 "\uc0\u1052 \u1077 \u1089 \u1103 \u1094 "\cf4 \strokec4 : \cf8 \strokec8 future_months\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1055 \u1088 \u1086 \u1075 \u1085 \u1086 \u1079  \u1044 \u1086 \u1093 \u1086 \u1076 \u1099 "\cf4 \strokec4 : \cf8 \strokec8 predictions\cf4 \strokec4 \})\cb1 \
\cb3                 \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 dataframe\cf4 \strokec4 (\cf8 \strokec8 df_ml\cf4 \strokec4 .\cf8 \strokec8 style\cf4 \strokec4 .\cf7 \strokec7 format\cf4 \strokec4 (\{\cf10 \strokec10 "\uc0\u1055 \u1088 \u1086 \u1075 \u1085 \u1086 \u1079  \u1044 \u1086 \u1093 \u1086 \u1076 \u1099 "\cf4 \strokec4 : \cf10 \strokec10 "\cf11 \strokec11 \{:,.2f\}\cf10 \strokec10  \uc0\u1088 \u1091 \u1073 ."\cf4 \strokec4 \}))\cb1 \
\cb3                 \cf6 \strokec6 ChartDisplay\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1055 \u1088 \u1086 \u1075 \u1085 \u1086 \u1079  \u1076 \u1086 \u1093 \u1086 \u1076 \u1086 \u1074  (ML)"\cf4 \strokec4 ).\cf7 \strokec7 display_line\cf4 \strokec4 (\cb1 \
\cb3                     \cf8 \strokec8 df_ml\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1052 \u1077 \u1089 \u1103 \u1094 "\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1055 \u1088 \u1086 \u1075 \u1085 \u1086 \u1079  \u1044 \u1086 \u1093 \u1086 \u1076 \u1099 "\cf4 \strokec4 , \cf8 \strokec8 color\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1055 \u1088 \u1086 \u1075 \u1085 \u1086 \u1079  \u1044 \u1086 \u1093 \u1086 \u1076 \u1099 "\cf4 \cb1 \strokec4 \
\cb3                 )\cb1 \
\cb3                 \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 info\cf4 \strokec4 (\cb1 \
\cb3                     \cf10 \strokec10 "\uc0\u1055 \u1088 \u1080  ML-\u1087 \u1088 \u1086 \u1075 \u1085 \u1086 \u1079 \u1077  \u1084 \u1099  \u1091 \u1095 \u1080 \u1090 \u1099 \u1074 \u1072 \u1077 \u1084  \u1090 \u1088 \u1077 \u1085 \u1076 \u1099  \u1080 \u1079  \u1080 \u1089 \u1090 \u1086 \u1088 \u1080 \u1095 \u1077 \u1089 \u1082 \u1080 \u1093  \u1076 \u1072 \u1085 \u1085 \u1099 \u1093 . "\cf4 \cb1 \strokec4 \
\cb3                     \cf10 \strokec10 "\uc0\u1051 \u1080 \u1085 \u1077 \u1081 \u1085 \u1072 \u1103 /\u1087 \u1086 \u1083 \u1080 \u1085 \u1086 \u1084 \u1080 \u1072 \u1083 \u1100 \u1085 \u1072 \u1103  \u1088 \u1077 \u1075 \u1088 \u1077 \u1089 \u1089 \u1080 \u1103  \'97 \u1076 \u1083 \u1103  \u1087 \u1086 \u1080 \u1089 \u1082 \u1072  \u1079 \u1072 \u1074 \u1080 \u1089 \u1080 \u1084 \u1086 \u1089 \u1090 \u1080 , "\cf4 \cb1 \strokec4 \
\cb3                     \cf10 \strokec10 "\uc0\u1089 \u1083 \u1091 \u1095 \u1072 \u1081 \u1085 \u1099 \u1081  \u1083 \u1077 \u1089  \'97 \u1073 \u1086 \u1083 \u1077 \u1077  \u1089 \u1083 \u1086 \u1078 \u1085 \u1072 \u1103  \u1084 \u1086 \u1076 \u1077 \u1083 \u1100 , \u1085 \u1086  \u1084 \u1086 \u1078 \u1077 \u1090  \u1076 \u1072 \u1090 \u1100  \u1090 \u1086 \u1095 \u1085 \u1077 \u1077  \u1088 \u1077 \u1079 \u1091 \u1083 \u1100 \u1090 \u1072 \u1090 ."\cf4 \cb1 \strokec4 \
\cb3                 )\cb1 \
\cb3             \cf5 \strokec5 else\cf4 \strokec4 :\cb1 \
\cb3                 \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 info\cf4 \strokec4 (\cf10 \strokec10 "ML-\uc0\u1084 \u1086 \u1076 \u1077 \u1083 \u1100  \u1085 \u1077  \u1086 \u1073 \u1091 \u1095 \u1077 \u1085 \u1072  \u1080 \u1083 \u1080  \u1085 \u1077 \u1090  \u1076 \u1072 \u1085 \u1085 \u1099 \u1093  \u1076 \u1083 \u1103  \u1086 \u1073 \u1091 \u1095 \u1077 \u1085 \u1080 \u1103 ."\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 else\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 warning\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1056 \u1072 \u1089 \u1096 \u1080 \u1088 \u1077 \u1085 \u1085 \u1099 \u1081  ML-\u1087 \u1088 \u1086 \u1075 \u1085 \u1086 \u1079  \u1086 \u1090 \u1082 \u1083 \u1102 \u1095 \u1105 \u1085 ."\cf4 \strokec4 )\cb1 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 display_tab2_monte_carlo\cf4 \strokec4 (\cf8 \strokec8 tab\cf4 \strokec4 , \cf8 \strokec8 base_financials\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 ):\cb1 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf8 \strokec8 tab\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 subheader\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1057 \u1080 \u1084 \u1091 \u1083 \u1103 \u1094 \u1080 \u1103  \u1052 \u1086 \u1085 \u1090 \u1077 -\u1050 \u1072 \u1088 \u1083 \u1086 "\cf4 \strokec4 )\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 write\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1052 \u1077 \u1090 \u1086 \u1076  \u1052 \u1086 \u1085 \u1090 \u1077 -\u1050 \u1072 \u1088 \u1083 \u1086  \u1087 \u1086 \u1079 \u1074 \u1086 \u1083 \u1103 \u1077 \u1090  \u1091 \u1095 \u1077 \u1089 \u1090 \u1100  \u1085 \u1077 \u1086 \u1087 \u1088 \u1077 \u1076 \u1077 \u1083 \u1105 \u1085 \u1085 \u1086 \u1089 \u1090 \u1100  \u1074  \u1076 \u1086 \u1093 \u1086 \u1076 \u1072 \u1093  \u1080  \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1072 \u1093 . "\cf4 \cb1 \strokec4 \
\cb3             \cf10 \strokec10 "\uc0\u1052 \u1099  \u1089 \u1083 \u1091 \u1095 \u1072 \u1081 \u1085 \u1086  \u1074 \u1072 \u1088 \u1100 \u1080 \u1088 \u1091 \u1077 \u1084  \u1079 \u1085 \u1072 \u1095 \u1077 \u1085 \u1080 \u1103  \u1074 \u1086 \u1082 \u1088 \u1091 \u1075  \u1089 \u1088 \u1077 \u1076 \u1085 \u1077 \u1075 \u1086  \u1080  \u1087 \u1086 \u1083 \u1091 \u1095 \u1072 \u1077 \u1084  \u1088 \u1072 \u1089 \u1087 \u1088 \u1077 \u1076 \u1077 \u1083 \u1077 \u1085 \u1080 \u1077  \u1088 \u1077 \u1079 \u1091 \u1083 \u1100 \u1090 \u1072 \u1090 \u1086 \u1074 ."\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 df_mc\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 monte_carlo_simulation\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "total_income"\cf4 \strokec4 ],\cb1 \
\cb3             \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "total_expenses"\cf4 \strokec4 ],\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .time_horizon,\cb1 \
\cb3             \cf7 \strokec7 min\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .monte_carlo_simulations, \cf12 \strokec12 100\cf4 \strokec4 ),\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .monte_carlo_deviation,\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .monte_carlo_seed,\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .monthly_income_growth,\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .monthly_expenses_growth,\cb1 \
\cb3         )\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 dataframe\cf4 \strokec4 (\cf8 \strokec8 df_mc\cf4 \strokec4 .\cf8 \strokec8 style\cf4 \strokec4 .\cf7 \strokec7 format\cf4 \strokec4 (\cf10 \strokec10 "\cf11 \strokec11 \{:,.2f\}\cf10 \strokec10 "\cf4 \strokec4 ))\cb1 \
\cb3         \cf8 \strokec8 df_long\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 df_mc\cf4 \strokec4 .\cf7 \strokec7 melt\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 id_vars\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1052 \u1077 \u1089 \u1103 \u1094 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value_vars\cf9 \strokec9 =\cf4 \strokec4 [\cf10 \strokec10 "\uc0\u1057 \u1088 \u1077 \u1076 \u1085 \u1080 \u1081  \u1044 \u1086 \u1093 \u1086 \u1076 "\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1057 \u1088 \u1077 \u1076 \u1085 \u1080 \u1081  \u1056 \u1072 \u1089 \u1093 \u1086 \u1076 "\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1057 \u1088 \u1077 \u1076 \u1085 \u1103 \u1103  \u1055 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100 "\cf4 \strokec4 ],\cb1 \
\cb3             \cf8 \strokec8 var_name\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1055 \u1086 \u1082 \u1072 \u1079 \u1072 \u1090 \u1077 \u1083 \u1100 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 value_name\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1047 \u1085 \u1072 \u1095 \u1077 \u1085 \u1080 \u1077 "\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf6 \strokec6 ChartDisplay\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1056 \u1077 \u1079 \u1091 \u1083 \u1100 \u1090 \u1072 \u1090 \u1099  \u1052 \u1086 \u1085 \u1090 \u1077 -\u1050 \u1072 \u1088 \u1083 \u1086 "\cf4 \strokec4 ).\cf7 \strokec7 display_line\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 df_long\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1052 \u1077 \u1089 \u1103 \u1094 "\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1047 \u1085 \u1072 \u1095 \u1077 \u1085 \u1080 \u1077 "\cf4 \strokec4 , \cf8 \strokec8 color\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1055 \u1086 \u1082 \u1072 \u1079 \u1072 \u1090 \u1077 \u1083 \u1100 "\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 info\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1063 \u1077 \u1084  \u1073 \u1086 \u1083 \u1100 \u1096 \u1077  \u1089 \u1080 \u1084 \u1091 \u1083 \u1103 \u1094 \u1080 \u1081 , \u1090 \u1077 \u1084  \u1090 \u1086 \u1095 \u1085 \u1077 \u1077  \u1086 \u1094 \u1077 \u1085 \u1082 \u1072 . \u1054 \u1090 \u1082 \u1083 \u1086 \u1085 \u1077 \u1085 \u1080 \u1077  (deviation) \u1079 \u1072 \u1076 \u1072 \u1105 \u1090  \u1089 \u1083 \u1091 \u1095 \u1072 \u1081 \u1085 \u1099 \u1081  \u1088 \u1072 \u1079 \u1073 \u1088 \u1086 \u1089  "\cf4 \cb1 \strokec4 \
\cb3             \cf10 \strokec10 "\uc0\u1074 \u1086 \u1082 \u1088 \u1091 \u1075  \u1089 \u1088 \u1077 \u1076 \u1085 \u1077 \u1081  \u1076 \u1080 \u1085 \u1072 \u1084 \u1080 \u1082 \u1080  \u1076 \u1086 \u1093 \u1086 \u1076 \u1086 \u1074 /\u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1086 \u1074 ."\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 display_tab3_header\cf4 \strokec4 (\cf8 \strokec8 tab\cf4 \strokec4 ):\cb1 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf8 \strokec8 tab\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 header\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u55357 \u56589  \u1058 \u1086 \u1095 \u1082 \u1072  \u1073 \u1077 \u1079 \u1091 \u1073 \u1099 \u1090 \u1086 \u1095 \u1085 \u1086 \u1089 \u1090 \u1080  (BEP)"\cf4 \strokec4 )\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 info\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1058 \u1086 \u1095 \u1082 \u1072  \u1073 \u1077 \u1079 \u1091 \u1073 \u1099 \u1090 \u1086 \u1095 \u1085 \u1086 \u1089 \u1090 \u1080  \'97 \u1084 \u1086 \u1084 \u1077 \u1085 \u1090 , \u1082 \u1086 \u1075 \u1076 \u1072  \u1076 \u1086 \u1093 \u1086 \u1076 \u1099  \u1087 \u1086 \u1082 \u1088 \u1099 \u1074 \u1072 \u1102 \u1090  \u1074 \u1089 \u1077  \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1099 . "\cf4 \cb1 \strokec4 \
\cb3             \cf10 \strokec10 "\uc0\u1047 \u1076 \u1077 \u1089 \u1100  \u1074 \u1099  \u1091 \u1079 \u1085 \u1072 \u1077 \u1090 \u1077 , \u1082 \u1072 \u1082 \u1086 \u1081  \u1076 \u1086 \u1093 \u1086 \u1076  \u1085 \u1091 \u1078 \u1077 \u1085 , \u1095 \u1090 \u1086 \u1073 \u1099  \u1089 \u1082 \u1083 \u1072 \u1076  \u1085 \u1077  \u1073 \u1099 \u1083  \u1091 \u1073 \u1099 \u1090 \u1086 \u1095 \u1077 \u1085 ."\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 display_tab3_bep_info\cf4 \strokec4 (\cf8 \strokec8 tab\cf4 \strokec4 , \cf8 \strokec8 base_financials\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 ):\cb1 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf8 \strokec8 tab\cf4 \strokec4 :\cb1 \
\cb3         \cf8 \strokec8 bep_income\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_total_bep\cf4 \strokec4 (\cf8 \strokec8 base_financials\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 current_income\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "total_income"\cf4 \strokec4 ]\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 bep_income\cf4 \strokec4  \cf9 \strokec9 ==\cf4 \strokec4  \cf6 \strokec6 float\cf4 \strokec4 (\cf10 \strokec10 "inf"\cf4 \strokec4 ):\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 write\cf4 \strokec4 (\cf10 \strokec10 "**\uc0\u1041 \u1077 \u1089 \u1082 \u1086 \u1085 \u1077 \u1095 \u1085 \u1086 \u1089 \u1090 \u1100 ** \'97 \u1076 \u1086 \u1093 \u1086 \u1076  \u1085 \u1077  \u1087 \u1086 \u1082 \u1088 \u1099 \u1074 \u1072 \u1077 \u1090  \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1099  (\u1087 \u1088 \u1080  \u1085 \u1099 \u1085 \u1077 \u1096 \u1085 \u1080 \u1093  \u1091 \u1089 \u1083 \u1086 \u1074 \u1080 \u1103 \u1093 )."\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 else\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 write\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "**\uc0\u1053 \u1077 \u1086 \u1073 \u1093 \u1086 \u1076 \u1080 \u1084 \u1099 \u1081  \u1076 \u1086 \u1093 \u1086 \u1076  \u1076 \u1083 \u1103  BEP:** \cf11 \strokec11 \{\cf8 \strokec8 bep_income\cf11 \strokec11 :,.2f\}\cf10 \strokec10  \uc0\u1088 \u1091 \u1073 ."\cf4 \strokec4 )\cb1 \
\cb3             \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 current_income\cf4 \strokec4  \cf9 \strokec9 >=\cf4 \strokec4  \cf8 \strokec8 bep_income\cf4 \strokec4 :\cb1 \
\cb3                 \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 success\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1044 \u1086 \u1093 \u1086 \u1076  \u1087 \u1086 \u1082 \u1088 \u1099 \u1074 \u1072 \u1077 \u1090  \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1099  (BEP \u1076 \u1086 \u1089 \u1090 \u1080 \u1075 \u1085 \u1091 \u1090 )."\cf4 \strokec4 )\cb1 \
\cb3             \cf5 \strokec5 else\cf4 \strokec4 :\cb1 \
\cb3                 \cf8 \strokec8 deficit\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 bep_income\cf4 \strokec4  \cf9 \strokec9 -\cf4 \strokec4  \cf8 \strokec8 current_income\cf4 \cb1 \strokec4 \
\cb3                 \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 error\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1053 \u1077  \u1093 \u1074 \u1072 \u1090 \u1072 \u1077 \u1090  \cf11 \strokec11 \{\cf8 \strokec8 deficit\cf11 \strokec11 :,.2f\}\cf10 \strokec10  \uc0\u1088 \u1091 \u1073 . \u1076 \u1086  BEP."\cf4 \strokec4 )\cb1 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 display_tab3_monthly_bep\cf4 \strokec4 (\cf8 \strokec8 tab\cf4 \strokec4 , \cf8 \strokec8 base_financials\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 ):\cb1 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf8 \strokec8 tab\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 write\cf4 \strokec4 (\cf10 \strokec10 "---"\cf4 \strokec4 )\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 subheader\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1055 \u1086 \u1084 \u1077 \u1089 \u1103 \u1095 \u1085 \u1099 \u1081  \u1072 \u1085 \u1072 \u1083 \u1080 \u1079  BEP"\cf4 \strokec4 )\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 write\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1047 \u1076 \u1077 \u1089 \u1100  \u1087 \u1086 \u1082 \u1072 \u1079 \u1099 \u1074 \u1072 \u1077 \u1084 , \u1082 \u1072 \u1082  \u1089 \u1086  \u1074 \u1088 \u1077 \u1084 \u1077 \u1085 \u1077 \u1084  (\u1087 \u1086  \u1084 \u1077 \u1089 \u1103 \u1094 \u1072 \u1084 ) \u1084 \u1077 \u1085 \u1103 \u1077 \u1090 \u1089 \u1103  \u1091 \u1088 \u1086 \u1074 \u1077 \u1085 \u1100  \u1076 \u1086 \u1093 \u1086 \u1076 \u1072 , "\cf4 \cb1 \strokec4 \
\cb3             \cf10 \strokec10 "\uc0\u1085 \u1077 \u1086 \u1073 \u1093 \u1086 \u1076 \u1080 \u1084 \u1099 \u1081  \u1076 \u1083 \u1103  \u1087 \u1086 \u1082 \u1088 \u1099 \u1090 \u1080 \u1103  \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1086 \u1074  (\u1091 \u1095 \u1080 \u1090 \u1099 \u1074 \u1072 \u1103  \u1088 \u1086 \u1089 \u1090  \u1072 \u1088 \u1077 \u1085 \u1076 \u1099 , \u1079 \u1072 \u1088 \u1087 \u1083 \u1072 \u1090  \u1080  \u1090 .\u1076 .)."\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 monthly_bep_df\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_monthly_bep\cf4 \strokec4 (\cf8 \strokec8 base_financials\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 dataframe\cf4 \strokec4 (\cf8 \strokec8 monthly_bep_df\cf4 \strokec4 .\cf8 \strokec8 style\cf4 \strokec4 .\cf7 \strokec7 format\cf4 \strokec4 (\{\cf10 \strokec10 "\uc0\u1053 \u1077 \u1086 \u1073 \u1093 \u1086 \u1076 \u1080 \u1084 \u1099 \u1081  \u1076 \u1086 \u1093 \u1086 \u1076  \u1076 \u1083 \u1103  BEP"\cf4 \strokec4 : \cf10 \strokec10 "\cf11 \strokec11 \{:,.2f\}\cf10 \strokec10 "\cf4 \strokec4 \}))\cb1 \
\cb3         \cf6 \strokec6 ChartDisplay\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1055 \u1086 \u1084 \u1077 \u1089 \u1103 \u1095 \u1085 \u1072 \u1103  BEP"\cf4 \strokec4 ).\cf7 \strokec7 display_line\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 monthly_bep_df\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1052 \u1077 \u1089 \u1103 \u1094 "\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1053 \u1077 \u1086 \u1073 \u1093 \u1086 \u1076 \u1080 \u1084 \u1099 \u1081  \u1076 \u1086 \u1093 \u1086 \u1076  \u1076 \u1083 \u1103  BEP"\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 color\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1053 \u1077 \u1086 \u1073 \u1093 \u1086 \u1076 \u1080 \u1084 \u1099 \u1081  \u1076 \u1086 \u1093 \u1086 \u1076  \u1076 \u1083 \u1103  BEP"\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 display_tab3_sensitivity\cf4 \strokec4 (\cf8 \strokec8 tab\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 disable_extended\cf4 \strokec4 ):\cb1 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf8 \strokec8 tab\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 write\cf4 \strokec4 (\cf10 \strokec10 "---"\cf4 \strokec4 )\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 subheader\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1043 \u1088 \u1072 \u1092 \u1080 \u1082 \u1080  \u1095 \u1091 \u1074 \u1089 \u1090 \u1074 \u1080 \u1090 \u1077 \u1083 \u1100 \u1085 \u1086 \u1089 \u1090 \u1080 "\cf4 \strokec4 )\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 write\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1040 \u1085 \u1072 \u1083 \u1080 \u1079  \u1095 \u1091 \u1074 \u1089 \u1090 \u1074 \u1080 \u1090 \u1077 \u1083 \u1100 \u1085 \u1086 \u1089 \u1090 \u1080  \u1087 \u1086 \u1082 \u1072 \u1079 \u1099 \u1074 \u1072 \u1077 \u1090 , \u1082 \u1072 \u1082  \u1080 \u1079 \u1084 \u1077 \u1085 \u1077 \u1085 \u1080 \u1077  \u1082 \u1083 \u1102 \u1095 \u1077 \u1074 \u1099 \u1093  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1086 \u1074  (\u1085 \u1072 \u1087 \u1088 \u1080 \u1084 \u1077 \u1088 , \u1090 \u1072 \u1088 \u1080 \u1092  \u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1103 ) "\cf4 \cb1 \strokec4 \
\cb3             \cf10 \strokec10 "\uc0\u1074 \u1083 \u1080 \u1103 \u1077 \u1090  \u1085 \u1072  \u1087 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100  \u1080  \u1090 \u1086 \u1095 \u1082 \u1091  \u1073 \u1077 \u1079 \u1091 \u1073 \u1099 \u1090 \u1086 \u1095 \u1085 \u1086 \u1089 \u1090 \u1080 ."\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 info\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1053 \u1072 \u1087 \u1088 \u1080 \u1084 \u1077 \u1088 , \u1077 \u1089 \u1083 \u1080  \u1090 \u1072 \u1088 \u1080 \u1092  \u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1103  \u1088 \u1072 \u1089 \u1090 \u1105 \u1090 , \u1076 \u1086 \u1093 \u1086 \u1076  \u1084 \u1086 \u1078 \u1077 \u1090  \u1091 \u1074 \u1077 \u1083 \u1080 \u1095 \u1080 \u1090 \u1100 \u1089 \u1103 , \u1085 \u1086  \u1080  \u1086 \u1090 \u1090 \u1086 \u1082  \u1082 \u1083 \u1080 \u1077 \u1085 \u1090 \u1086 \u1074  (churn) "\cf4 \cb1 \strokec4 \
\cb3             \cf10 \strokec10 "\uc0\u1084 \u1086 \u1078 \u1077 \u1090  \u1089 \u1082 \u1086 \u1088 \u1088 \u1077 \u1082 \u1090 \u1080 \u1088 \u1086 \u1074 \u1072 \u1090 \u1100  \u1088 \u1077 \u1072 \u1083 \u1100 \u1085 \u1099 \u1077  \u1087 \u1086 \u1082 \u1072 \u1079 \u1072 \u1090 \u1077 \u1083 \u1080 ."\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\
\cb3         \cf11 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 build_bep_df\cf4 \strokec4 (\cf8 \strokec8 p\cf4 \strokec4 , \cf8 \strokec8 param_key\cf4 \strokec4 , \cf8 \strokec8 base_val\cf4 \strokec4 ):\cb1 \
\cb3             \cf5 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 numpy\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf6 \strokec6 np\cf4 \cb1 \strokec4 \
\cb3             \cf5 \strokec5 from\cf4 \strokec4  \cf6 \strokec6 calculations\cf4 \strokec4  \cf5 \strokec5 import\cf4 \strokec4  \cf7 \strokec7 calculate_financials\cf4 \strokec4 , \cf7 \strokec7 calculate_total_bep\cf4 \cb1 \strokec4 \
\cb3             \cf8 \strokec8 vals\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 np\cf4 \strokec4 .\cf7 \strokec7 linspace\cf4 \strokec4 (\cb1 \
\cb3                 \cf8 \strokec8 base_val\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf12 \strokec12 0.5\cf4 \strokec4  \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 base_val\cf4 \strokec4  \cf9 \strokec9 >\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4  \cf5 \strokec5 else\cf4 \strokec4  \cf12 \strokec12 0.1\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 base_val\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf12 \strokec12 1.5\cf4 \strokec4  \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 base_val\cf4 \strokec4  \cf9 \strokec9 >\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4  \cf5 \strokec5 else\cf4 \strokec4  \cf12 \strokec12 1.5\cf4 \strokec4 ,\cb1 \
\cb3                 \cf12 \strokec12 50\cf4 \cb1 \strokec4 \
\cb3             )\cb1 \
\cb3             \cf8 \strokec8 profits\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  []\cb1 \
\cb3             \cf8 \strokec8 beps\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  []\cb1 \
\cb3             \cf8 \strokec8 orig_val\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 getattr\cf4 \strokec4 (\cf8 \strokec8 p\cf4 \strokec4 , \cf8 \strokec8 param_key\cf4 \strokec4 )\cb1 \
\cb3             \cf5 \strokec5 for\cf4 \strokec4  \cf8 \strokec8 v\cf4 \strokec4  \cf7 \strokec7 in\cf4 \strokec4  \cf8 \strokec8 vals\cf4 \strokec4 :\cb1 \
\cb3                 \cf7 \strokec7 setattr\cf4 \strokec4 (\cf8 \strokec8 p\cf4 \strokec4 , \cf8 \strokec8 param_key\cf4 \strokec4 , \cf8 \strokec8 v\cf4 \strokec4 )\cb1 \
\cb3                 \cf8 \strokec8 fin\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_financials\cf4 \strokec4 (\cf8 \strokec8 p\cf4 \strokec4 , \cf8 \strokec8 disable_extended\cf4 \strokec4 )\cb1 \
\cb3                 \cf8 \strokec8 beps\cf4 \strokec4 .\cf7 \strokec7 append\cf4 \strokec4 (\cf7 \strokec7 calculate_total_bep\cf4 \strokec4 (\cf8 \strokec8 fin\cf4 \strokec4 , \cf8 \strokec8 p\cf4 \strokec4 ))\cb1 \
\cb3                 \cf8 \strokec8 profits\cf4 \strokec4 .\cf7 \strokec7 append\cf4 \strokec4 (\cf8 \strokec8 fin\cf4 \strokec4 [\cf10 \strokec10 "profit"\cf4 \strokec4 ])\cb1 \
\cb3             \cf7 \strokec7 setattr\cf4 \strokec4 (\cf8 \strokec8 p\cf4 \strokec4 , \cf8 \strokec8 param_key\cf4 \strokec4 , \cf8 \strokec8 orig_val\cf4 \strokec4 )\cb1 \
\cb3             \cf5 \strokec5 return\cf4 \strokec4  \cf6 \strokec6 pd\cf4 \strokec4 .\cf6 \strokec6 DataFrame\cf4 \strokec4 (\{\cf8 \strokec8 param_key\cf4 \strokec4 : \cf8 \strokec8 vals\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1055 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100 "\cf4 \strokec4 : \cf8 \strokec8 profits\cf4 \strokec4 , \cf10 \strokec10 "BEP"\cf4 \strokec4 : \cf8 \strokec8 beps\cf4 \strokec4 \})\cb1 \
\
\cb3         \cf2 \strokec2 # \uc0\u1055 \u1045 \u1056 \u1045 \u1042 \u1054 \u1044 \u1048 \u1052  \u1047 \u1044 \u1045 \u1057 \u1068 \cf4 \cb1 \strokec4 \
\cb3         \cf2 \strokec2 # \uc0\u1050 \u1051 \u1070 \u1063  \u1048 \u1052 \u1045 \u1053 \u1053 \u1054  these keys, so user sees them\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 analysis_params\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \{\cb1 \
\cb3             \cf2 \strokec2 # \uc0\u1042 \u1086 \u1087 \u1088 \u1086 \u1089 , \u1084 \u1086 \u1078 \u1077 \u1090  \u1083 \u1080  st.multiselect \u1086 \u1090 \u1086 \u1073 \u1088 \u1072 \u1079 \u1080 \u1090 \u1100  \u1088 \u1091 \u1089 \u1089 \u1082 \u1080 \u1077  \u1085 \u1072 \u1079 \u1074 \u1072 \u1085 \u1080 \u1103 ?\cf4 \cb1 \strokec4 \
\cb3             \cf2 \strokec2 # \uc0\u1056 \u1077 \u1096 \u1077 \u1085 \u1080 \u1077 : \u1084 \u1099  \u1089 \u1086 \u1079 \u1076 \u1072 \u1076 \u1080 \u1084  \u1089 \u1083 \u1086 \u1074 \u1072 \u1088 \u1100  param_display_map (\u1082 \u1083 \u1102 \u1095  -> \u1088 \u1091 \u1089 \u1089 \u1082 \u1086 \u1077  \u1085 \u1072 \u1079 \u1074 \u1072 \u1085 \u1080 \u1077 ),\cf4 \cb1 \strokec4 \
\cb3             \cf2 \strokec2 # \uc0\u1072  \u1074  st.multiselect() \u1087 \u1077 \u1088 \u1077 \u1076 \u1072 \u1076 \u1080 \u1084  \u1080 \u1084 \u1077 \u1085 \u1085 \u1086  \u1088 \u1091 \u1089 \u1089 \u1082 \u1080 \u1077  \u1085 \u1072 \u1079 \u1074 \u1072 \u1085 \u1080 \u1103  \u1082 \u1072 \u1082  options,\cf4 \cb1 \strokec4 \
\cb3             \cf2 \strokec2 # \uc0\u1080  \u1089 \u1076 \u1077 \u1083 \u1072 \u1077 \u1084  reverse map, \u1095 \u1090 \u1086 \u1073 \u1099  \u1087 \u1086 \u1085 \u1103 \u1090 \u1100 , \u1082 \u1072 \u1082 \u1086 \u1081  \u1082 \u1083 \u1102 \u1095  \u1074 \u1099 \u1073 \u1088 \u1072 \u1090 \u1100 .\cf4 \cb1 \strokec4 \
\cb3         \}\cb1 \
\
\cb3         \cf2 \strokec2 # \uc0\u1053 \u1086 \u1074 \u1099 \u1081  \u1089 \u1083 \u1086 \u1074 \u1072 \u1088 \u1100  \u1086 \u1090 \u1086 \u1073 \u1088 \u1072 \u1078 \u1077 \u1085 \u1080 \u1103  (\u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088  -> RU)\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 param_display_map\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \{\cb1 \
\cb3             \cf10 \strokec10 "storage_fee"\cf4 \strokec4 : \cf10 \strokec10 "\uc0\u1058 \u1072 \u1088 \u1080 \u1092  \u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1103  (\u1088 \u1091 \u1073 ./\u1084 \'b2)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "vip_extra_fee"\cf4 \strokec4 : \cf10 \strokec10 "\uc0\u1053 \u1072 \u1094 \u1077 \u1085 \u1082 \u1072  VIP (\u1088 \u1091 \u1073 ./\u1084 \'b2)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "short_term_daily_rate"\cf4 \strokec4 : \cf10 \strokec10 "\uc0\u1058 \u1072 \u1088 \u1080 \u1092  \u1082 \u1088 \u1072 \u1090 \u1082 \u1086 \u1089 \u1088 \u1086 \u1095 \u1085 \u1086 \u1075 \u1086  (\u1088 \u1091 \u1073 ./\u1076 \u1077 \u1085 \u1100 /\u1084 \'b2)"\cf4 \strokec4 ,\cb1 \
\cb3             \cf10 \strokec10 "loan_interest_rate"\cf4 \strokec4 : \cf10 \strokec10 "\uc0\u1057 \u1090 \u1072 \u1074 \u1082 \u1072  \u1079 \u1072 \u1081 \u1084 \u1086 \u1074  (% \u1074  \u1076 \u1077 \u1085 \u1100 )"\cf4 \strokec4 ,\cb1 \
\cb3         \}\cb1 \
\
\cb3         \cf2 \strokec2 # \uc0\u1054 \u1073 \u1088 \u1072 \u1090 \u1085 \u1099 \u1081  \u1089 \u1083 \u1086 \u1074 \u1072 \u1088 \u1100  (\u1095 \u1090 \u1086 \u1073 \u1099  \u1089 \u1086 \u1087 \u1086 \u1089 \u1090 \u1072 \u1074 \u1083 \u1103 \u1090 \u1100  \u1074 \u1099 \u1073 \u1088 \u1072 \u1085 \u1085 \u1099 \u1077  \u1088 \u1091 \u1089 \u1089 \u1082 \u1080 \u1077  \u1085 \u1072 \u1079 \u1074 \u1072 \u1085 \u1080 \u1103  \u1089  \u1082 \u1083 \u1102 \u1095 \u1072 \u1084 \u1080 )\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 reverse_map\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \{\cf8 \strokec8 v\cf4 \strokec4 : \cf8 \strokec8 k\cf4 \strokec4  \cf5 \strokec5 for\cf4 \strokec4  \cf8 \strokec8 k\cf4 \strokec4 , \cf8 \strokec8 v\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 param_display_map\cf4 \strokec4 .\cf7 \strokec7 items\cf4 \strokec4 ()\}\cb1 \
\
\cb3         \cf2 \strokec2 # \uc0\u1057 \u1087 \u1080 \u1089 \u1086 \u1082  \u1086 \u1087 \u1094 \u1080 \u1081  \u1085 \u1072  \u1088 \u1091 \u1089 \u1089 \u1082 \u1086 \u1084 \cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 ru_options\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 list\cf4 \strokec4 (\cf8 \strokec8 param_display_map\cf4 \strokec4 .\cf7 \strokec7 values\cf4 \strokec4 ())\cb1 \
\
\cb3         \cf2 \strokec2 # \uc0\u1042 \u1099 \u1073 \u1080 \u1088 \u1072 \u1077 \u1084  \u1089 \u1088 \u1077 \u1076 \u1080  \u1088 \u1091 \u1089 \u1089 \u1082 \u1080 \u1093  \u1085 \u1072 \u1079 \u1074 \u1072 \u1085 \u1080 \u1081 \cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 selected_ru_params\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 multiselect\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1042 \u1099 \u1073 \u1077 \u1088 \u1080 \u1090 \u1077  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1099  \u1076 \u1083 \u1103  \u1072 \u1085 \u1072 \u1083 \u1080 \u1079 \u1072  \u1095 \u1091 \u1074 \u1089 \u1090 \u1074 \u1080 \u1090 \u1077 \u1083 \u1100 \u1085 \u1086 \u1089 \u1090 \u1080 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 ru_options\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 help\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1059 \u1082 \u1072 \u1078 \u1080 \u1090 \u1077 , \u1082 \u1072 \u1082 \u1080 \u1077  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1099  \u1074 \u1072 \u1088 \u1100 \u1080 \u1088 \u1086 \u1074 \u1072 \u1090 \u1100 , \u1095 \u1090 \u1086 \u1073 \u1099  \u1087 \u1086 \u1089 \u1084 \u1086 \u1090 \u1088 \u1077 \u1090 \u1100  \u1074 \u1083 \u1080 \u1103 \u1085 \u1080 \u1077  \u1085 \u1072  \u1092 \u1080 \u1085 \u1088 \u1077 \u1079 \u1091 \u1083 \u1100 \u1090 \u1072 \u1090 ."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf2 \strokec2 # \uc0\u1055 \u1088 \u1077 \u1086 \u1073 \u1088 \u1072 \u1079 \u1091 \u1077 \u1084  \u1086 \u1073 \u1088 \u1072 \u1090 \u1085 \u1086  \u1074  \u1082 \u1083 \u1102 \u1095 \u1080 \cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 selected_keys\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  [\cf8 \strokec8 reverse_map\cf4 \strokec4 [\cf8 \strokec8 ru\cf4 \strokec4 ] \cf5 \strokec5 for\cf4 \strokec4  \cf8 \strokec8 ru\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 selected_ru_params\cf4 \strokec4 ]\cb1 \
\
\cb3         \cf5 \strokec5 for\cf4 \strokec4  \cf8 \strokec8 key\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 selected_keys\cf4 \strokec4 :\cb1 \
\cb3             \cf8 \strokec8 df_sens\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 build_bep_df\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 key\cf4 \strokec4 , \cf7 \strokec7 getattr\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 key\cf4 \strokec4 ))\cb1 \
\cb3             \cf2 \strokec2 # \uc0\u1042 \u1099 \u1074 \u1086 \u1076 \u1080 \u1084  RU-\u1085 \u1072 \u1079 \u1074 \u1072 \u1085 \u1080 \u1077  \u1074 \u1084 \u1077 \u1089 \u1090 \u1086  key\cf4 \cb1 \strokec4 \
\cb3             \cf8 \strokec8 ru_label\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 param_display_map\cf4 \strokec4 [\cf8 \strokec8 key\cf4 \strokec4 ]\cb1 \
\cb3             \cf6 \strokec6 ChartDisplay\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\cf11 \strokec11 \{\cf8 \strokec8 ru_label\cf11 \strokec11 \}\cf10 \strokec10 : \uc0\u1095 \u1091 \u1074 \u1089 \u1090 \u1074 \u1080 \u1090 \u1077 \u1083 \u1100 \u1085 \u1086 \u1089 \u1090 \u1100 "\cf4 \strokec4 ).\cf7 \strokec7 display_line\cf4 \strokec4 (\cb1 \
\cb3                 \cf8 \strokec8 df_sens\cf4 \strokec4 , \cf8 \strokec8 key\cf4 \strokec4 , [\cf10 \strokec10 "\uc0\u1055 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100 "\cf4 \strokec4 , \cf10 \strokec10 "BEP"\cf4 \strokec4 ]\cb1 \
\cb3             )\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 info\cf4 \strokec4 (\cb1 \
\cb3                 \cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1053 \u1072  \u1075 \u1088 \u1072 \u1092 \u1080 \u1082 \u1077  \u1074 \u1080 \u1076 \u1085 \u1086 , \u1082 \u1072 \u1082  \u1080 \u1079 \u1084 \u1077 \u1085 \u1077 \u1085 \u1080 \u1103  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1072  '\cf11 \strokec11 \{\cf8 \strokec8 ru_label\cf11 \strokec11 \}\cf10 \strokec10 ' "\cf4 \cb1 \strokec4 \
\cb3                 \cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1074 \u1083 \u1080 \u1103 \u1102 \u1090  \u1085 \u1072  \u1087 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100  \u1080  \u1090 \u1086 \u1095 \u1082 \u1091  \u1073 \u1077 \u1079 \u1091 \u1073 \u1099 \u1090 \u1086 \u1095 \u1085 \u1086 \u1089 \u1090 \u1080 . "\cf4 \cb1 \strokec4 \
\cb3                 \cf10 \strokec10 "\uc0\u1045 \u1089 \u1083 \u1080  BEP \u1088 \u1072 \u1089 \u1090 \u1105 \u1090  \u1089 \u1080 \u1083 \u1100 \u1085 \u1077 \u1077 , \u1095 \u1077 \u1084  \u1087 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100 , \u1079 \u1085 \u1072 \u1095 \u1080 \u1090  \u1088 \u1086 \u1089 \u1090  \u1101 \u1090 \u1086 \u1075 \u1086  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1072  "\cf4 \cb1 \strokec4 \
\cb3                 \cf10 \strokec10 "\uc0\u1084 \u1086 \u1078 \u1077 \u1090  \u1091 \u1093 \u1091 \u1076 \u1096 \u1080 \u1090 \u1100  \u1101 \u1082 \u1086 \u1085 \u1086 \u1084 \u1080 \u1082 \u1091  \u1089 \u1082 \u1083 \u1072 \u1076 \u1072 ."\cf4 \cb1 \strokec4 \
\cb3             )\cb1 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 display_tab4_header\cf4 \strokec4 (\cf8 \strokec8 tab\cf4 \strokec4 ):\cb1 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf8 \strokec8 tab\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 header\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u55357 \u56523  \u1044 \u1077 \u1090 \u1072 \u1083 \u1080 \u1079 \u1072 \u1094 \u1080 \u1103 "\cf4 \strokec4 )\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 write\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1041 \u1086 \u1083 \u1077 \u1077  \u1087 \u1086 \u1076 \u1088 \u1086 \u1073 \u1085 \u1099 \u1077  \u1076 \u1072 \u1085 \u1085 \u1099 \u1077  \u1086  \u1087 \u1083 \u1086 \u1097 \u1072 \u1076 \u1103 \u1093 , \u1076 \u1086 \u1093 \u1086 \u1076 \u1072 \u1093 , \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1072 \u1093  \u1080  \u1080 \u1090 \u1086 \u1075 \u1072 \u1093 ."\cf4 \strokec4 )\cb1 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 display_tab4_area_metrics\cf4 \strokec4 (\cf8 \strokec8 tab\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 ):\cb1 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf8 \strokec8 tab\cf4 \strokec4 :\cb1 \
\cb3         \cf8 \strokec8 col1\cf4 \strokec4 , \cf8 \strokec8 col2\cf4 \strokec4 , \cf8 \strokec8 col3\cf4 \strokec4 , \cf8 \strokec8 col4\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 columns\cf4 \strokec4 (\cf12 \strokec12 4\cf4 \strokec4 )\cb1 \
\cb3         \cf6 \strokec6 MetricDisplay\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1057 \u1090 \u1072 \u1085 \u1076 \u1072 \u1088 \u1090 \u1085 \u1086 \u1077  (\u1084 \'b2)"\cf4 \strokec4 ).\cf7 \strokec7 display\cf4 \strokec4 (\cf8 \strokec8 col1\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 .storage_area)\cb1 \
\cb3         \cf6 \strokec6 MetricDisplay\cf4 \strokec4 (\cf10 \strokec10 "VIP (\uc0\u1084 \'b2)"\cf4 \strokec4 ).\cf7 \strokec7 display\cf4 \strokec4 (\cf8 \strokec8 col2\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 .vip_area)\cb1 \
\cb3         \cf6 \strokec6 MetricDisplay\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1050 \u1088 \u1072 \u1090 \u1082 \u1086 \u1089 \u1088 \u1086 \u1095 \u1085 \u1086 \u1077  (\u1084 \'b2)"\cf4 \strokec4 ).\cf7 \strokec7 display\cf4 \strokec4 (\cf8 \strokec8 col3\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 .short_term_area)\cb1 \
\cb3         \cf6 \strokec6 MetricDisplay\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1047 \u1072 \u1081 \u1084 \u1099  (\u1084 \'b2)"\cf4 \strokec4 ).\cf7 \strokec7 display\cf4 \strokec4 (\cf8 \strokec8 col4\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 .loan_area)\cb1 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 display_tab4_storage_table\cf4 \strokec4 (\cf8 \strokec8 tab\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 base_financials\cf4 \strokec4 ):\cb1 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf8 \strokec8 tab\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 write\cf4 \strokec4 (\cf10 \strokec10 "---"\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 df_storage\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 pd\cf4 \strokec4 .\cf6 \strokec6 DataFrame\cf4 \strokec4 (\{\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1058 \u1080 \u1087  \u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1103 "\cf4 \strokec4 : [\cf10 \strokec10 "\uc0\u1057 \u1090 \u1072 \u1085 \u1076 \u1072 \u1088 \u1090 \u1085 \u1086 \u1077 "\cf4 \strokec4 , \cf10 \strokec10 "VIP"\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1050 \u1088 \u1072 \u1090 \u1082 \u1086 \u1089 \u1088 \u1086 \u1095 \u1085 \u1086 \u1077 "\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1047 \u1072 \u1081 \u1084 \u1099 "\cf4 \strokec4 ],\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1055 \u1083 \u1086 \u1097 \u1072 \u1076 \u1100  (\u1084 \'b2)"\cf4 \strokec4 : [\cb1 \
\cb3                 \cf8 \strokec8 params\cf4 \strokec4 .storage_area,\cb1 \
\cb3                 \cf8 \strokec8 params\cf4 \strokec4 .vip_area,\cb1 \
\cb3                 \cf8 \strokec8 params\cf4 \strokec4 .short_term_area,\cb1 \
\cb3                 \cf8 \strokec8 params\cf4 \strokec4 .loan_area\cb1 \
\cb3             ],\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1044 \u1086 \u1093 \u1086 \u1076  (\u1088 \u1091 \u1073 .)"\cf4 \strokec4 : [\cb1 \
\cb3                 \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "storage_income"\cf4 \strokec4 ],\cb1 \
\cb3                 \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "vip_income"\cf4 \strokec4 ],\cb1 \
\cb3                 \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "short_term_income"\cf4 \strokec4 ],\cb1 \
\cb3                 \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "loan_income_after_realization"\cf4 \strokec4 ],\cb1 \
\cb3             ],\cb1 \
\cb3         \})\cb1 \
\cb3         \cf6 \strokec6 TableDisplay\cf4 \strokec4 ().\cf7 \strokec7 display\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 df_storage\cf4 \strokec4 .\cf8 \strokec8 style\cf4 \strokec4 .\cf7 \strokec7 format\cf4 \strokec4 (\{\cb1 \
\cb3                 \cf10 \strokec10 "\uc0\u1055 \u1083 \u1086 \u1097 \u1072 \u1076 \u1100  (\u1084 \'b2)"\cf4 \strokec4 : \cf10 \strokec10 "\cf11 \strokec11 \{:,.2f\}\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3                 \cf10 \strokec10 "\uc0\u1044 \u1086 \u1093 \u1086 \u1076  (\u1088 \u1091 \u1073 .)"\cf4 \strokec4 : \cf10 \strokec10 "\cf11 \strokec11 \{:,.2f\}\cf10 \strokec10 "\cf4 \cb1 \strokec4 \
\cb3             \})\cb1 \
\cb3         )\cb1 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 display_tab4_profit_table\cf4 \strokec4 (\cf8 \strokec8 tab\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 base_financials\cf4 \strokec4 ):\cb1 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf8 \strokec8 tab\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 write\cf4 \strokec4 (\cf10 \strokec10 "---"\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 df_profit\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 pd\cf4 \strokec4 .\cf6 \strokec6 DataFrame\cf4 \strokec4 (\{\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1058 \u1080 \u1087  \u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1103 "\cf4 \strokec4 : [\cf10 \strokec10 "\uc0\u1057 \u1090 \u1072 \u1085 \u1076 \u1072 \u1088 \u1090 \u1085 \u1086 \u1077 "\cf4 \strokec4 , \cf10 \strokec10 "VIP"\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1050 \u1088 \u1072 \u1090 \u1082 \u1086 \u1089 \u1088 \u1086 \u1095 \u1085 \u1086 \u1077 "\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1047 \u1072 \u1081 \u1084 \u1099 "\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1056 \u1077 \u1072 \u1083 \u1080 \u1079 \u1072 \u1094 \u1080 \u1103 "\cf4 \strokec4 ],\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1044 \u1086 \u1093 \u1086 \u1076  (\u1088 \u1091 \u1073 .)"\cf4 \strokec4 : [\cb1 \
\cb3                 \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "storage_income"\cf4 \strokec4 ],\cb1 \
\cb3                 \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "vip_income"\cf4 \strokec4 ],\cb1 \
\cb3                 \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "short_term_income"\cf4 \strokec4 ],\cb1 \
\cb3                 \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "loan_income"\cf4 \strokec4 ],\cb1 \
\cb3                 \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "realization_income"\cf4 \strokec4 ],\cb1 \
\cb3             ],\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1044 \u1086 \u1093 \u1086 \u1076  (\u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1077 )"\cf4 \strokec4 : [\cb1 \
\cb3                 \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "storage_income"\cf4 \strokec4 ],\cb1 \
\cb3                 \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "vip_income"\cf4 \strokec4 ],\cb1 \
\cb3                 \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "short_term_income"\cf4 \strokec4 ],\cb1 \
\cb3                 \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3                 \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             ],\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1044 \u1086 \u1093 \u1086 \u1076  (\u1079 \u1072 \u1081 \u1084 \u1099 )"\cf4 \strokec4 : [\cb1 \
\cb3                 \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3                 \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3                 \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "loan_income"\cf4 \strokec4 ],\cb1 \
\cb3                 \cf12 \strokec12 0\cf4 \cb1 \strokec4 \
\cb3             ],\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1044 \u1086 \u1093 \u1086 \u1076  (\u1088 \u1077 \u1072 \u1083 \u1080 \u1079 \u1072 \u1094 \u1080 \u1103 )"\cf4 \strokec4 : [\cb1 \
\cb3                 \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3                 \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3                 \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3                 \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "realization_income"\cf4 \strokec4 ]\cb1 \
\cb3             ],\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1045 \u1078 \u1077 \u1084 \u1077 \u1089 \u1103 \u1095 \u1085 \u1099 \u1077  \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1099  (\u1088 \u1091 \u1073 .)"\cf4 \strokec4 : [\cb1 \
\cb3                 \cf8 \strokec8 params\cf4 \strokec4 .storage_area \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .rental_cost_per_m2,\cb1 \
\cb3                 \cf8 \strokec8 params\cf4 \strokec4 .vip_area \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .rental_cost_per_m2,\cb1 \
\cb3                 \cf8 \strokec8 params\cf4 \strokec4 .short_term_area \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .rental_cost_per_m2,\cb1 \
\cb3                 \cf8 \strokec8 params\cf4 \strokec4 .loan_area \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .rental_cost_per_m2,\cb1 \
\cb3                 \cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             ],\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1055 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100  (\u1088 \u1091 \u1073 .)"\cf4 \strokec4 : [\cb1 \
\cb3                 \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "storage_income"\cf4 \strokec4 ] \cf9 \strokec9 -\cf4 \strokec4  (\cf8 \strokec8 params\cf4 \strokec4 .storage_area \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .rental_cost_per_m2),\cb1 \
\cb3                 \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "vip_income"\cf4 \strokec4 ] \cf9 \strokec9 -\cf4 \strokec4  (\cf8 \strokec8 params\cf4 \strokec4 .vip_area \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .rental_cost_per_m2),\cb1 \
\cb3                 \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "short_term_income"\cf4 \strokec4 ] \cf9 \strokec9 -\cf4 \strokec4  (\cf8 \strokec8 params\cf4 \strokec4 .short_term_area \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .rental_cost_per_m2),\cb1 \
\cb3                 \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "loan_income_after_realization"\cf4 \strokec4 ] \cf9 \strokec9 -\cf4 \strokec4  (\cf8 \strokec8 params\cf4 \strokec4 .loan_area \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .rental_cost_per_m2),\cb1 \
\cb3                 \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "realization_income"\cf4 \strokec4 ],\cb1 \
\cb3             ],\cb1 \
\cb3         \})\cb1 \
\
\cb3         \cf11 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 highlight_negative\cf4 \strokec4 (\cf8 \strokec8 s\cf4 \strokec4 ):\cb1 \
\cb3             \cf5 \strokec5 return\cf4 \strokec4  [\cf10 \strokec10 "background-color: #ffcccc"\cf4 \strokec4  \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 v\cf4 \strokec4  \cf9 \strokec9 <\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4  \cf5 \strokec5 else\cf4 \strokec4  \cf10 \strokec10 ""\cf4 \strokec4  \cf5 \strokec5 for\cf4 \strokec4  \cf8 \strokec8 v\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 s\cf4 \strokec4 ]\cb1 \
\
\cb3         \cf6 \strokec6 TableDisplay\cf4 \strokec4 ().\cf7 \strokec7 display\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 df_profit\cf4 \strokec4 .\cf8 \strokec8 style\cf4 \cb1 \strokec4 \
\cb3             .\cf7 \strokec7 apply\cf4 \strokec4 (\cf7 \strokec7 highlight_negative\cf4 \strokec4 , \cf8 \strokec8 subset\cf9 \strokec9 =\cf4 \strokec4 [\cf10 \strokec10 "\uc0\u1055 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100  (\u1088 \u1091 \u1073 .)"\cf4 \strokec4 ])\cb1 \
\cb3             .\cf7 \strokec7 format\cf4 \strokec4 (\{\cb1 \
\cb3                 \cf8 \strokec8 col\cf4 \strokec4 : \cf10 \strokec10 "\cf11 \strokec11 \{:,.2f\}\cf10 \strokec10 "\cf4 \strokec4  \cf5 \strokec5 for\cf4 \strokec4  \cf8 \strokec8 col\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  [\cb1 \
\cb3                     \cf10 \strokec10 "\uc0\u1044 \u1086 \u1093 \u1086 \u1076  (\u1088 \u1091 \u1073 .)"\cf4 \strokec4 ,\cb1 \
\cb3                     \cf10 \strokec10 "\uc0\u1045 \u1078 \u1077 \u1084 \u1077 \u1089 \u1103 \u1095 \u1085 \u1099 \u1077  \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1099  (\u1088 \u1091 \u1073 .)"\cf4 \strokec4 ,\cb1 \
\cb3                     \cf10 \strokec10 "\uc0\u1055 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100  (\u1088 \u1091 \u1073 .)"\cf4 \strokec4 ,\cb1 \
\cb3                     \cf10 \strokec10 "\uc0\u1044 \u1086 \u1093 \u1086 \u1076  (\u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1077 )"\cf4 \strokec4 ,\cb1 \
\cb3                     \cf10 \strokec10 "\uc0\u1044 \u1086 \u1093 \u1086 \u1076  (\u1079 \u1072 \u1081 \u1084 \u1099 )"\cf4 \strokec4 ,\cb1 \
\cb3                     \cf10 \strokec10 "\uc0\u1044 \u1086 \u1093 \u1086 \u1076  (\u1088 \u1077 \u1072 \u1083 \u1080 \u1079 \u1072 \u1094 \u1080 \u1103 )"\cf4 \strokec4 ,\cb1 \
\cb3                 ]\cb1 \
\cb3             \})\cb1 \
\cb3         )\cb1 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 display_tab4_results\cf4 \strokec4 (\cf8 \strokec8 tab\cf4 \strokec4 , \cf8 \strokec8 base_financials\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 irr_val\cf4 \strokec4 ):\cb1 \
\cb3     \cf5 \strokec5 from\cf4 \strokec4  \cf6 \strokec6 calculations\cf4 \strokec4  \cf5 \strokec5 import\cf4 \strokec4  \cf7 \strokec7 calculate_additional_metrics\cf4 \strokec4 , \cf7 \strokec7 calculate_roi\cf4 \strokec4 , \cf7 \strokec7 calculate_total_bep\cf4 \cb1 \strokec4 \
\
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf8 \strokec8 tab\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 write\cf4 \strokec4 (\cf10 \strokec10 "---"\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 pm\cf4 \strokec4 , \cf8 \strokec8 pr\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_additional_metrics\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "total_income"\cf4 \strokec4 ],\cb1 \
\cb3             \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "total_expenses"\cf4 \strokec4 ],\cb1 \
\cb3             \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "profit"\cf4 \strokec4 ]\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 roi_val\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_roi\cf4 \strokec4 (\cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "total_income"\cf4 \strokec4 ], \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "total_expenses"\cf4 \strokec4 ])\cb1 \
\cb3         \cf8 \strokec8 bep_income\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_total_bep\cf4 \strokec4 (\cf8 \strokec8 base_financials\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 df_results\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 pd\cf4 \strokec4 .\cf6 \strokec6 DataFrame\cf4 \strokec4 (\{\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1055 \u1086 \u1082 \u1072 \u1079 \u1072 \u1090 \u1077 \u1083 \u1100 "\cf4 \strokec4 : [\cb1 \
\cb3                 \cf10 \strokec10 "\uc0\u1054 \u1073 \u1097 \u1080 \u1081  \u1076 \u1086 \u1093 \u1086 \u1076 "\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1054 \u1073 \u1097 \u1080 \u1077  \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1099 "\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1055 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100 "\cf4 \strokec4 ,\cb1 \
\cb3                 \cf10 \strokec10 "\uc0\u1052 \u1072 \u1088 \u1078 \u1072  \u1087 \u1088 \u1080 \u1073 \u1099 \u1083 \u1080  (%)"\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1056 \u1077 \u1085 \u1090 \u1072 \u1073 \u1077 \u1083 \u1100 \u1085 \u1086 \u1089 \u1090 \u1100  (%)"\cf4 \strokec4 , \cf10 \strokec10 "ROI (%)"\cf4 \strokec4 ,\cb1 \
\cb3                 \cf10 \strokec10 "IRR (%)"\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1052 \u1080 \u1085 . \u1089 \u1091 \u1084 \u1084 \u1072  \u1079 \u1072 \u1081 \u1084 \u1072  (\u1088 \u1091 \u1073 .)"\cf4 \strokec4 ,\cb1 \
\cb3                 \cf10 \strokec10 "\uc0\u1045 \u1076 \u1080 \u1085 \u1086 \u1074 \u1088 \u1077 \u1084 \u1077 \u1085 \u1085 \u1099 \u1077  \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1099  (\u1088 \u1091 \u1073 .)"\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1053 \u1077 \u1086 \u1073 \u1093 \u1086 \u1076 \u1080 \u1084 \u1099 \u1081  \u1076 \u1086 \u1093 \u1086 \u1076  \u1076 \u1083 \u1103  BEP"\cf4 \strokec4 ,\cb1 \
\cb3                 \cf10 \strokec10 "\uc0\u1058 \u1077 \u1082 \u1091 \u1097 \u1080 \u1081  \u1076 \u1086 \u1093 \u1086 \u1076  (\u1088 \u1091 \u1073 .)"\cf4 \cb1 \strokec4 \
\cb3             ],\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1047 \u1085 \u1072 \u1095 \u1077 \u1085 \u1080 \u1077 "\cf4 \strokec4 : [\cb1 \
\cb3                 \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "total_income"\cf4 \strokec4 ],\cb1 \
\cb3                 \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "total_expenses"\cf4 \strokec4 ],\cb1 \
\cb3                 \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "profit"\cf4 \strokec4 ],\cb1 \
\cb3                 \cf8 \strokec8 pm\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 pr\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 roi_val\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 irr_val\cf4 \strokec4 ,\cb1 \
\cb3                 \cf7 \strokec7 min_loan_amount_for_bep\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 base_financials\cf4 \strokec4 ),\cb1 \
\cb3                 \cf8 \strokec8 params\cf4 \strokec4 .one_time_expenses,\cb1 \
\cb3                 \cf8 \strokec8 bep_income\cf4 \strokec4 ,\cb1 \
\cb3                 \cf8 \strokec8 base_financials\cf4 \strokec4 [\cf10 \strokec10 "total_income"\cf4 \strokec4 ],\cb1 \
\cb3             ],\cb1 \
\cb3         \})\cb1 \
\cb3         \cf6 \strokec6 TableDisplay\cf4 \strokec4 ().\cf7 \strokec7 display\cf4 \strokec4 (\cf8 \strokec8 df_results\cf4 \strokec4 )\cb1 \
\
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 markdown\cf4 \strokec4 (\cf7 \strokec7 generate_download_link\cf4 \strokec4 (\cf8 \strokec8 df_results\cf4 \strokec4 , \cf8 \strokec8 filename\cf9 \strokec9 =\cf10 \strokec10 "results.csv"\cf4 \strokec4 ))\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 markdown\cf4 \strokec4 (\cf7 \strokec7 generate_excel_download\cf4 \strokec4 (\cf8 \strokec8 df_results\cf4 \strokec4 , \cf8 \strokec8 filename\cf9 \strokec9 =\cf10 \strokec10 "results.xlsx"\cf4 \strokec4 ))\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 info\cf4 \strokec4 (\cb1 \
\cb3             \cf10 \strokec10 "\uc0\u1057 \u1082 \u1072 \u1095 \u1072 \u1081 \u1090 \u1077  \u1088 \u1072 \u1089 \u1096 \u1080 \u1088 \u1077 \u1085 \u1085 \u1099 \u1081  \u1086 \u1090 \u1095 \u1105 \u1090  \u1076 \u1083 \u1103  \u1076 \u1077 \u1090 \u1072 \u1083 \u1100 \u1085 \u1086 \u1075 \u1086  \u1072 \u1085 \u1072 \u1083 \u1080 \u1079 \u1072 . "\cf4 \cb1 \strokec4 \
\cb3             \cf10 \strokec10 "\uc0\u1047 \u1076 \u1077 \u1089 \u1100  \u1074 \u1099  \u1074 \u1080 \u1076 \u1080 \u1090 \u1077  \u1076 \u1086 \u1087 \u1086 \u1083 \u1085 \u1080 \u1090 \u1077 \u1083 \u1100 \u1085 \u1099 \u1077  \u1084 \u1077 \u1090 \u1088 \u1080 \u1082 \u1080 : ROI, IRR, "\cf4 \cb1 \strokec4 \
\cb3             \cf10 \strokec10 "\uc0\u1072  \u1090 \u1072 \u1082 \u1078 \u1077  \u1079 \u1072 \u1090 \u1088 \u1072 \u1090 \u1099  \u1085 \u1072  \u1091 \u1087 \u1072 \u1082 \u1086 \u1074 \u1082 \u1091 , \u1101 \u1083 \u1077 \u1082 \u1090 \u1088 \u1080 \u1095 \u1077 \u1089 \u1090 \u1074 \u1086  \u1080  \u1090 . \u1076 ."\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 compare_params\cf4 \strokec4 (\cf8 \strokec8 tab\cf4 \strokec4 , \cf8 \strokec8 current_params\cf4 \strokec4 , \cf8 \strokec8 selected_param\cf4 \strokec4 ):\cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  (\cf10 \strokec10 "saved_params"\cf4 \strokec4  \cf11 \strokec11 not\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 session_state\cf4 \cb1 \strokec4 \
\cb3         \cf11 \strokec11 or\cf4 \strokec4  \cf8 \strokec8 selected_param\cf4 \strokec4  \cf11 \strokec11 not\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 session_state\cf4 \strokec4 .saved_params):\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 error\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1053 \u1077 \u1090  \u1089 \u1086 \u1093 \u1088 \u1072 \u1085 \u1105 \u1085 \u1085 \u1099 \u1093  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1086 \u1074  \u1076 \u1083 \u1103  \u1089 \u1088 \u1072 \u1074 \u1085 \u1077 \u1085 \u1080 \u1103 ."\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \cb1 \strokec4 \
\
\cb3     \cf8 \strokec8 saved_params\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 session_state\cf4 \strokec4 .saved_params[\cf8 \strokec8 selected_param\cf4 \strokec4 ]\cb1 \
\
\cb3     \cf8 \strokec8 comparison_data\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  []\cb1 \
\cb3     \cf8 \strokec8 attributes_to_compare\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  [\cb1 \
\cb3         \cf10 \strokec10 "total_area"\cf4 \strokec4 , \cf10 \strokec10 "rental_cost_per_m2"\cf4 \strokec4 , \cf10 \strokec10 "useful_area_ratio"\cf4 \strokec4 ,\cb1 \
\cb3         \cf10 \strokec10 "storage_area_manual"\cf4 \strokec4 , \cf10 \strokec10 "loan_area_manual"\cf4 \strokec4 , \cf10 \strokec10 "vip_area_manual"\cf4 \strokec4 ,\cb1 \
\cb3         \cf10 \strokec10 "short_term_area_manual"\cf4 \strokec4 , \cf10 \strokec10 "storage_fee"\cf4 \strokec4 , \cf10 \strokec10 "shelves_per_m2"\cf4 \strokec4 ,\cb1 \
\cb3         \cf10 \strokec10 "short_term_daily_rate"\cf4 \strokec4 , \cf10 \strokec10 "vip_extra_fee"\cf4 \strokec4 , \cf10 \strokec10 "item_evaluation"\cf4 \strokec4 ,\cb1 \
\cb3         \cf10 \strokec10 "item_realization_markup"\cf4 \strokec4 , \cf10 \strokec10 "average_item_value"\cf4 \strokec4 , \cf10 \strokec10 "loan_interest_rate"\cf4 \strokec4 ,\cb1 \
\cb3         \cf10 \strokec10 "loan_term_days"\cf4 \strokec4 , \cf10 \strokec10 "realization_share_storage"\cf4 \strokec4 , \cf10 \strokec10 "realization_share_loan"\cf4 \strokec4 ,\cb1 \
\cb3         \cf10 \strokec10 "realization_share_vip"\cf4 \strokec4 , \cf10 \strokec10 "realization_share_short_term"\cf4 \strokec4 ,\cb1 \
\cb3         \cf10 \strokec10 "storage_fill_rate"\cf4 \strokec4 , \cf10 \strokec10 "loan_fill_rate"\cf4 \strokec4 , \cf10 \strokec10 "vip_fill_rate"\cf4 \strokec4 , \cf10 \strokec10 "short_term_fill_rate"\cf4 \strokec4 ,\cb1 \
\cb3         \cf10 \strokec10 "storage_items_density"\cf4 \strokec4 , \cf10 \strokec10 "loan_items_density"\cf4 \strokec4 , \cf10 \strokec10 "vip_items_density"\cf4 \strokec4 ,\cb1 \
\cb3         \cf10 \strokec10 "short_term_items_density"\cf4 \strokec4 , \cf10 \strokec10 "storage_monthly_churn"\cf4 \strokec4 , \cf10 \strokec10 "loan_monthly_churn"\cf4 \strokec4 ,\cb1 \
\cb3         \cf10 \strokec10 "vip_monthly_churn"\cf4 \strokec4 , \cf10 \strokec10 "short_term_monthly_churn"\cf4 \strokec4 , \cf10 \strokec10 "salary_expense"\cf4 \strokec4 ,\cb1 \
\cb3         \cf10 \strokec10 "miscellaneous_expenses"\cf4 \strokec4 , \cf10 \strokec10 "depreciation_expense"\cf4 \strokec4 , \cf10 \strokec10 "marketing_expenses"\cf4 \strokec4 ,\cb1 \
\cb3         \cf10 \strokec10 "insurance_expenses"\cf4 \strokec4 , \cf10 \strokec10 "taxes"\cf4 \strokec4 , \cf10 \strokec10 "utilities_expenses"\cf4 \strokec4 , \cf10 \strokec10 "maintenance_expenses"\cf4 \strokec4 ,\cb1 \
\cb3         \cf10 \strokec10 "one_time_setup_cost"\cf4 \strokec4 , \cf10 \strokec10 "one_time_equipment_cost"\cf4 \strokec4 , \cf10 \strokec10 "one_time_other_costs"\cf4 \strokec4 ,\cb1 \
\cb3         \cf10 \strokec10 "one_time_legal_cost"\cf4 \strokec4 , \cf10 \strokec10 "one_time_logistics_cost"\cf4 \strokec4 ,\cb1 \
\cb3         \cf10 \strokec10 "electricity_cost_per_m2"\cf4 \strokec4 , \cf10 \strokec10 "packaging_cost_per_m2"\cf4 \strokec4 ,\cb1 \
\cb3         \cf10 \strokec10 "monthly_inflation_rate"\cf4 \strokec4 , \cf10 \strokec10 "monthly_rent_growth"\cf4 \strokec4 ,\cb1 \
\cb3         \cf10 \strokec10 "monthly_salary_growth"\cf4 \strokec4 , \cf10 \strokec10 "monthly_other_expenses_growth"\cf4 \strokec4 , \cf10 \strokec10 "time_horizon"\cf4 \strokec4 ,\cb1 \
\cb3         \cf10 \strokec10 "default_probability"\cf4 \strokec4 , \cf10 \strokec10 "liquidity_factor"\cf4 \strokec4 , \cf10 \strokec10 "safety_factor"\cf4 \strokec4 ,\cb1 \
\cb3         \cf10 \strokec10 "loan_grace_period"\cf4 \strokec4 , \cf10 \strokec10 "monthly_income_growth"\cf4 \strokec4 , \cf10 \strokec10 "monthly_expenses_growth"\cf4 \strokec4 ,\cb1 \
\cb3         \cf10 \strokec10 "forecast_method"\cf4 \strokec4 , \cf10 \strokec10 "monte_carlo_simulations"\cf4 \strokec4 , \cf10 \strokec10 "monte_carlo_deviation"\cf4 \strokec4 ,\cb1 \
\cb3         \cf10 \strokec10 "monte_carlo_seed"\cf4 \strokec4 , \cf10 \strokec10 "enable_ml_settings"\cf4 \strokec4 , \cf10 \strokec10 "poly_degree"\cf4 \strokec4 ,\cb1 \
\cb3     ]\cb1 \
\
\cb3     \cf5 \strokec5 for\cf4 \strokec4  \cf8 \strokec8 attr\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 attributes_to_compare\cf4 \strokec4 :\cb1 \
\cb3         \cf8 \strokec8 current_value\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 getattr\cf4 \strokec4 (\cf8 \strokec8 current_params\cf4 \strokec4 , \cf8 \strokec8 attr\cf4 \strokec4 , \cf11 \strokec11 None\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 saved_value\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 saved_params\cf4 \strokec4 .get(\cf8 \strokec8 attr\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 current_value\cf4 \strokec4  \cf9 \strokec9 !=\cf4 \strokec4  \cf8 \strokec8 saved_value\cf4 \strokec4 :\cb1 \
\cb3             \cf5 \strokec5 if\cf4 \strokec4  \cf7 \strokec7 isinstance\cf4 \strokec4 (\cf8 \strokec8 current_value\cf4 \strokec4 , (\cf6 \strokec6 int\cf4 \strokec4 , \cf6 \strokec6 float\cf4 \strokec4 )) \cf11 \strokec11 and\cf4 \strokec4  \cf7 \strokec7 isinstance\cf4 \strokec4 (\cf8 \strokec8 saved_value\cf4 \strokec4 , (\cf6 \strokec6 int\cf4 \strokec4 , \cf6 \strokec6 float\cf4 \strokec4 )):\cb1 \
\cb3                 \cf8 \strokec8 comparison_data\cf4 \strokec4 .\cf7 \strokec7 append\cf4 \strokec4 (\{\cb1 \
\cb3                     \cf10 \strokec10 "\uc0\u1055 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 "\cf4 \strokec4 : \cf8 \strokec8 attr\cf4 \strokec4 ,\cb1 \
\cb3                     \cf10 \strokec10 "\uc0\u1058 \u1077 \u1082 \u1091 \u1097 \u1077 \u1077  \u1079 \u1085 \u1072 \u1095 \u1077 \u1085 \u1080 \u1077 "\cf4 \strokec4 : \cf11 \strokec11 f\cf10 \strokec10 "\cf11 \strokec11 \{\cf8 \strokec8 current_value\cf11 \strokec11 :,.2f\}\cf10 \strokec10 "\cf4 \strokec4 ,\cb1 \
\cb3                     \cf10 \strokec10 "\uc0\u1057 \u1086 \u1093 \u1088 \u1072 \u1085 \u1105 \u1085 \u1085 \u1086 \u1077  \u1079 \u1085 \u1072 \u1095 \u1077 \u1085 \u1080 \u1077 "\cf4 \strokec4 : \cf11 \strokec11 f\cf10 \strokec10 "\cf11 \strokec11 \{\cf8 \strokec8 saved_value\cf11 \strokec11 :,.2f\}\cf10 \strokec10 "\cf4 \cb1 \strokec4 \
\cb3                 \})\cb1 \
\cb3             \cf5 \strokec5 else\cf4 \strokec4 :\cb1 \
\cb3                 \cf8 \strokec8 comparison_data\cf4 \strokec4 .\cf7 \strokec7 append\cf4 \strokec4 (\{\cb1 \
\cb3                     \cf10 \strokec10 "\uc0\u1055 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 "\cf4 \strokec4 : \cf8 \strokec8 attr\cf4 \strokec4 ,\cb1 \
\cb3                     \cf10 \strokec10 "\uc0\u1058 \u1077 \u1082 \u1091 \u1097 \u1077 \u1077  \u1079 \u1085 \u1072 \u1095 \u1077 \u1085 \u1080 \u1077 "\cf4 \strokec4 : \cf6 \strokec6 str\cf4 \strokec4 (\cf8 \strokec8 current_value\cf4 \strokec4 ),\cb1 \
\cb3                     \cf10 \strokec10 "\uc0\u1057 \u1086 \u1093 \u1088 \u1072 \u1085 \u1105 \u1085 \u1085 \u1086 \u1077  \u1079 \u1085 \u1072 \u1095 \u1077 \u1085 \u1080 \u1077 "\cf4 \strokec4 : \cf6 \strokec6 str\cf4 \strokec4 (\cf8 \strokec8 saved_value\cf4 \strokec4 )\cb1 \
\cb3                 \})\cb1 \
\
\cb3     \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 comparison_data\cf4 \strokec4 :\cb1 \
\cb3         \cf8 \strokec8 df_compare\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 pd\cf4 \strokec4 .\cf6 \strokec6 DataFrame\cf4 \strokec4 (\cf8 \strokec8 comparison_data\cf4 \strokec4 )\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 dataframe\cf4 \strokec4 (\cf8 \strokec8 df_compare\cf4 \strokec4 )\cb1 \
\cb3     \cf5 \strokec5 else\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 info\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1053 \u1077 \u1090  \u1088 \u1072 \u1079 \u1083 \u1080 \u1095 \u1080 \u1081  \u1084 \u1077 \u1078 \u1076 \u1091  \u1090 \u1077 \u1082 \u1091 \u1097 \u1080 \u1084 \u1080  \u1080  \u1089 \u1086 \u1093 \u1088 \u1072 \u1085 \u1105 \u1085 \u1085 \u1099 \u1084 \u1080  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1072 \u1084 \u1080 ."\cf4 \strokec4 )\cb1 \
\pard\pardeftab560\slleading20\partightenfactor0

\f0\fs26 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 \
\
\'b4\'b4\'b4\
\
\
\uc0\u1060 \u1072 \u1081 \u1083 : data_model.py\
\
\'b4\'b4\'b4python\
\pard\pardeftab720\partightenfactor0

\f1\fs24 \cf2 \cb3 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 # data_model.py\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 from\cf4 \strokec4  \cf6 \strokec6 dataclasses\cf4 \strokec4  \cf5 \strokec5 import\cf4 \strokec4  \cf7 \strokec7 dataclass\cf4 \strokec4 , \cf7 \strokec7 field\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 from\cf4 \strokec4  \cf6 \strokec6 typing\cf4 \strokec4  \cf5 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 Optional\cf4 \strokec4 , \cf6 \strokec6 Tuple\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 logging\cf4 \cb1 \strokec4 \
\
\cf6 \cb3 \strokec6 logging\cf4 \strokec4 .\cf7 \strokec7 basicConfig\cf4 \strokec4 (\cf8 \strokec8 level\cf9 \strokec9 =\cf6 \strokec6 logging\cf4 \strokec4 .\cf8 \strokec8 INFO\cf4 \strokec4 , \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %(asctime)s\cf10 \strokec10  - \cf11 \strokec11 %(levelname)s\cf10 \strokec10  - \cf11 \strokec11 %(message)s\cf10 \strokec10 "\cf4 \strokec4 )\cb1 \
\
\
\cf7 \cb3 \strokec7 @dataclass\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11 class\cf4 \strokec4  \cf6 \strokec6 WarehouseParams\cf4 \strokec4 :\cb1 \
\cb3     \cf10 \strokec10 """\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     \uc0\u1050 \u1083 \u1072 \u1089 \u1089  \u1076 \u1083 \u1103  \u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1103  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1086 \u1074  \u1089 \u1082 \u1083 \u1072 \u1076 \u1072 .\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     """\cf4 \cb1 \strokec4 \
\
\cb3     \cf8 \strokec8 total_area\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 rental_cost_per_m2\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 useful_area_ratio\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 mode\cf4 \strokec4 : \cf6 \strokec6 str\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 storage_share\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 loan_share\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 vip_share\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 short_term_share\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 storage_area_manual\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 loan_area_manual\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 vip_area_manual\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 short_term_area_manual\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 storage_fee\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 shelves_per_m2\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 short_term_daily_rate\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 vip_extra_fee\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 item_evaluation\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 item_realization_markup\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 average_item_value\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 loan_interest_rate\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 loan_term_days\cf4 \strokec4 : \cf6 \strokec6 int\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 realization_share_storage\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 realization_share_loan\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 realization_share_vip\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 realization_share_short_term\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 storage_items_density\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 loan_items_density\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 vip_items_density\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 short_term_items_density\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 storage_fill_rate\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 loan_fill_rate\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 vip_fill_rate\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 short_term_fill_rate\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 storage_monthly_churn\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 loan_monthly_churn\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 vip_monthly_churn\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 short_term_monthly_churn\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 salary_expense\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 miscellaneous_expenses\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 depreciation_expense\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 marketing_expenses\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 insurance_expenses\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 taxes\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 utilities_expenses\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 maintenance_expenses\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 one_time_setup_cost\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 one_time_equipment_cost\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 one_time_other_costs\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 one_time_legal_cost\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 one_time_logistics_cost\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 time_horizon\cf4 \strokec4 : \cf6 \strokec6 int\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 monthly_rent_growth\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 default_probability\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 liquidity_factor\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 safety_factor\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 loan_grace_period\cf4 \strokec4 : \cf6 \strokec6 int\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 monthly_income_growth\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 monthly_expenses_growth\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 forecast_method\cf4 \strokec4 : \cf6 \strokec6 str\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 monte_carlo_simulations\cf4 \strokec4 : \cf6 \strokec6 int\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 monte_carlo_deviation\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 monte_carlo_seed\cf4 \strokec4 : \cf6 \strokec6 int\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 enable_ml_settings\cf4 \strokec4 : \cf6 \strokec6 bool\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 electricity_cost_per_m2\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 monthly_inflation_rate\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 monthly_salary_growth\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 monthly_other_expenses_growth\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \cb1 \strokec4 \
\
\cb3     \cf2 \strokec2 # \uc0\u1053 \u1086 \u1074 \u1099 \u1081  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088  \u1091 \u1087 \u1072 \u1082 \u1086 \u1074 \u1082 \u1080  \u1085 \u1072  \u1084 \'b2\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 packaging_cost_per_m2\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 10.0\cf4 \cb1 \strokec4 \
\
\cb3     \cf8 \strokec8 one_time_expenses\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 0.0\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 usable_area\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 0.0\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 storage_area\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 0.0\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 loan_area\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 0.0\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 vip_area\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 0.0\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 short_term_area\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 0.0\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 payback_period\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 0.0\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 poly_degree\cf4 \strokec4 : \cf6 \strokec6 int\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 2\cf4 \cb1 \strokec4 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 validate_inputs\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 : \cf6 \strokec6 WarehouseParams\cf4 \strokec4 ) -> \cf6 \strokec6 Tuple\cf4 \strokec4 [\cf6 \strokec6 bool\cf4 \strokec4 , \cf6 \strokec6 str\cf4 \strokec4 ]:\cb1 \
\cb3     \cf10 \strokec10 """\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     \uc0\u1055 \u1088 \u1086 \u1074 \u1077 \u1088 \u1103 \u1077 \u1090  \u1082 \u1086 \u1088 \u1088 \u1077 \u1082 \u1090 \u1085 \u1086 \u1089 \u1090 \u1100  \u1074 \u1074 \u1077 \u1076 \u1105 \u1085 \u1085 \u1099 \u1093  \u1076 \u1072 \u1085 \u1085 \u1099 \u1093 .\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     """\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  \cf11 \strokec11 not\cf4 \strokec4  \cf7 \strokec7 isinstance\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 total_area\cf4 \strokec4 , (\cf6 \strokec6 int\cf4 \strokec4 , \cf6 \strokec6 float\cf4 \strokec4 )) \cf11 \strokec11 or\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 total_area\cf4 \strokec4  \cf9 \strokec9 <=\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 :\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf11 \strokec11 False\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1054 \u1073 \u1097 \u1072 \u1103  \u1087 \u1083 \u1086 \u1097 \u1072 \u1076 \u1100  \u1076 \u1086 \u1083 \u1078 \u1085 \u1072  \u1073 \u1099 \u1090 \u1100  \u1095 \u1080 \u1089 \u1083 \u1086 \u1084  \u1073 \u1086 \u1083 \u1100 \u1096 \u1077  \u1085 \u1091 \u1083 \u1103 ."\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  \cf11 \strokec11 not\cf4 \strokec4  (\cf12 \strokec12 0\cf4 \strokec4  \cf9 \strokec9 <\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 useful_area_ratio\cf4 \strokec4  \cf9 \strokec9 <=\cf4 \strokec4  \cf12 \strokec12 1\cf4 \strokec4 ):\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf11 \strokec11 False\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1044 \u1086 \u1083 \u1103  \u1087 \u1086 \u1083 \u1077 \u1079 \u1085 \u1086 \u1081  \u1087 \u1083 \u1086 \u1097 \u1072 \u1076 \u1080  \u1076 \u1086 \u1083 \u1078 \u1085 \u1072  \u1073 \u1099 \u1090 \u1100  \u1084 \u1077 \u1078 \u1076 \u1091  0 \u1080  1."\cf4 \cb1 \strokec4 \
\
\cb3     \cf8 \strokec8 total_manual_area\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cb1 \
\cb3         \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 storage_area_manual\cf4 \cb1 \strokec4 \
\cb3         \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 loan_area_manual\cf4 \cb1 \strokec4 \
\cb3         \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 vip_area_manual\cf4 \cb1 \strokec4 \
\cb3         \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 short_term_area_manual\cf4 \cb1 \strokec4 \
\cb3     )\cb1 \
\cb3     \cf8 \strokec8 usable_area\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 total_area\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 useful_area_ratio\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 total_manual_area\cf4 \strokec4  \cf9 \strokec9 <=\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 :\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf11 \strokec11 False\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1057 \u1091 \u1084 \u1084 \u1072  \u1074 \u1088 \u1091 \u1095 \u1085 \u1091 \u1102  \u1074 \u1074 \u1077 \u1076 \u1105 \u1085 \u1085 \u1099 \u1093  \u1087 \u1083 \u1086 \u1097 \u1072 \u1076 \u1077 \u1081  \u1076 \u1086 \u1083 \u1078 \u1085 \u1072  \u1073 \u1099 \u1090 \u1100  > 0."\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 total_manual_area\cf4 \strokec4  \cf9 \strokec9 >\cf4 \strokec4  \cf8 \strokec8 usable_area\cf4 \strokec4 :\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  (\cb1 \
\cb3             \cf11 \strokec11 False\cf4 \strokec4 ,\cb1 \
\cb3             \cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1057 \u1091 \u1084 \u1084 \u1072  \u1074 \u1088 \u1091 \u1095 \u1085 \u1091 \u1102  \u1074 \u1074 \u1077 \u1076 \u1105 \u1085 \u1085 \u1099 \u1093  \u1087 \u1083 \u1086 \u1097 \u1072 \u1076 \u1077 \u1081  (\cf11 \strokec11 \{\cf8 \strokec8 total_manual_area\cf11 \strokec11 :.2f\}\cf10 \strokec10  \uc0\u1084 \'b2) "\cf4 \cb1 \strokec4 \
\cb3             \cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1087 \u1088 \u1077 \u1074 \u1099 \u1096 \u1072 \u1077 \u1090  \u1087 \u1086 \u1083 \u1077 \u1079 \u1085 \u1091 \u1102  \u1087 \u1083 \u1086 \u1097 \u1072 \u1076 \u1100  (\cf11 \strokec11 \{\cf8 \strokec8 usable_area\cf11 \strokec11 :.2f\}\cf10 \strokec10  \uc0\u1084 \'b2)."\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  \cf11 \strokec11 not\cf4 \strokec4  \cf7 \strokec7 isinstance\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 loan_term_days\cf4 \strokec4 , \cf6 \strokec6 int\cf4 \strokec4 ) \cf11 \strokec11 or\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 loan_term_days\cf4 \strokec4  \cf9 \strokec9 <=\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 :\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf11 \strokec11 False\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1057 \u1088 \u1086 \u1082  \u1079 \u1072 \u1081 \u1084 \u1072  \u1076 \u1086 \u1083 \u1078 \u1077 \u1085  \u1073 \u1099 \u1090 \u1100  \u1094 \u1077 \u1083 \u1099 \u1084  \u1095 \u1080 \u1089 \u1083 \u1086 \u1084  \u1073 \u1086 \u1083 \u1100 \u1096 \u1077  0."\cf4 \cb1 \strokec4 \
\
\cb3     \cf8 \strokec8 fill_rates\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  [\cb1 \
\cb3         \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 storage_fill_rate\cf4 \strokec4 ,\cb1 \
\cb3         \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 loan_fill_rate\cf4 \strokec4 ,\cb1 \
\cb3         \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 vip_fill_rate\cf4 \strokec4 ,\cb1 \
\cb3         \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 short_term_fill_rate\cf4 \strokec4 ,\cb1 \
\cb3     ]\cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  \cf7 \strokec7 any\cf4 \strokec4 (\cf8 \strokec8 r\cf4 \strokec4  \cf9 \strokec9 <\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4  \cf5 \strokec5 or\cf4 \strokec4  \cf8 \strokec8 r\cf4 \strokec4  \cf9 \strokec9 >\cf4 \strokec4  \cf12 \strokec12 1\cf4 \strokec4  \cf5 \strokec5 for\cf4 \strokec4  \cf8 \strokec8 r\cf4 \strokec4  \cf5 \strokec5 in\cf4 \strokec4  \cf8 \strokec8 fill_rates\cf4 \strokec4 ):\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf11 \strokec11 False\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1055 \u1088 \u1086 \u1094 \u1077 \u1085 \u1090  \u1079 \u1072 \u1087 \u1086 \u1083 \u1085 \u1077 \u1085 \u1085 \u1086 \u1089 \u1090 \u1080  \u1076 \u1086 \u1083 \u1078 \u1077 \u1085  \u1073 \u1099 \u1090 \u1100  [0..1]."\cf4 \cb1 \strokec4 \
\
\cb3     \cf8 \strokec8 churns\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  [\cb1 \
\cb3         \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 storage_monthly_churn\cf4 \strokec4 ,\cb1 \
\cb3         \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 loan_monthly_churn\cf4 \strokec4 ,\cb1 \
\cb3         \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 vip_monthly_churn\cf4 \strokec4 ,\cb1 \
\cb3         \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 short_term_monthly_churn\cf4 \strokec4 ,\cb1 \
\cb3     ]\cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  \cf7 \strokec7 any\cf4 \strokec4 (\cf8 \strokec8 c\cf4 \strokec4  \cf9 \strokec9 <\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4  \cf5 \strokec5 or\cf4 \strokec4  \cf8 \strokec8 c\cf4 \strokec4  \cf9 \strokec9 >\cf4 \strokec4  \cf12 \strokec12 1\cf4 \strokec4  \cf5 \strokec5 for\cf4 \strokec4  \cf8 \strokec8 c\cf4 \strokec4  \cf5 \strokec5 in\cf4 \strokec4  \cf8 \strokec8 churns\cf4 \strokec4 ):\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf11 \strokec11 False\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1055 \u1088 \u1086 \u1094 \u1077 \u1085 \u1090  \u1086 \u1090 \u1090 \u1086 \u1082 \u1072  \u1076 \u1086 \u1083 \u1078 \u1077 \u1085  \u1073 \u1099 \u1090 \u1100  [0..1]."\cf4 \cb1 \strokec4 \
\
\cb3     \cf5 \strokec5 if\cf4 \strokec4  \cf11 \strokec11 not\cf4 \strokec4  (\cf12 \strokec12 1\cf4 \strokec4  \cf9 \strokec9 <=\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 poly_degree\cf4 \strokec4  \cf9 \strokec9 <=\cf4 \strokec4  \cf12 \strokec12 5\cf4 \strokec4 ):\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf11 \strokec11 False\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1057 \u1090 \u1077 \u1087 \u1077 \u1085 \u1100  \u1087 \u1086 \u1083 \u1080 \u1085 \u1086 \u1084 \u1072  \u1076 \u1086 \u1083 \u1078 \u1085 \u1072  \u1073 \u1099 \u1090 \u1100  \u1094 \u1077 \u1083 \u1099 \u1084  \u1095 \u1080 \u1089 \u1083 \u1086 \u1084  \u1086 \u1090  1 \u1076 \u1086  5."\cf4 \cb1 \strokec4 \
\
\cb3     \cf5 \strokec5 return\cf4 \strokec4  \cf11 \strokec11 True\cf4 \strokec4 , \cf10 \strokec10 ""\cf4 \cb1 \strokec4 \
\pard\pardeftab560\slleading20\partightenfactor0

\f0\fs26 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 \
\
\'b4\'b4\'b4\
\
\uc0\u1060 \u1072 \u1081 \u1083 : ml_models.py\
\
\'b4\'b4\'b4python\
\pard\pardeftab720\partightenfactor0

\f1\fs24 \cf2 \cb3 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 # ml_models.py\cf4 \cb1 \strokec4 \
\
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 numpy\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf6 \strokec6 np\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 from\cf4 \strokec4  \cf6 \strokec6 sklearn\cf4 \strokec4 .\cf6 \strokec6 linear_model\cf4 \strokec4  \cf5 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 LinearRegression\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 from\cf4 \strokec4  \cf6 \strokec6 sklearn\cf4 \strokec4 .\cf6 \strokec6 preprocessing\cf4 \strokec4  \cf5 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 PolynomialFeatures\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 from\cf4 \strokec4  \cf6 \strokec6 sklearn\cf4 \strokec4 .\cf6 \strokec6 pipeline\cf4 \strokec4  \cf5 \strokec5 import\cf4 \strokec4  \cf7 \strokec7 make_pipeline\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 from\cf4 \strokec4  \cf6 \strokec6 sklearn\cf4 \strokec4 .\cf6 \strokec6 ensemble\cf4 \strokec4  \cf5 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 RandomForestRegressor\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 from\cf4 \strokec4  \cf6 \strokec6 sklearn\cf4 \strokec4 .\cf6 \strokec6 model_selection\cf4 \strokec4  \cf5 \strokec5 import\cf4 \strokec4  \cf7 \strokec7 cross_val_score\cf4 \strokec4 , \cf6 \strokec6 KFold\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 logging\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 joblib\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 pandas\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf6 \strokec6 pd\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 streamlit\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf6 \strokec6 st\cf4 \cb1 \strokec4 \
\
\cf6 \cb3 \strokec6 logging\cf4 \strokec4 .\cf7 \strokec7 basicConfig\cf4 \strokec4 (\cf8 \strokec8 level\cf9 \strokec9 =\cf6 \strokec6 logging\cf4 \strokec4 .\cf8 \strokec8 INFO\cf4 \strokec4 , \cf8 \strokec8 format\cf9 \strokec9 =\cf10 \strokec10 "\cf11 \strokec11 %(asctime)s\cf10 \strokec10  - \cf11 \strokec11 %(levelname)s\cf10 \strokec10  - \cf11 \strokec11 %(message)s\cf10 \strokec10 "\cf4 \strokec4 )\cb1 \
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 train_ml_model\cf4 \strokec4 (\cf8 \strokec8 df\cf4 \strokec4 , \cf8 \strokec8 target_column\cf4 \strokec4 , \cf8 \strokec8 model_type\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1051 \u1080 \u1085 \u1077 \u1081 \u1085 \u1072 \u1103  \u1088 \u1077 \u1075 \u1088 \u1077 \u1089 \u1089 \u1080 \u1103 "\cf4 \strokec4 , \cf8 \strokec8 poly_degree\cf9 \strokec9 =\cf12 \strokec12 2\cf4 \strokec4 ):\cb1 \
\cb3     \cf10 \strokec10 """\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     \uc0\u1054 \u1073 \u1091 \u1095 \u1072 \u1077 \u1090  \u1084 \u1086 \u1076 \u1077 \u1083 \u1100  ML (\u1083 \u1080 \u1085 \u1077 \u1081 \u1085 \u1072 \u1103 /\u1087 \u1086 \u1083 \u1080 \u1085 \u1086 \u1084 \u1080 \u1072 \u1083 \u1100 \u1085 \u1072 \u1103  \u1088 \u1077 \u1075 \u1088 \u1077 \u1089 \u1089 \u1080 \u1103  \u1080 \u1083 \u1080  \u1089 \u1083 \u1091 \u1095 \u1072 \u1081 \u1085 \u1099 \u1081  \u1083 \u1077 \u1089 ).\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     """\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 try\cf4 \strokec4 :\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf10 \strokec10 "\uc0\u1052 \u1077 \u1089 \u1103 \u1094 "\cf4 \strokec4  \cf11 \strokec11 not\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 df\cf4 \strokec4 .columns \cf11 \strokec11 or\cf4 \strokec4  \cf8 \strokec8 target_column\cf4 \strokec4  \cf11 \strokec11 not\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 df\cf4 \strokec4 .columns:\cb1 \
\cb3             \cf5 \strokec5 raise\cf4 \strokec4  \cf6 \strokec6 ValueError\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1053 \u1077 \u1090  \u1089 \u1090 \u1086 \u1083 \u1073 \u1094 \u1086 \u1074  '\u1052 \u1077 \u1089 \u1103 \u1094 ' \u1080  \u1094 \u1077 \u1083 \u1077 \u1074 \u1086 \u1081  \u1087 \u1077 \u1088 \u1077 \u1084 \u1077 \u1085 \u1085 \u1086 \u1081 ."\cf4 \strokec4 )\cb1 \
\cb3         \cf13 \strokec13 X\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 df\cf4 \strokec4 [[\cf10 \strokec10 "\uc0\u1052 \u1077 \u1089 \u1103 \u1094 "\cf4 \strokec4 ]].values\cb1 \
\cb3         \cf8 \strokec8 y\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 df\cf4 \strokec4 [\cf8 \strokec8 target_column\cf4 \strokec4 ].values\cb1 \
\
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 model_type\cf4 \strokec4  \cf9 \strokec9 ==\cf4 \strokec4  \cf10 \strokec10 "ML (\uc0\u1083 \u1080 \u1085 \u1077 \u1081 \u1085 \u1072 \u1103  \u1088 \u1077 \u1075 \u1088 \u1077 \u1089 \u1089 \u1080 \u1103 )"\cf4 \strokec4 :\cb1 \
\cb3             \cf8 \strokec8 model\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 LinearRegression\cf4 \strokec4 ()\cb1 \
\cb3         \cf5 \strokec5 elif\cf4 \strokec4  \cf8 \strokec8 model_type\cf4 \strokec4  \cf9 \strokec9 ==\cf4 \strokec4  \cf10 \strokec10 "ML (\uc0\u1087 \u1086 \u1083 \u1080 \u1085 \u1086 \u1084 \u1080 \u1072 \u1083 \u1100 \u1085 \u1072 \u1103  \u1088 \u1077 \u1075 \u1088 \u1077 \u1089 \u1089 \u1080 \u1103 )"\cf4 \strokec4 :\cb1 \
\cb3             \cf8 \strokec8 model\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 make_pipeline\cf4 \strokec4 (\cf6 \strokec6 PolynomialFeatures\cf4 \strokec4 (\cf8 \strokec8 poly_degree\cf4 \strokec4 ), \cf6 \strokec6 LinearRegression\cf4 \strokec4 ())\cb1 \
\cb3         \cf5 \strokec5 elif\cf4 \strokec4  \cf8 \strokec8 model_type\cf4 \strokec4  \cf9 \strokec9 ==\cf4 \strokec4  \cf10 \strokec10 "ML (\uc0\u1089 \u1083 \u1091 \u1095 \u1072 \u1081 \u1085 \u1099 \u1081  \u1083 \u1077 \u1089 )"\cf4 \strokec4 :\cb1 \
\cb3             \cf8 \strokec8 model\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 RandomForestRegressor\cf4 \strokec4 (\cf8 \strokec8 random_state\cf9 \strokec9 =\cf12 \strokec12 42\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 else\cf4 \strokec4 :\cb1 \
\cb3             \cf5 \strokec5 raise\cf4 \strokec4  \cf6 \strokec6 ValueError\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1053 \u1077 \u1087 \u1086 \u1076 \u1076 \u1077 \u1088 \u1078 \u1080 \u1074 \u1072 \u1077 \u1084 \u1099 \u1081  \u1090 \u1080 \u1087  \u1084 \u1086 \u1076 \u1077 \u1083 \u1080 : \cf11 \strokec11 \{\cf8 \strokec8 model_type\cf11 \strokec11 \}\cf10 \strokec10 "\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 model\cf4 \strokec4 .\cf7 \strokec7 fit\cf4 \strokec4 (\cf13 \strokec13 X\cf4 \strokec4 , \cf8 \strokec8 y\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 cv\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 KFold\cf4 \strokec4 (\cf8 \strokec8 n_splits\cf9 \strokec9 =\cf12 \strokec12 5\cf4 \strokec4 , \cf8 \strokec8 shuffle\cf9 \strokec9 =\cf11 \strokec11 True\cf4 \strokec4 , \cf8 \strokec8 random_state\cf9 \strokec9 =\cf12 \strokec12 42\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 scores\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 cross_val_score\cf4 \strokec4 (\cf8 \strokec8 model\cf4 \strokec4 , \cf13 \strokec13 X\cf4 \strokec4 , \cf8 \strokec8 y\cf4 \strokec4 , \cf8 \strokec8 cv\cf9 \strokec9 =\cf8 \strokec8 cv\cf4 \strokec4 , \cf8 \strokec8 scoring\cf9 \strokec9 =\cf10 \strokec10 "neg_mean_squared_error"\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 rmse_scores\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 np\cf4 \strokec4 .\cf8 \strokec8 sqrt\cf4 \strokec4 (\cf7 \strokec7 -\cf8 \strokec8 scores\cf4 \strokec4 )\cb1 \
\cb3         \cf6 \strokec6 logging\cf4 \strokec4 .\cf7 \strokec7 info\cf4 \strokec4 (\cb1 \
\cb3             \cf11 \strokec11 f\cf10 \strokec10 "'\cf11 \strokec11 \{\cf8 \strokec8 model_type\cf11 \strokec11 \}\cf10 \strokec10 ' \uc0\u1086 \u1073 \u1091 \u1095 \u1077 \u1085 \u1072 . \u1057 \u1088 \u1077 \u1076 \u1085 \u1103 \u1103  RMSE: \cf11 \strokec11 \{\cf8 \strokec8 rmse_scores\cf4 \strokec4 .\cf7 \strokec7 mean\cf4 \strokec4 ()\cf11 \strokec11 :.2f\}\cf10 \strokec10 "\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf8 \strokec8 model\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 except\cf4 \strokec4  \cf6 \strokec6 Exception\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf8 \strokec8 e\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 logging\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1054 \u1096 \u1080 \u1073 \u1082 \u1072  \u1087 \u1088 \u1080  \u1086 \u1073 \u1091 \u1095 \u1077 \u1085 \u1080 \u1080  ML-\u1084 \u1086 \u1076 \u1077 \u1083 \u1080 : \cf11 \strokec11 \{\cf8 \strokec8 e\cf11 \strokec11 \}\cf10 \strokec10 "\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 raise\cf4 \cb1 \strokec4 \
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 predict_with_model\cf4 \strokec4 (\cf8 \strokec8 model\cf4 \strokec4 , \cf8 \strokec8 future_months\cf4 \strokec4 ):\cb1 \
\cb3     \cf10 \strokec10 """\uc0\u1044 \u1077 \u1083 \u1072 \u1077 \u1090  \u1087 \u1088 \u1086 \u1075 \u1085 \u1086 \u1079  \u1089  \u1087 \u1086 \u1084 \u1086 \u1097 \u1100 \u1102  \u1086 \u1073 \u1091 \u1095 \u1077 \u1085 \u1085 \u1086 \u1081  \u1084 \u1086 \u1076 \u1077 \u1083 \u1080 ."""\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 try\cf4 \strokec4 :\cb1 \
\cb3         \cf8 \strokec8 X_future\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 np\cf4 \strokec4 .\cf7 \strokec7 array\cf4 \strokec4 (\cf8 \strokec8 future_months\cf4 \strokec4 ).\cf7 \strokec7 reshape\cf4 \strokec4 (\cf9 \strokec9 -\cf12 \strokec12 1\cf4 \strokec4 , \cf12 \strokec12 1\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf8 \strokec8 model\cf4 \strokec4 .predict(\cf8 \strokec8 X_future\cf4 \strokec4 )\cb1 \
\cb3     \cf5 \strokec5 except\cf4 \strokec4  \cf6 \strokec6 Exception\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf8 \strokec8 e\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 logging\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1054 \u1096 \u1080 \u1073 \u1082 \u1072  \u1087 \u1088 \u1080  \u1087 \u1088 \u1086 \u1075 \u1085 \u1086 \u1079 \u1080 \u1088 \u1086 \u1074 \u1072 \u1085 \u1080 \u1080 : \cf11 \strokec11 \{\cf8 \strokec8 e\cf11 \strokec11 \}\cf10 \strokec10 "\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 raise\cf4 \cb1 \strokec4 \
\
\cf7 \cb3 \strokec7 @\cf6 \strokec6 st\cf7 \strokec7 .\cf8 \strokec8 cache_resource\cf4 \cb1 \strokec4 \
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 load_ml_model\cf4 \strokec4 (\cf8 \strokec8 df\cf4 \strokec4 , \cf8 \strokec8 target_column\cf4 \strokec4 , \cf8 \strokec8 model_type\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1051 \u1080 \u1085 \u1077 \u1081 \u1085 \u1072 \u1103  \u1088 \u1077 \u1075 \u1088 \u1077 \u1089 \u1089 \u1080 \u1103 "\cf4 \strokec4 , \cf8 \strokec8 poly_degree\cf9 \strokec9 =\cf12 \strokec12 2\cf4 \strokec4 ):\cb1 \
\cb3     \cf10 \strokec10 """\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     \uc0\u1047 \u1072 \u1075 \u1088 \u1091 \u1078 \u1072 \u1077 \u1090  \u1080 \u1083 \u1080  \u1086 \u1073 \u1091 \u1095 \u1072 \u1077 \u1090  (\u1077 \u1089 \u1083 \u1080  \u1085 \u1077 \u1090  \u1075 \u1086 \u1090 \u1086 \u1074 \u1086 \u1081 ) ML-\u1084 \u1086 \u1076 \u1077 \u1083 \u1100 .\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     """\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 try\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 logging\cf4 \strokec4 .\cf7 \strokec7 info\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1047 \u1072 \u1075 \u1088 \u1091 \u1079 \u1082 \u1072 /\u1086 \u1073 \u1091 \u1095 \u1077 \u1085 \u1080 \u1077  \u1084 \u1086 \u1076 \u1077 \u1083 \u1080 : '\cf11 \strokec11 \{\cf8 \strokec8 model_type\cf11 \strokec11 \}\cf10 \strokec10 '."\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 df\cf4 \strokec4  \cf11 \strokec11 is\cf4 \strokec4  \cf11 \strokec11 not\cf4 \strokec4  \cf11 \strokec11 None\cf4 \strokec4 :\cb1 \
\cb3             \cf5 \strokec5 return\cf4 \strokec4  \cf7 \strokec7 train_ml_model\cf4 \strokec4 (\cf8 \strokec8 df\cf4 \strokec4 , \cf8 \strokec8 target_column\cf4 \strokec4 , \cf8 \strokec8 model_type\cf4 \strokec4 , \cf8 \strokec8 poly_degree\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 else\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 logging\cf4 \strokec4 .\cf7 \strokec7 warning\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1053 \u1077 \u1090  \u1076 \u1072 \u1085 \u1085 \u1099 \u1093  \u1076 \u1083 \u1103  \u1086 \u1073 \u1091 \u1095 \u1077 \u1085 \u1080 \u1103  ML-\u1084 \u1086 \u1076 \u1077 \u1083 \u1080 ."\cf4 \strokec4 )\cb1 \
\cb3             \cf5 \strokec5 return\cf4 \strokec4  \cf11 \strokec11 None\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 except\cf4 \strokec4  \cf6 \strokec6 Exception\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf8 \strokec8 e\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 logging\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1054 \u1096 \u1080 \u1073 \u1082 \u1072  \u1087 \u1088 \u1080  \u1079 \u1072 \u1075 \u1088 \u1091 \u1079 \u1082 \u1077 /\u1086 \u1073 \u1091 \u1095 \u1077 \u1085 \u1080 \u1080 : \cf11 \strokec11 \{\cf8 \strokec8 e\cf11 \strokec11 \}\cf10 \strokec10 "\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf11 \strokec11 None\cf4 \cb1 \strokec4 \
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 save_ml_model\cf4 \strokec4 (\cf8 \strokec8 model\cf4 \strokec4 , \cf8 \strokec8 filepath\cf9 \strokec9 =\cf10 \strokec10 "ml_model.pkl"\cf4 \strokec4 ):\cb1 \
\cb3     \cf10 \strokec10 """\uc0\u1057 \u1086 \u1093 \u1088 \u1072 \u1085 \u1103 \u1077 \u1090  \u1086 \u1073 \u1091 \u1095 \u1077 \u1085 \u1085 \u1091 \u1102  \u1084 \u1086 \u1076 \u1077 \u1083 \u1100  \u1085 \u1072  \u1076 \u1080 \u1089 \u1082 ."""\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 try\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 joblib\cf4 \strokec4 .\cf7 \strokec7 dump\cf4 \strokec4 (\cf8 \strokec8 model\cf4 \strokec4 , \cf8 \strokec8 filepath\cf4 \strokec4 )\cb1 \
\cb3         \cf6 \strokec6 logging\cf4 \strokec4 .\cf7 \strokec7 info\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1052 \u1086 \u1076 \u1077 \u1083 \u1100  \u1089 \u1086 \u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1072  \u1074  \cf11 \strokec11 \{\cf8 \strokec8 filepath\cf11 \strokec11 \}\cf10 \strokec10 ."\cf4 \strokec4 )\cb1 \
\cb3     \cf5 \strokec5 except\cf4 \strokec4  \cf6 \strokec6 Exception\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf8 \strokec8 e\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 logging\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1054 \u1096 \u1080 \u1073 \u1082 \u1072  \u1089 \u1086 \u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1103  \u1084 \u1086 \u1076 \u1077 \u1083 \u1080 : \cf11 \strokec11 \{\cf8 \strokec8 e\cf11 \strokec11 \}\cf10 \strokec10 "\cf4 \strokec4 )\cb1 \
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 prepare_ml_data\cf4 \strokec4 (\cf8 \strokec8 df\cf4 \strokec4 , \cf8 \strokec8 target_column\cf4 \strokec4 ):\cb1 \
\cb3     \cf10 \strokec10 """\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     \uc0\u1044 \u1086 \u1073 \u1072 \u1074 \u1083 \u1103 \u1077 \u1090  \u1087 \u1088 \u1080 \u1079 \u1085 \u1072 \u1082 \u1080  Lag_1, Lag_2, Rolling_Mean_3 \u1080  Rolling_Mean_5.\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     """\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 try\cf4 \strokec4 :\cb1 \
\cb3         \cf8 \strokec8 df\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 df\cf4 \strokec4 .copy()\cb1 \
\cb3         \cf8 \strokec8 avg\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 df\cf4 \strokec4 [\cf8 \strokec8 target_column\cf4 \strokec4 ].mean() \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 target_column\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 df\cf4 \strokec4 .columns \cf5 \strokec5 else\cf4 \strokec4  \cf12 \strokec12 0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 df\cf4 \strokec4 [\cf10 \strokec10 "Lag_1"\cf4 \strokec4 ] \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 df\cf4 \strokec4 [\cf8 \strokec8 target_column\cf4 \strokec4 ].shift(\cf12 \strokec12 1\cf4 \strokec4 ).fillna(\cf8 \strokec8 avg\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 df\cf4 \strokec4 [\cf10 \strokec10 "Lag_2"\cf4 \strokec4 ] \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 df\cf4 \strokec4 [\cf8 \strokec8 target_column\cf4 \strokec4 ].shift(\cf12 \strokec12 2\cf4 \strokec4 ).fillna(\cf8 \strokec8 avg\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 df\cf4 \strokec4 [\cf10 \strokec10 "Rolling_Mean_3"\cf4 \strokec4 ] \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 df\cf4 \strokec4 [\cf8 \strokec8 target_column\cf4 \strokec4 ].rolling(\cf12 \strokec12 3\cf4 \strokec4 , \cf8 \strokec8 min_periods\cf9 \strokec9 =\cf12 \strokec12 1\cf4 \strokec4 ).mean()\cb1 \
\cb3         \cf8 \strokec8 df\cf4 \strokec4 [\cf10 \strokec10 "Rolling_Mean_5"\cf4 \strokec4 ] \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 df\cf4 \strokec4 [\cf8 \strokec8 target_column\cf4 \strokec4 ].rolling(\cf12 \strokec12 5\cf4 \strokec4 , \cf8 \strokec8 min_periods\cf9 \strokec9 =\cf12 \strokec12 1\cf4 \strokec4 ).mean()\cb1 \
\cb3         \cf6 \strokec6 logging\cf4 \strokec4 .\cf7 \strokec7 info\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1044 \u1072 \u1085 \u1085 \u1099 \u1077  \u1076 \u1083 \u1103  ML \u1087 \u1086 \u1076 \u1075 \u1086 \u1090 \u1086 \u1074 \u1083 \u1077 \u1085 \u1099 ."\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf8 \strokec8 df\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 except\cf4 \strokec4  \cf6 \strokec6 Exception\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf8 \strokec8 e\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 logging\cf4 \strokec4 .\cf7 \strokec7 error\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1054 \u1096 \u1080 \u1073 \u1082 \u1072  \u1087 \u1088 \u1080  \u1087 \u1086 \u1076 \u1075 \u1086 \u1090 \u1086 \u1074 \u1082 \u1077  \u1076 \u1072 \u1085 \u1085 \u1099 \u1093  \u1076 \u1083 \u1103  ML: \cf11 \strokec11 \{\cf8 \strokec8 e\cf11 \strokec11 \}\cf10 \strokec10 "\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf8 \strokec8 df\cf4 \cb1 \strokec4 \
\pard\pardeftab560\slleading20\partightenfactor0

\f0\fs26 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 \
\
\'b4\'b4\'b4\
\
\
\uc0\u1060 \u1072 \u1081 \u1083 : utils.py\
\
\'b4\'b4\'b4python\
\pard\pardeftab720\partightenfactor0

\f1\fs24 \cf2 \cb3 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 # utils.py\cf4 \cb1 \strokec4 \
\
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 streamlit\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf6 \strokec6 st\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 pandas\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf6 \strokec6 pd\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 base64\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 io\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 yaml\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 json\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 from\cf4 \strokec4  \cf6 \strokec6 calculations\cf4 \strokec4  \cf5 \strokec5 import\cf4 \strokec4  \cf7 \strokec7 calculate_financials\cf4 \strokec4 , \cf7 \strokec7 calculate_irr\cf4 \cb1 \strokec4 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 generate_download_link\cf4 \strokec4 (\cf8 \strokec8 df\cf4 \strokec4 : \cf6 \strokec6 pd\cf4 \strokec4 .\cf6 \strokec6 DataFrame\cf4 \strokec4 , \cf8 \strokec8 filename\cf9 \strokec9 =\cf10 \strokec10 "results.csv"\cf4 \strokec4 , \cf8 \strokec8 link_text\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1057 \u1082 \u1072 \u1095 \u1072 \u1090 \u1100  CSV"\cf4 \strokec4 ):\cb1 \
\cb3     \cf10 \strokec10 """\uc0\u1057 \u1086 \u1079 \u1076 \u1072 \u1105 \u1090  \u1089 \u1089 \u1099 \u1083 \u1082 \u1091  \u1076 \u1083 \u1103  \u1089 \u1082 \u1072 \u1095 \u1080 \u1074 \u1072 \u1085 \u1080 \u1103  DataFrame \u1074  CSV."""\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 csv_data\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 df\cf4 \strokec4 .\cf7 \strokec7 to_csv\cf4 \strokec4 (\cf8 \strokec8 index\cf9 \strokec9 =\cf11 \strokec11 False\cf4 \strokec4 )\cb1 \
\cb3     \cf8 \strokec8 b64\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 base64\cf4 \strokec4 .\cf7 \strokec7 b64encode\cf4 \strokec4 (\cf8 \strokec8 csv_data\cf4 \strokec4 .\cf7 \strokec7 encode\cf4 \strokec4 ()).\cf7 \strokec7 decode\cf4 \strokec4 ()\cb1 \
\cb3     \cf8 \strokec8 href\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf11 \strokec11 f\cf10 \strokec10 '<a href="data:file/csv;base64,\cf11 \strokec11 \{\cf8 \strokec8 b64\cf11 \strokec11 \}\cf10 \strokec10 " download="\cf11 \strokec11 \{\cf8 \strokec8 filename\cf11 \strokec11 \}\cf10 \strokec10 ">\cf11 \strokec11 \{\cf8 \strokec8 link_text\cf11 \strokec11 \}\cf10 \strokec10 </a>'\cf4 \cb1 \strokec4 \
\cb3     \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 markdown\cf4 \strokec4 (\cf8 \strokec8 href\cf4 \strokec4 , \cf8 \strokec8 unsafe_allow_html\cf9 \strokec9 =\cf11 \strokec11 True\cf4 \strokec4 )\cb1 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 generate_excel_download\cf4 \strokec4 (\cf8 \strokec8 df\cf4 \strokec4 : \cf6 \strokec6 pd\cf4 \strokec4 .\cf6 \strokec6 DataFrame\cf4 \strokec4 , \cf8 \strokec8 filename\cf9 \strokec9 =\cf10 \strokec10 "results.xlsx"\cf4 \strokec4 , \cf8 \strokec8 link_text\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1057 \u1082 \u1072 \u1095 \u1072 \u1090 \u1100  Excel"\cf4 \strokec4 ):\cb1 \
\cb3     \cf10 \strokec10 """\uc0\u1057 \u1086 \u1079 \u1076 \u1072 \u1105 \u1090  \u1089 \u1089 \u1099 \u1083 \u1082 \u1091  \u1076 \u1083 \u1103  \u1089 \u1082 \u1072 \u1095 \u1080 \u1074 \u1072 \u1085 \u1080 \u1103  DataFrame \u1074  Excel."""\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 output\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 io\cf4 \strokec4 .\cf6 \strokec6 BytesIO\cf4 \strokec4 ()\cb1 \
\cb3     \cf5 \strokec5 with\cf4 \strokec4  \cf6 \strokec6 pd\cf4 \strokec4 .\cf6 \strokec6 ExcelWriter\cf4 \strokec4 (\cf8 \strokec8 output\cf4 \strokec4 , \cf8 \strokec8 engine\cf9 \strokec9 =\cf10 \strokec10 "xlsxwriter"\cf4 \strokec4 ) \cf5 \strokec5 as\cf4 \strokec4  \cf8 \strokec8 writer\cf4 \strokec4 :\cb1 \
\cb3         \cf8 \strokec8 df\cf4 \strokec4 .\cf7 \strokec7 to_excel\cf4 \strokec4 (\cf8 \strokec8 writer\cf4 \strokec4 , \cf8 \strokec8 index\cf9 \strokec9 =\cf11 \strokec11 False\cf4 \strokec4 , \cf8 \strokec8 sheet_name\cf9 \strokec9 =\cf10 \strokec10 "Results"\cf4 \strokec4 )\cb1 \
\cb3     \cf8 \strokec8 excel_data\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 output\cf4 \strokec4 .\cf7 \strokec7 getvalue\cf4 \strokec4 ()\cb1 \
\cb3     \cf8 \strokec8 b64\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 base64\cf4 \strokec4 .\cf7 \strokec7 b64encode\cf4 \strokec4 (\cf8 \strokec8 excel_data\cf4 \strokec4 ).\cf7 \strokec7 decode\cf4 \strokec4 ()\cb1 \
\cb3     \cf8 \strokec8 href\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf11 \strokec11 f\cf10 \strokec10 '<a href="data:application/octet-stream;base64,\cf11 \strokec11 \{\cf8 \strokec8 b64\cf11 \strokec11 \}\cf10 \strokec10 " download="\cf11 \strokec11 \{\cf8 \strokec8 filename\cf11 \strokec11 \}\cf10 \strokec10 ">\cf11 \strokec11 \{\cf8 \strokec8 link_text\cf11 \strokec11 \}\cf10 \strokec10 </a>'\cf4 \cb1 \strokec4 \
\cb3     \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 markdown\cf4 \strokec4 (\cf8 \strokec8 href\cf4 \strokec4 , \cf8 \strokec8 unsafe_allow_html\cf9 \strokec9 =\cf11 \strokec11 True\cf4 \strokec4 )\cb1 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 normalize_shares\cf4 \strokec4 (\cf8 \strokec8 changed_share_key\cf4 \strokec4 , \cf8 \strokec8 new_value\cf4 \strokec4 , \cf8 \strokec8 old_shares\cf9 \strokec9 =\cf11 \strokec11 None\cf4 \strokec4 ):\cb1 \
\cb3     \cf10 \strokec10 """\uc0\u1053 \u1086 \u1088 \u1084 \u1072 \u1083 \u1080 \u1079 \u1091 \u1077 \u1090  \u1076 \u1086 \u1083 \u1080  \u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1103 , \u1095 \u1090 \u1086 \u1073 \u1099  \u1080 \u1093  \u1089 \u1091 \u1084 \u1084 \u1072  \u1086 \u1089 \u1090 \u1072 \u1074 \u1072 \u1083 \u1072 \u1089 \u1100  \u1082 \u1086 \u1088 \u1088 \u1077 \u1082 \u1090 \u1085 \u1086 \u1081 ."""\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 old_shares\cf4 \strokec4  \cf11 \strokec11 is\cf4 \strokec4  \cf11 \strokec11 None\cf4 \strokec4 :\cb1 \
\cb3         \cf8 \strokec8 old_shares\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 session_state\cf4 \strokec4 .shares.copy()\cb1 \
\cb3     \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 session_state\cf4 \strokec4 .shares[\cf8 \strokec8 changed_share_key\cf4 \strokec4 ] \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 new_value\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 other_keys\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  [\cf8 \strokec8 k\cf4 \strokec4  \cf5 \strokec5 for\cf4 \strokec4  \cf8 \strokec8 k\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 session_state\cf4 \strokec4 .shares \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 k\cf4 \strokec4  \cf9 \strokec9 !=\cf4 \strokec4  \cf8 \strokec8 changed_share_key\cf4 \strokec4 ]\cb1 \
\cb3     \cf8 \strokec8 total_other\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 sum\cf4 \strokec4 (\cf8 \strokec8 old_shares\cf4 \strokec4 [\cf8 \strokec8 k\cf4 \strokec4 ] \cf5 \strokec5 for\cf4 \strokec4  \cf8 \strokec8 k\cf4 \strokec4  \cf5 \strokec5 in\cf4 \strokec4  \cf8 \strokec8 other_keys\cf4 \strokec4 )\cb1 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 total_other\cf4 \strokec4  \cf9 \strokec9 >\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 :\cb1 \
\cb3         \cf5 \strokec5 for\cf4 \strokec4  \cf8 \strokec8 k\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 other_keys\cf4 \strokec4 :\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 session_state\cf4 \strokec4 .shares[\cf8 \strokec8 k\cf4 \strokec4 ] \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 max\cf4 \strokec4 (\cb1 \
\cb3                 \cf12 \strokec12 0\cf4 \strokec4 , \cf8 \strokec8 old_shares\cf4 \strokec4 [\cf8 \strokec8 k\cf4 \strokec4 ] \cf9 \strokec9 -\cf4 \strokec4  (\cf12 \strokec12 1\cf4 \strokec4  \cf9 \strokec9 -\cf4 \strokec4  \cf8 \strokec8 new_value\cf4 \strokec4 ) \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 old_shares\cf4 \strokec4 [\cf8 \strokec8 k\cf4 \strokec4 ] \cf9 \strokec9 /\cf4 \strokec4  \cf8 \strokec8 total_other\cf4 \cb1 \strokec4 \
\cb3             )\cb1 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 perform_sensitivity_analysis\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 param_key\cf4 \strokec4 , \cf8 \strokec8 param_values\cf4 \strokec4 , \cf8 \strokec8 disable_extended\cf4 \strokec4 ):\cb1 \
\cb3     \cf10 \strokec10 """\uc0\u1055 \u1088 \u1086 \u1074 \u1086 \u1076 \u1080 \u1090  \u1072 \u1085 \u1072 \u1083 \u1080 \u1079  \u1095 \u1091 \u1074 \u1089 \u1090 \u1074 \u1080 \u1090 \u1077 \u1083 \u1100 \u1085 \u1086 \u1089 \u1090 \u1080  \u1087 \u1086  \u1079 \u1072 \u1076 \u1072 \u1085 \u1085 \u1086 \u1084 \u1091  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1091 ."""\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 base_val\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 getattr\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 param_key\cf4 \strokec4 )\cb1 \
\cb3     \cf8 \strokec8 results\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  []\cb1 \
\cb3     \cf5 \strokec5 for\cf4 \strokec4  \cf8 \strokec8 val\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 param_values\cf4 \strokec4 :\cb1 \
\cb3         \cf7 \strokec7 setattr\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 param_key\cf4 \strokec4 , \cf8 \strokec8 val\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 fin\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_financials\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 disable_extended\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 results\cf4 \strokec4 .\cf7 \strokec7 append\cf4 \strokec4 (\{\cf10 \strokec10 "\uc0\u1055 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 "\cf4 \strokec4 : \cf8 \strokec8 val\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1055 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100  (\u1088 \u1091 \u1073 .)"\cf4 \strokec4 : \cf8 \strokec8 fin\cf4 \strokec4 [\cf10 \strokec10 "profit"\cf4 \strokec4 ]\})\cb1 \
\cb3     \cf7 \strokec7 setattr\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 param_key\cf4 \strokec4 , \cf8 \strokec8 base_val\cf4 \strokec4 )\cb1 \
\cb3     \cf5 \strokec5 return\cf4 \strokec4  \cf6 \strokec6 pd\cf4 \strokec4 .\cf6 \strokec6 DataFrame\cf4 \strokec4 (\cf8 \strokec8 results\cf4 \strokec4 )\cb1 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 safe_display_irr\cf4 \strokec4 (\cf8 \strokec8 irr_value\cf4 \strokec4 ):\cb1 \
\cb3     \cf10 \strokec10 """\uc0\u1041 \u1077 \u1079 \u1086 \u1087 \u1072 \u1089 \u1085 \u1086 \u1077  \u1086 \u1090 \u1086 \u1073 \u1088 \u1072 \u1078 \u1077 \u1085 \u1080 \u1077  IRR \u1074  \u1080 \u1085 \u1090 \u1077 \u1088 \u1092 \u1077 \u1081 \u1089 \u1077 ."""\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 irr_value\cf4 \strokec4  \cf11 \strokec11 is\cf4 \strokec4  \cf11 \strokec11 None\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 metric\cf4 \strokec4 (\cf10 \strokec10 "IRR (%)"\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1053 \u1077 \u1074 \u1086 \u1079 \u1084 \u1086 \u1078 \u1085 \u1086  \u1088 \u1072 \u1089 \u1089 \u1095 \u1080 \u1090 \u1072 \u1090 \u1100 "\cf4 \strokec4 )\cb1 \
\cb3     \cf5 \strokec5 else\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 metric\cf4 \strokec4 (\cf10 \strokec10 "IRR (%)"\cf4 \strokec4 , \cf11 \strokec11 f\cf10 \strokec10 "\cf11 \strokec11 \{\cf8 \strokec8 irr_value\cf11 \strokec11 :.2f\}\cf10 \strokec10 %"\cf4 \strokec4 )\cb1 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 load_params_from_file\cf4 \strokec4 (\cf8 \strokec8 file_path\cf4 \strokec4 ):\cb1 \
\cb3     \cf10 \strokec10 """\uc0\u1047 \u1072 \u1075 \u1088 \u1091 \u1078 \u1072 \u1077 \u1090  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1099  \u1080 \u1079  YAML \u1080 \u1083 \u1080  JSON."""\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 try\cf4 \strokec4 :\cb1 \
\cb3         \cf5 \strokec5 with\cf4 \strokec4  \cf7 \strokec7 open\cf4 \strokec4 (\cf8 \strokec8 file_path\cf4 \strokec4 , \cf10 \strokec10 "r"\cf4 \strokec4 ) \cf5 \strokec5 as\cf4 \strokec4  \cf8 \strokec8 file\cf4 \strokec4 :\cb1 \
\cb3             \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 file_path\cf4 \strokec4 .endswith((\cf10 \strokec10 ".yaml"\cf4 \strokec4 , \cf10 \strokec10 ".yml"\cf4 \strokec4 )):\cb1 \
\cb3                 \cf5 \strokec5 return\cf4 \strokec4  \cf6 \strokec6 yaml\cf4 \strokec4 .\cf7 \strokec7 safe_load\cf4 \strokec4 (\cf8 \strokec8 file\cf4 \strokec4 )\cb1 \
\cb3             \cf5 \strokec5 elif\cf4 \strokec4  \cf8 \strokec8 file_path\cf4 \strokec4 .endswith(\cf10 \strokec10 ".json"\cf4 \strokec4 ):\cb1 \
\cb3                 \cf5 \strokec5 return\cf4 \strokec4  \cf6 \strokec6 json\cf4 \strokec4 .\cf7 \strokec7 load\cf4 \strokec4 (\cf8 \strokec8 file\cf4 \strokec4 )\cb1 \
\cb3             \cf5 \strokec5 else\cf4 \strokec4 :\cb1 \
\cb3                 \cf5 \strokec5 raise\cf4 \strokec4  \cf6 \strokec6 ValueError\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1053 \u1077 \u1087 \u1086 \u1076 \u1076 \u1077 \u1088 \u1078 \u1080 \u1074 \u1072 \u1077 \u1084 \u1099 \u1081  \u1092 \u1086 \u1088 \u1084 \u1072 \u1090  \u1092 \u1072 \u1081 \u1083 \u1072 "\cf4 \strokec4 )\cb1 \
\cb3     \cf5 \strokec5 except\cf4 \strokec4  \cf6 \strokec6 Exception\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf8 \strokec8 e\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 error\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1054 \u1096 \u1080 \u1073 \u1082 \u1072  \u1087 \u1088 \u1080  \u1079 \u1072 \u1075 \u1088 \u1091 \u1079 \u1082 \u1077  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1086 \u1074 : \cf11 \strokec11 \{\cf8 \strokec8 e\cf11 \strokec11 \}\cf10 \strokec10 "\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf11 \strokec11 None\cf4 \cb1 \strokec4 \
\
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 save_params_to_file\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 filename\cf4 \strokec4 , \cf8 \strokec8 file_format\cf4 \strokec4 ):\cb1 \
\cb3     \cf10 \strokec10 """\uc0\u1057 \u1086 \u1093 \u1088 \u1072 \u1085 \u1103 \u1077 \u1090  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1099  \u1074  \u1092 \u1072 \u1081 \u1083  (JSON \u1080 \u1083 \u1080  YAML)."""\cf4 \cb1 \strokec4 \
\cb3     \cf5 \strokec5 try\cf4 \strokec4 :\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 file_format\cf4 \strokec4  \cf9 \strokec9 ==\cf4 \strokec4  \cf10 \strokec10 "json"\cf4 \strokec4 :\cb1 \
\cb3             \cf5 \strokec5 return\cf4 \strokec4  \cf6 \strokec6 json\cf4 \strokec4 .\cf7 \strokec7 dumps\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 indent\cf9 \strokec9 =\cf12 \strokec12 4\cf4 \strokec4 , \cf8 \strokec8 ensure_ascii\cf9 \strokec9 =\cf11 \strokec11 False\cf4 \strokec4 ).\cf7 \strokec7 encode\cf4 \strokec4 (\cf10 \strokec10 "utf-8"\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 elif\cf4 \strokec4  \cf8 \strokec8 file_format\cf4 \strokec4  \cf9 \strokec9 ==\cf4 \strokec4  \cf10 \strokec10 "yaml"\cf4 \strokec4 :\cb1 \
\cb3             \cf5 \strokec5 return\cf4 \strokec4  \cf6 \strokec6 yaml\cf4 \strokec4 .\cf7 \strokec7 dump\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 indent\cf9 \strokec9 =\cf12 \strokec12 4\cf4 \strokec4 , \cf8 \strokec8 sort_keys\cf9 \strokec9 =\cf11 \strokec11 False\cf4 \strokec4 , \cf8 \strokec8 allow_unicode\cf9 \strokec9 =\cf11 \strokec11 True\cf4 \strokec4 ).\cf7 \strokec7 encode\cf4 \strokec4 (\cf10 \strokec10 "utf-8"\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 else\cf4 \strokec4 :\cb1 \
\cb3             \cf5 \strokec5 raise\cf4 \strokec4  \cf6 \strokec6 ValueError\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1053 \u1077 \u1087 \u1086 \u1076 \u1076 \u1077 \u1088 \u1078 \u1080 \u1074 \u1072 \u1077 \u1084 \u1099 \u1081  \u1092 \u1086 \u1088 \u1084 \u1072 \u1090  \u1092 \u1072 \u1081 \u1083 \u1072 "\cf4 \strokec4 )\cb1 \
\cb3     \cf5 \strokec5 except\cf4 \strokec4  \cf6 \strokec6 Exception\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf8 \strokec8 e\cf4 \strokec4 :\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 error\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "\uc0\u1054 \u1096 \u1080 \u1073 \u1082 \u1072  \u1087 \u1088 \u1080  \u1089 \u1086 \u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1080  \u1087 \u1072 \u1088 \u1072 \u1084 \u1077 \u1090 \u1088 \u1086 \u1074 : \cf11 \strokec11 \{\cf8 \strokec8 e\cf11 \strokec11 \}\cf10 \strokec10 "\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf11 \strokec11 None\cf4 \cb1 \strokec4 \
\pard\pardeftab560\slleading20\partightenfactor0

\f0\fs26 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 \
\
\'b4\'b4\'b4\
\
\
\
\uc0\u1060 \u1072 \u1081 \u1083 : test_calculations.py\
\
\'b4\'b4\'b4python\
\pard\pardeftab720\partightenfactor0

\f1\fs24 \cf2 \cb3 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 # test_calculations.py\cf4 \cb1 \strokec4 \
\
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 unittest\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 numpy\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf6 \strokec6 np\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 numpy_financial\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf6 \strokec6 npf\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 pandas\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf6 \strokec6 pd\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 from\cf4 \strokec4  \cf6 \strokec6 calculations\cf4 \strokec4  \cf5 \strokec5 import\cf4 \strokec4  (\cb1 \
\cb3     \cf7 \strokec7 calculate_items\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 calculate_total_bep\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 calculate_financials\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 calculate_areas\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 calculate_irr\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 calculate_monthly_bep\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 calculate_additional_metrics\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 calculate_roi\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 monte_carlo_simulation\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 min_loan_amount_for_bep\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 calculate_monthly_projection\cf4 \strokec4 ,  \cf2 \strokec2 # \uc0\u1045 \u1089 \u1083 \u1080  \u1091  \u1074 \u1072 \u1089  \u1077 \u1089 \u1090 \u1100  \u1085 \u1086 \u1074 \u1072 \u1103  \u1092 \u1091 \u1085 \u1082 \u1094 \u1080 \u1103 \cf4 \cb1 \strokec4 \
\cb3 )\cb1 \
\cf5 \cb3 \strokec5 from\cf4 \strokec4  \cf6 \strokec6 data_model\cf4 \strokec4  \cf5 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 WarehouseParams\cf4 \cb1 \strokec4 \
\
\
\cf11 \cb3 \strokec11 class\cf4 \strokec4  \cf6 \strokec6 TestCalculations\cf4 \strokec4 (\cf6 \strokec6 unittest\cf4 \strokec4 .\cf6 \strokec6 TestCase\cf4 \strokec4 ):\cb1 \
\
\cb3     \cf11 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 test_calculate_items\cf4 \strokec4 (\cf8 \strokec8 self\cf4 \strokec4 ):\cb1 \
\cb3         \cf10 \strokec10 """\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         \uc0\u1055 \u1088 \u1086 \u1074 \u1077 \u1088 \u1103 \u1077 \u1084  \u1073 \u1072 \u1079 \u1086 \u1074 \u1091 \u1102  \u1092 \u1091 \u1085 \u1082 \u1094 \u1080 \u1102  calculate_items(area, shelves, density, fill_rate).\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         """\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertEqual\cf4 \strokec4 (\cf7 \strokec7 calculate_items\cf4 \strokec4 (\cf12 \strokec12 10\cf4 \strokec4 , \cf12 \strokec12 3\cf4 \strokec4 , \cf12 \strokec12 5\cf4 \strokec4 , \cf12 \strokec12 1\cf4 \strokec4 ), \cf12 \strokec12 150\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertEqual\cf4 \strokec4 (\cf7 \strokec7 calculate_items\cf4 \strokec4 (\cf12 \strokec12 0\cf4 \strokec4 , \cf12 \strokec12 3\cf4 \strokec4 , \cf12 \strokec12 5\cf4 \strokec4 , \cf12 \strokec12 1\cf4 \strokec4 ), \cf12 \strokec12 0\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertEqual\cf4 \strokec4 (\cf7 \strokec7 calculate_items\cf4 \strokec4 (\cf12 \strokec12 10\cf4 \strokec4 , \cf12 \strokec12 0\cf4 \strokec4 , \cf12 \strokec12 5\cf4 \strokec4 , \cf12 \strokec12 1\cf4 \strokec4 ), \cf12 \strokec12 0\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertEqual\cf4 \strokec4 (\cf7 \strokec7 calculate_items\cf4 \strokec4 (\cf12 \strokec12 10\cf4 \strokec4 , \cf12 \strokec12 3\cf4 \strokec4 , \cf12 \strokec12 0\cf4 \strokec4 , \cf12 \strokec12 1\cf4 \strokec4 ), \cf12 \strokec12 0\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertEqual\cf4 \strokec4 (\cf7 \strokec7 calculate_items\cf4 \strokec4 (\cf12 \strokec12 10\cf4 \strokec4 , \cf12 \strokec12 3\cf4 \strokec4 , \cf12 \strokec12 5\cf4 \strokec4 , \cf12 \strokec12 0.5\cf4 \strokec4 ), \cf12 \strokec12 75\cf4 \strokec4 )\cb1 \
\
\cb3     \cf11 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 test_calculate_total_bep\cf4 \strokec4 (\cf8 \strokec8 self\cf4 \strokec4 ):\cb1 \
\cb3         \cf10 \strokec10 """\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         \uc0\u1055 \u1088 \u1086 \u1074 \u1077 \u1088 \u1103 \u1077 \u1084  \u1092 \u1091 \u1085 \u1082 \u1094 \u1080 \u1102  calculate_total_bep: \cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         BEP = total_expenses + (one_time_expenses / time_horizon).\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         """\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 params\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 WarehouseParams\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 total_area\cf9 \strokec9 =\cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 rental_cost_per_m2\cf9 \strokec9 =\cf12 \strokec12 10\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 useful_area_ratio\cf9 \strokec9 =\cf12 \strokec12 0.5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 mode\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1056 \u1091 \u1095 \u1085 \u1086 \u1081 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_share\cf9 \strokec9 =\cf12 \strokec12 0.25\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_share\cf9 \strokec9 =\cf12 \strokec12 0.25\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_share\cf9 \strokec9 =\cf12 \strokec12 0.25\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_share\cf9 \strokec9 =\cf12 \strokec12 0.25\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_area_manual\cf9 \strokec9 =\cf12 \strokec12 10.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_area_manual\cf9 \strokec9 =\cf12 \strokec12 10.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_area_manual\cf9 \strokec9 =\cf12 \strokec12 10.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_area_manual\cf9 \strokec9 =\cf12 \strokec12 10.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_fee\cf9 \strokec9 =\cf12 \strokec12 15\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 shelves_per_m2\cf9 \strokec9 =\cf12 \strokec12 3\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_daily_rate\cf9 \strokec9 =\cf12 \strokec12 6\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_extra_fee\cf9 \strokec9 =\cf12 \strokec12 10\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 item_evaluation\cf9 \strokec9 =\cf12 \strokec12 0.8\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 item_realization_markup\cf9 \strokec9 =\cf12 \strokec12 20.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 average_item_value\cf9 \strokec9 =\cf12 \strokec12 15000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_interest_rate\cf9 \strokec9 =\cf12 \strokec12 0.317\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_term_days\cf9 \strokec9 =\cf12 \strokec12 30\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 realization_share_storage\cf9 \strokec9 =\cf12 \strokec12 0.5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 realization_share_loan\cf9 \strokec9 =\cf12 \strokec12 0.5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 realization_share_vip\cf9 \strokec9 =\cf12 \strokec12 0.5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 realization_share_short_term\cf9 \strokec9 =\cf12 \strokec12 0.5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_items_density\cf9 \strokec9 =\cf12 \strokec12 5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_items_density\cf9 \strokec9 =\cf12 \strokec12 1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_items_density\cf9 \strokec9 =\cf12 \strokec12 2\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_items_density\cf9 \strokec9 =\cf12 \strokec12 4\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_fill_rate\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_fill_rate\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_fill_rate\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_fill_rate\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_monthly_churn\cf9 \strokec9 =\cf12 \strokec12 0.01\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_monthly_churn\cf9 \strokec9 =\cf12 \strokec12 0.02\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_monthly_churn\cf9 \strokec9 =\cf12 \strokec12 0.005\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_monthly_churn\cf9 \strokec9 =\cf12 \strokec12 0.03\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 salary_expense\cf9 \strokec9 =\cf12 \strokec12 240000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 miscellaneous_expenses\cf9 \strokec9 =\cf12 \strokec12 50000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 depreciation_expense\cf9 \strokec9 =\cf12 \strokec12 20000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 marketing_expenses\cf9 \strokec9 =\cf12 \strokec12 30000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 insurance_expenses\cf9 \strokec9 =\cf12 \strokec12 10000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 taxes\cf9 \strokec9 =\cf12 \strokec12 50000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 utilities_expenses\cf9 \strokec9 =\cf12 \strokec12 20000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 maintenance_expenses\cf9 \strokec9 =\cf12 \strokec12 15000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_setup_cost\cf9 \strokec9 =\cf12 \strokec12 100000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_equipment_cost\cf9 \strokec9 =\cf12 \strokec12 200000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_other_costs\cf9 \strokec9 =\cf12 \strokec12 50000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_legal_cost\cf9 \strokec9 =\cf12 \strokec12 20000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_logistics_cost\cf9 \strokec9 =\cf12 \strokec12 30000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 time_horizon\cf9 \strokec9 =\cf12 \strokec12 6\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_rent_growth\cf9 \strokec9 =\cf12 \strokec12 0.01\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 default_probability\cf9 \strokec9 =\cf12 \strokec12 0.05\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 liquidity_factor\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 safety_factor\cf9 \strokec9 =\cf12 \strokec12 1.2\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_grace_period\cf9 \strokec9 =\cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_income_growth\cf9 \strokec9 =\cf12 \strokec12 0.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_expenses_growth\cf9 \strokec9 =\cf12 \strokec12 0.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 forecast_method\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1041 \u1072 \u1079 \u1086 \u1074 \u1099 \u1081 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monte_carlo_simulations\cf9 \strokec9 =\cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monte_carlo_deviation\cf9 \strokec9 =\cf12 \strokec12 0.1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monte_carlo_seed\cf9 \strokec9 =\cf12 \strokec12 42\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 enable_ml_settings\cf9 \strokec9 =\cf11 \strokec11 False\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 electricity_cost_per_m2\cf9 \strokec9 =\cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_inflation_rate\cf9 \strokec9 =\cf12 \strokec12 0.005\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_salary_growth\cf9 \strokec9 =\cf12 \strokec12 0.005\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_other_expenses_growth\cf9 \strokec9 =\cf12 \strokec12 0.005\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 poly_degree\cf9 \strokec9 =\cf12 \strokec12 2\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf2 \strokec2 # \uc0\u1057 \u1095 \u1080 \u1090 \u1072 \u1077 \u1084  \u1080  \u1091 \u1089 \u1090 \u1072 \u1085 \u1072 \u1074 \u1083 \u1080 \u1074 \u1072 \u1077 \u1084  \u1087 \u1083 \u1086 \u1097 \u1072 \u1076 \u1080 \cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 areas\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_areas\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 for\cf4 \strokec4  \cf8 \strokec8 k\cf4 \strokec4 , \cf8 \strokec8 v\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 areas\cf4 \strokec4 .\cf7 \strokec7 items\cf4 \strokec4 ():\cb1 \
\cb3             \cf7 \strokec7 setattr\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 k\cf4 \strokec4 , \cf8 \strokec8 v\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 financials\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_financials\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 disable_extended\cf9 \strokec9 =\cf11 \strokec11 False\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 bep\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_total_bep\cf4 \strokec4 (\cf8 \strokec8 financials\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 expected_bep\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 financials\cf4 \strokec4 [\cf10 \strokec10 "total_expenses"\cf4 \strokec4 ] \cf9 \strokec9 +\cf4 \strokec4  (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 one_time_expenses\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 time_horizon\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertAlmostEqual\cf4 \strokec4 (\cf8 \strokec8 bep\cf4 \strokec4 , \cf8 \strokec8 expected_bep\cf4 \strokec4 , \cf8 \strokec8 places\cf9 \strokec9 =\cf12 \strokec12 2\cf4 \strokec4 )\cb1 \
\
\cb3     \cf11 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 test_validate_inputs\cf4 \strokec4 (\cf8 \strokec8 self\cf4 \strokec4 ):\cb1 \
\cb3         \cf10 \strokec10 """\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         \uc0\u1055 \u1088 \u1086 \u1074 \u1077 \u1088 \u1103 \u1077 \u1084  \u1074 \u1072 \u1083 \u1080 \u1076 \u1072 \u1094 \u1080 \u1102  \u1074 \u1093 \u1086 \u1076 \u1085 \u1099 \u1093  \u1076 \u1072 \u1085 \u1085 \u1099 \u1093  validate_inputs(params).\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         """\cf4 \cb1 \strokec4 \
\cb3         \cf5 \strokec5 from\cf4 \strokec4  \cf6 \strokec6 data_model\cf4 \strokec4  \cf5 \strokec5 import\cf4 \strokec4  \cf7 \strokec7 validate_inputs\cf4 \cb1 \strokec4 \
\
\cb3         \cf8 \strokec8 params\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 WarehouseParams\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 total_area\cf9 \strokec9 =\cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 rental_cost_per_m2\cf9 \strokec9 =\cf12 \strokec12 10\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 useful_area_ratio\cf9 \strokec9 =\cf12 \strokec12 0.5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 mode\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1056 \u1091 \u1095 \u1085 \u1086 \u1081 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_share\cf9 \strokec9 =\cf12 \strokec12 0.25\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_share\cf9 \strokec9 =\cf12 \strokec12 0.25\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_share\cf9 \strokec9 =\cf12 \strokec12 0.25\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_share\cf9 \strokec9 =\cf12 \strokec12 0.25\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_area_manual\cf9 \strokec9 =\cf12 \strokec12 10.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_area_manual\cf9 \strokec9 =\cf12 \strokec12 10.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_area_manual\cf9 \strokec9 =\cf12 \strokec12 10.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_area_manual\cf9 \strokec9 =\cf12 \strokec12 10.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_fee\cf9 \strokec9 =\cf12 \strokec12 15\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 shelves_per_m2\cf9 \strokec9 =\cf12 \strokec12 3\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_daily_rate\cf9 \strokec9 =\cf12 \strokec12 6\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_extra_fee\cf9 \strokec9 =\cf12 \strokec12 10\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 item_evaluation\cf9 \strokec9 =\cf12 \strokec12 0.8\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 item_realization_markup\cf9 \strokec9 =\cf12 \strokec12 20.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 average_item_value\cf9 \strokec9 =\cf12 \strokec12 15000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_interest_rate\cf9 \strokec9 =\cf12 \strokec12 0.317\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_term_days\cf9 \strokec9 =\cf12 \strokec12 30\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 realization_share_storage\cf9 \strokec9 =\cf12 \strokec12 0.5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 realization_share_loan\cf9 \strokec9 =\cf12 \strokec12 0.5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 realization_share_vip\cf9 \strokec9 =\cf12 \strokec12 0.5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 realization_share_short_term\cf9 \strokec9 =\cf12 \strokec12 0.5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_items_density\cf9 \strokec9 =\cf12 \strokec12 5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_items_density\cf9 \strokec9 =\cf12 \strokec12 1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_items_density\cf9 \strokec9 =\cf12 \strokec12 2\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_items_density\cf9 \strokec9 =\cf12 \strokec12 4\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_fill_rate\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_fill_rate\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_fill_rate\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_fill_rate\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_monthly_churn\cf9 \strokec9 =\cf12 \strokec12 0.01\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_monthly_churn\cf9 \strokec9 =\cf12 \strokec12 0.02\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_monthly_churn\cf9 \strokec9 =\cf12 \strokec12 0.005\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_monthly_churn\cf9 \strokec9 =\cf12 \strokec12 0.03\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 salary_expense\cf9 \strokec9 =\cf12 \strokec12 240000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 miscellaneous_expenses\cf9 \strokec9 =\cf12 \strokec12 50000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 depreciation_expense\cf9 \strokec9 =\cf12 \strokec12 20000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 marketing_expenses\cf9 \strokec9 =\cf12 \strokec12 30000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 insurance_expenses\cf9 \strokec9 =\cf12 \strokec12 10000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 taxes\cf9 \strokec9 =\cf12 \strokec12 50000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 utilities_expenses\cf9 \strokec9 =\cf12 \strokec12 20000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 maintenance_expenses\cf9 \strokec9 =\cf12 \strokec12 15000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_setup_cost\cf9 \strokec9 =\cf12 \strokec12 100000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_equipment_cost\cf9 \strokec9 =\cf12 \strokec12 200000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_other_costs\cf9 \strokec9 =\cf12 \strokec12 50000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_legal_cost\cf9 \strokec9 =\cf12 \strokec12 20000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_logistics_cost\cf9 \strokec9 =\cf12 \strokec12 30000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 time_horizon\cf9 \strokec9 =\cf12 \strokec12 6\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_rent_growth\cf9 \strokec9 =\cf12 \strokec12 0.01\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 default_probability\cf9 \strokec9 =\cf12 \strokec12 0.05\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 liquidity_factor\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 safety_factor\cf9 \strokec9 =\cf12 \strokec12 1.2\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_grace_period\cf9 \strokec9 =\cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_income_growth\cf9 \strokec9 =\cf12 \strokec12 0.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_expenses_growth\cf9 \strokec9 =\cf12 \strokec12 0.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 forecast_method\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1041 \u1072 \u1079 \u1086 \u1074 \u1099 \u1081 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monte_carlo_simulations\cf9 \strokec9 =\cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monte_carlo_deviation\cf9 \strokec9 =\cf12 \strokec12 0.1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monte_carlo_seed\cf9 \strokec9 =\cf12 \strokec12 42\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 enable_ml_settings\cf9 \strokec9 =\cf11 \strokec11 False\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 electricity_cost_per_m2\cf9 \strokec9 =\cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_inflation_rate\cf9 \strokec9 =\cf12 \strokec12 0.005\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_salary_growth\cf9 \strokec9 =\cf12 \strokec12 0.005\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_other_expenses_growth\cf9 \strokec9 =\cf12 \strokec12 0.005\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 poly_degree\cf9 \strokec9 =\cf12 \strokec12 2\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\
\cb3         \cf2 \strokec2 # \uc0\u1044 \u1086 \u1083 \u1078 \u1085 \u1086  \u1073 \u1099 \u1090 \u1100  \u1074 \u1072 \u1083 \u1080 \u1076 \u1085 \u1086 \cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 is_valid\cf4 \strokec4 , \cf8 \strokec8 error_message\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 validate_inputs\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertTrue\cf4 \strokec4 (\cf8 \strokec8 is_valid\cf4 \strokec4 )\cb1 \
\
\cb3         \cf2 \strokec2 # \uc0\u1054 \u1090 \u1088 \u1080 \u1094 \u1072 \u1090 \u1077 \u1083 \u1100 \u1085 \u1072 \u1103  \u1087 \u1083 \u1086 \u1097 \u1072 \u1076 \u1100 \cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 total_area\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf9 \strokec9 -\cf12 \strokec12 10\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 is_valid\cf4 \strokec4 , \cf8 \strokec8 error_message\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 validate_inputs\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertFalse\cf4 \strokec4 (\cf8 \strokec8 is_valid\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertEqual\cf4 \strokec4 (\cf8 \strokec8 error_message\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1054 \u1073 \u1097 \u1072 \u1103  \u1087 \u1083 \u1086 \u1097 \u1072 \u1076 \u1100  \u1076 \u1086 \u1083 \u1078 \u1085 \u1072  \u1073 \u1099 \u1090 \u1100  \u1095 \u1080 \u1089 \u1083 \u1086 \u1084  \u1073 \u1086 \u1083 \u1100 \u1096 \u1077  \u1085 \u1091 \u1083 \u1103 ."\cf4 \strokec4 )\cb1 \
\
\cb3         \cf2 \strokec2 # \uc0\u1053 \u1091 \u1083 \u1077 \u1074 \u1086 \u1081  \u1089 \u1088 \u1086 \u1082  \u1079 \u1072 \u1081 \u1084 \u1072 \cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 total_area\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 100\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 loan_term_days\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 is_valid\cf4 \strokec4 , \cf8 \strokec8 error_message\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 validate_inputs\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertFalse\cf4 \strokec4 (\cf8 \strokec8 is_valid\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertEqual\cf4 \strokec4 (\cf8 \strokec8 error_message\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1057 \u1088 \u1086 \u1082  \u1079 \u1072 \u1081 \u1084 \u1072  \u1076 \u1086 \u1083 \u1078 \u1077 \u1085  \u1073 \u1099 \u1090 \u1100  \u1094 \u1077 \u1083 \u1099 \u1084  \u1095 \u1080 \u1089 \u1083 \u1086 \u1084  \u1073 \u1086 \u1083 \u1100 \u1096 \u1077  0."\cf4 \strokec4 )\cb1 \
\
\cb3         \cf2 \strokec2 # \uc0\u1055 \u1088 \u1086 \u1074 \u1077 \u1088 \u1103 \u1077 \u1084  \u1087 \u1086 \u1083 \u1080 \u1085 \u1086 \u1084 \cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 loan_term_days\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 30\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 poly_degree\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 is_valid\cf4 \strokec4 , \cf8 \strokec8 error_message\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 validate_inputs\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertFalse\cf4 \strokec4 (\cf8 \strokec8 is_valid\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertEqual\cf4 \strokec4 (\cf8 \strokec8 error_message\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1057 \u1090 \u1077 \u1087 \u1077 \u1085 \u1100  \u1087 \u1086 \u1083 \u1080 \u1085 \u1086 \u1084 \u1072  \u1076 \u1086 \u1083 \u1078 \u1085 \u1072  \u1073 \u1099 \u1090 \u1100  \u1094 \u1077 \u1083 \u1099 \u1084  \u1095 \u1080 \u1089 \u1083 \u1086 \u1084  \u1086 \u1090  1 \u1076 \u1086  5."\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 poly_degree\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 6\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 is_valid\cf4 \strokec4 , \cf8 \strokec8 error_message\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 validate_inputs\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertFalse\cf4 \strokec4 (\cf8 \strokec8 is_valid\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertEqual\cf4 \strokec4 (\cf8 \strokec8 error_message\cf4 \strokec4 , \cf10 \strokec10 "\uc0\u1057 \u1090 \u1077 \u1087 \u1077 \u1085 \u1100  \u1087 \u1086 \u1083 \u1080 \u1085 \u1086 \u1084 \u1072  \u1076 \u1086 \u1083 \u1078 \u1085 \u1072  \u1073 \u1099 \u1090 \u1100  \u1094 \u1077 \u1083 \u1099 \u1084  \u1095 \u1080 \u1089 \u1083 \u1086 \u1084  \u1086 \u1090  1 \u1076 \u1086  5."\cf4 \strokec4 )\cb1 \
\
\cb3     \cf11 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 test_calculate_irr\cf4 \strokec4 (\cf8 \strokec8 self\cf4 \strokec4 ):\cb1 \
\cb3         \cf10 \strokec10 """\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         \uc0\u1055 \u1088 \u1086 \u1074 \u1077 \u1088 \u1103 \u1077 \u1084  IRR \'97 \u1089 \u1088 \u1072 \u1074 \u1085 \u1080 \u1074 \u1072 \u1077 \u1084  \u1089  npf.irr.\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         """\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 cash_flows\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  [\cf9 \strokec9 -\cf12 \strokec12 100000\cf4 \strokec4 , \cf12 \strokec12 30000\cf4 \strokec4 , \cf12 \strokec12 40000\cf4 \strokec4 , \cf12 \strokec12 50000\cf4 \strokec4 ]\cb1 \
\cb3         \cf8 \strokec8 irr\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_irr\cf4 \strokec4 (\cf8 \strokec8 cash_flows\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 expected_irr\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 npf\cf4 \strokec4 .\cf7 \strokec7 irr\cf4 \strokec4 (\cf8 \strokec8 cash_flows\cf4 \strokec4 ) \cf9 \strokec9 *\cf4 \strokec4  \cf12 \strokec12 100\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertAlmostEqual\cf4 \strokec4 (\cf8 \strokec8 irr\cf4 \strokec4 , \cf8 \strokec8 expected_irr\cf4 \strokec4 , \cf8 \strokec8 places\cf9 \strokec9 =\cf12 \strokec12 2\cf4 \strokec4 )\cb1 \
\
\cb3     \cf11 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 test_calculate_monthly_bep\cf4 \strokec4 (\cf8 \strokec8 self\cf4 \strokec4 ):\cb1 \
\cb3         \cf10 \strokec10 """\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         \uc0\u1055 \u1088 \u1086 \u1074 \u1077 \u1088 \u1103 \u1077 \u1084  calculate_monthly_bep. \cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         \uc0\u1054 \u1073 \u1088 \u1072 \u1090 \u1080 \u1090 \u1077  \u1074 \u1085 \u1080 \u1084 \u1072 \u1085 \u1080 \u1077 , \u1095 \u1090 \u1086  \u1092 \u1091 \u1085 \u1082 \u1094 \u1080 \u1103  \u1074 \u1086 \u1079 \u1074 \u1088 \u1072 \u1097 \u1072 \u1077 \u1090  DataFrame \cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         \uc0\u1089  \u1082 \u1086 \u1083 \u1086 \u1085 \u1082 \u1086 \u1081  "\u1053 \u1077 \u1086 \u1073 \u1093 \u1086 \u1076 \u1080 \u1084 \u1099 \u1081  \u1076 \u1086 \u1093 \u1086 \u1076  \u1076 \u1083 \u1103  BEP" (\u1080 \u1083 \u1080  \u1076 \u1088 \u1091 \u1075 \u1086 \u1081 , \u1077 \u1089 \u1083 \u1080  \u1087 \u1086 \u1084 \u1077 \u1085 \u1103 \u1083 \u1080 ).\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         """\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 params\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 WarehouseParams\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 total_area\cf9 \strokec9 =\cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 rental_cost_per_m2\cf9 \strokec9 =\cf12 \strokec12 10\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 useful_area_ratio\cf9 \strokec9 =\cf12 \strokec12 0.5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 mode\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1056 \u1091 \u1095 \u1085 \u1086 \u1081 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_share\cf9 \strokec9 =\cf12 \strokec12 0.25\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_share\cf9 \strokec9 =\cf12 \strokec12 0.25\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_share\cf9 \strokec9 =\cf12 \strokec12 0.25\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_share\cf9 \strokec9 =\cf12 \strokec12 0.25\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_area_manual\cf9 \strokec9 =\cf12 \strokec12 10.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_area_manual\cf9 \strokec9 =\cf12 \strokec12 10.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_area_manual\cf9 \strokec9 =\cf12 \strokec12 10.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_area_manual\cf9 \strokec9 =\cf12 \strokec12 10.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_fee\cf9 \strokec9 =\cf12 \strokec12 15\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 shelves_per_m2\cf9 \strokec9 =\cf12 \strokec12 3\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_daily_rate\cf9 \strokec9 =\cf12 \strokec12 6\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_extra_fee\cf9 \strokec9 =\cf12 \strokec12 10\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 item_evaluation\cf9 \strokec9 =\cf12 \strokec12 0.8\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 item_realization_markup\cf9 \strokec9 =\cf12 \strokec12 20.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 average_item_value\cf9 \strokec9 =\cf12 \strokec12 15000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_interest_rate\cf9 \strokec9 =\cf12 \strokec12 0.317\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_term_days\cf9 \strokec9 =\cf12 \strokec12 30\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 realization_share_storage\cf9 \strokec9 =\cf12 \strokec12 0.5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 realization_share_loan\cf9 \strokec9 =\cf12 \strokec12 0.5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 realization_share_vip\cf9 \strokec9 =\cf12 \strokec12 0.5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 realization_share_short_term\cf9 \strokec9 =\cf12 \strokec12 0.5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_items_density\cf9 \strokec9 =\cf12 \strokec12 5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_items_density\cf9 \strokec9 =\cf12 \strokec12 1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_items_density\cf9 \strokec9 =\cf12 \strokec12 2\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_items_density\cf9 \strokec9 =\cf12 \strokec12 4\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_fill_rate\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_fill_rate\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_fill_rate\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_fill_rate\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_monthly_churn\cf9 \strokec9 =\cf12 \strokec12 0.01\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_monthly_churn\cf9 \strokec9 =\cf12 \strokec12 0.02\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_monthly_churn\cf9 \strokec9 =\cf12 \strokec12 0.005\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_monthly_churn\cf9 \strokec9 =\cf12 \strokec12 0.03\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 salary_expense\cf9 \strokec9 =\cf12 \strokec12 240000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 miscellaneous_expenses\cf9 \strokec9 =\cf12 \strokec12 50000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 depreciation_expense\cf9 \strokec9 =\cf12 \strokec12 20000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 marketing_expenses\cf9 \strokec9 =\cf12 \strokec12 30000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 insurance_expenses\cf9 \strokec9 =\cf12 \strokec12 10000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 taxes\cf9 \strokec9 =\cf12 \strokec12 50000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 utilities_expenses\cf9 \strokec9 =\cf12 \strokec12 20000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 maintenance_expenses\cf9 \strokec9 =\cf12 \strokec12 15000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_setup_cost\cf9 \strokec9 =\cf12 \strokec12 100000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_equipment_cost\cf9 \strokec9 =\cf12 \strokec12 200000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_other_costs\cf9 \strokec9 =\cf12 \strokec12 50000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_legal_cost\cf9 \strokec9 =\cf12 \strokec12 20000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_logistics_cost\cf9 \strokec9 =\cf12 \strokec12 30000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 time_horizon\cf9 \strokec9 =\cf12 \strokec12 6\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_rent_growth\cf9 \strokec9 =\cf12 \strokec12 0.01\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 default_probability\cf9 \strokec9 =\cf12 \strokec12 0.05\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 liquidity_factor\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 safety_factor\cf9 \strokec9 =\cf12 \strokec12 1.2\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_grace_period\cf9 \strokec9 =\cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_income_growth\cf9 \strokec9 =\cf12 \strokec12 0.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_expenses_growth\cf9 \strokec9 =\cf12 \strokec12 0.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 forecast_method\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1041 \u1072 \u1079 \u1086 \u1074 \u1099 \u1081 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monte_carlo_simulations\cf9 \strokec9 =\cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monte_carlo_deviation\cf9 \strokec9 =\cf12 \strokec12 0.1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monte_carlo_seed\cf9 \strokec9 =\cf12 \strokec12 42\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 enable_ml_settings\cf9 \strokec9 =\cf11 \strokec11 False\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 electricity_cost_per_m2\cf9 \strokec9 =\cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_inflation_rate\cf9 \strokec9 =\cf12 \strokec12 0.005\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_salary_growth\cf9 \strokec9 =\cf12 \strokec12 0.005\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_other_expenses_growth\cf9 \strokec9 =\cf12 \strokec12 0.005\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 poly_degree\cf9 \strokec9 =\cf12 \strokec12 2\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 areas\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_areas\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 for\cf4 \strokec4  \cf8 \strokec8 k\cf4 \strokec4 , \cf8 \strokec8 v\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 areas\cf4 \strokec4 .\cf7 \strokec7 items\cf4 \strokec4 ():\cb1 \
\cb3             \cf7 \strokec7 setattr\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 k\cf4 \strokec4 , \cf8 \strokec8 v\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 financials\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_financials\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 disable_extended\cf9 \strokec9 =\cf11 \strokec11 False\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 monthly_bep_df\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_monthly_bep\cf4 \strokec4 (\cf8 \strokec8 financials\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\
\cb3         \cf2 \strokec2 # \uc0\u1059 \u1073 \u1077 \u1076 \u1080 \u1084 \u1089 \u1103 , \u1095 \u1090 \u1086  DataFrame \u1077 \u1089 \u1090 \u1100  \u1080  \u1090 \u1072 \u1084  \u1077 \u1089 \u1090 \u1100  \u1089 \u1090 \u1086 \u1083 \u1073 \u1077 \u1094  "\u1053 \u1077 \u1086 \u1073 \u1093 \u1086 \u1076 \u1080 \u1084 \u1099 \u1081  \u1076 \u1086 \u1093 \u1086 \u1076  \u1076 \u1083 \u1103  BEP"\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertIsInstance\cf4 \strokec4 (\cf8 \strokec8 monthly_bep_df\cf4 \strokec4 , \cf6 \strokec6 pd\cf4 \strokec4 .\cf6 \strokec6 DataFrame\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertIn\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1052 \u1077 \u1089 \u1103 \u1094 "\cf4 \strokec4 , \cf8 \strokec8 monthly_bep_df\cf4 \strokec4 .\cf8 \strokec8 columns\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertIn\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1053 \u1077 \u1086 \u1073 \u1093 \u1086 \u1076 \u1080 \u1084 \u1099 \u1081  \u1076 \u1086 \u1093 \u1086 \u1076  \u1076 \u1083 \u1103  BEP"\cf4 \strokec4 , \cf8 \strokec8 monthly_bep_df\cf4 \strokec4 .\cf8 \strokec8 columns\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertEqual\cf4 \strokec4 (\cf7 \strokec7 len\cf4 \strokec4 (\cf8 \strokec8 monthly_bep_df\cf4 \strokec4 ), \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 time_horizon\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertTrue\cf4 \strokec4 (\cf7 \strokec7 all\cf4 \strokec4 (\cf8 \strokec8 monthly_bep_df\cf4 \strokec4 [\cf10 \strokec10 "\uc0\u1053 \u1077 \u1086 \u1073 \u1093 \u1086 \u1076 \u1080 \u1084 \u1099 \u1081  \u1076 \u1086 \u1093 \u1086 \u1076  \u1076 \u1083 \u1103  BEP"\cf4 \strokec4 ] \cf7 \strokec7 >=\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 ))\cb1 \
\
\cb3         \cf2 \strokec2 # \uc0\u1055 \u1088 \u1086 \u1074 \u1077 \u1088 \u1082 \u1072  \u1073 \u1077 \u1079  \u1088 \u1086 \u1089 \u1090 \u1072 \cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 monthly_rent_growth\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 monthly_salary_growth\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 monthly_other_expenses_growth\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 areas\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_areas\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 for\cf4 \strokec4  \cf8 \strokec8 k\cf4 \strokec4 , \cf8 \strokec8 v\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 areas\cf4 \strokec4 .\cf7 \strokec7 items\cf4 \strokec4 ():\cb1 \
\cb3             \cf7 \strokec7 setattr\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 k\cf4 \strokec4 , \cf8 \strokec8 v\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 financials_no_growth\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_financials\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 disable_extended\cf9 \strokec9 =\cf11 \strokec11 False\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 monthly_bep_df_no_growth\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_monthly_bep\cf4 \strokec4 (\cf8 \strokec8 financials_no_growth\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\
\cb3         \cf2 \strokec2 # \uc0\u1058 \u1077 \u1087 \u1077 \u1088 \u1100  \u1101 \u1090 \u1086 \u1090  DataFrame \u1090 \u1086 \u1078 \u1077  \u1080 \u1084 \u1077 \u1077 \u1090  "\u1053 \u1077 \u1086 \u1073 \u1093 \u1086 \u1076 \u1080 \u1084 \u1099 \u1081  \u1076 \u1086 \u1093 \u1086 \u1076  \u1076 \u1083 \u1103  BEP".\cf4 \cb1 \strokec4 \
\cb3         \cf2 \strokec2 # \uc0\u1055 \u1088 \u1086 \u1074 \u1077 \u1088 \u1103 \u1077 \u1084 , \u1095 \u1090 \u1086  \u1073 \u1077 \u1079  \u1088 \u1086 \u1089 \u1090 \u1072  \u1074 \u1089 \u1077  \u1084 \u1077 \u1089 \u1103 \u1094 \u1099  \u1086 \u1076 \u1080 \u1085 \u1072 \u1082 \u1086 \u1074 \u1099 \u1077 \cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 diff_all_zeros\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cf8 \strokec8 monthly_bep_df_no_growth\cf4 \strokec4 [\cf10 \strokec10 "\uc0\u1053 \u1077 \u1086 \u1073 \u1093 \u1086 \u1076 \u1080 \u1084 \u1099 \u1081  \u1076 \u1086 \u1093 \u1086 \u1076  \u1076 \u1083 \u1103  BEP"\cf4 \strokec4 ].\cf7 \strokec7 diff\cf4 \strokec4 ()[\cf12 \strokec12 1\cf4 \strokec4 :] \cf7 \strokec7 ==\cf4 \strokec4  \cf12 \strokec12 0\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertTrue\cf4 \strokec4 (\cf7 \strokec7 all\cf4 \strokec4 (\cf8 \strokec8 diff_all_zeros\cf4 \strokec4 ))\cb1 \
\
\cb3     \cf11 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 test_calculate_areas\cf4 \strokec4 (\cf8 \strokec8 self\cf4 \strokec4 ):\cb1 \
\cb3         \cf10 \strokec10 """\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         \uc0\u1055 \u1088 \u1086 \u1074 \u1077 \u1088 \u1103 \u1077 \u1084  \u1082 \u1086 \u1088 \u1088 \u1077 \u1082 \u1090 \u1085 \u1086 \u1089 \u1090 \u1100  \u1088 \u1072 \u1089 \u1087 \u1088 \u1077 \u1076 \u1077 \u1083 \u1077 \u1085 \u1080 \u1103  \u1087 \u1083 \u1086 \u1097 \u1072 \u1076 \u1077 \u1081 .\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         """\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 params\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 WarehouseParams\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 total_area\cf9 \strokec9 =\cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 rental_cost_per_m2\cf9 \strokec9 =\cf12 \strokec12 10\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 useful_area_ratio\cf9 \strokec9 =\cf12 \strokec12 0.7\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 mode\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1056 \u1091 \u1095 \u1085 \u1086 \u1081 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_share\cf9 \strokec9 =\cf12 \strokec12 0.25\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_share\cf9 \strokec9 =\cf12 \strokec12 0.25\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_share\cf9 \strokec9 =\cf12 \strokec12 0.25\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_share\cf9 \strokec9 =\cf12 \strokec12 0.25\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_area_manual\cf9 \strokec9 =\cf12 \strokec12 20.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_area_manual\cf9 \strokec9 =\cf12 \strokec12 15.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_area_manual\cf9 \strokec9 =\cf12 \strokec12 10.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_area_manual\cf9 \strokec9 =\cf12 \strokec12 5.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_fee\cf9 \strokec9 =\cf12 \strokec12 15\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 shelves_per_m2\cf9 \strokec9 =\cf12 \strokec12 3\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_daily_rate\cf9 \strokec9 =\cf12 \strokec12 6\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_extra_fee\cf9 \strokec9 =\cf12 \strokec12 10\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 item_evaluation\cf9 \strokec9 =\cf12 \strokec12 0.8\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 item_realization_markup\cf9 \strokec9 =\cf12 \strokec12 20.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 average_item_value\cf9 \strokec9 =\cf12 \strokec12 15000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_interest_rate\cf9 \strokec9 =\cf12 \strokec12 0.317\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_term_days\cf9 \strokec9 =\cf12 \strokec12 30\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 realization_share_storage\cf9 \strokec9 =\cf12 \strokec12 0.5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 realization_share_loan\cf9 \strokec9 =\cf12 \strokec12 0.5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 realization_share_vip\cf9 \strokec9 =\cf12 \strokec12 0.5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 realization_share_short_term\cf9 \strokec9 =\cf12 \strokec12 0.5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_items_density\cf9 \strokec9 =\cf12 \strokec12 5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_items_density\cf9 \strokec9 =\cf12 \strokec12 1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_items_density\cf9 \strokec9 =\cf12 \strokec12 2\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_items_density\cf9 \strokec9 =\cf12 \strokec12 4\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_fill_rate\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_fill_rate\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_fill_rate\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_fill_rate\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_monthly_churn\cf9 \strokec9 =\cf12 \strokec12 0.01\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_monthly_churn\cf9 \strokec9 =\cf12 \strokec12 0.02\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_monthly_churn\cf9 \strokec9 =\cf12 \strokec12 0.005\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_monthly_churn\cf9 \strokec9 =\cf12 \strokec12 0.03\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 salary_expense\cf9 \strokec9 =\cf12 \strokec12 240000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 miscellaneous_expenses\cf9 \strokec9 =\cf12 \strokec12 50000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 depreciation_expense\cf9 \strokec9 =\cf12 \strokec12 20000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 marketing_expenses\cf9 \strokec9 =\cf12 \strokec12 30000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 insurance_expenses\cf9 \strokec9 =\cf12 \strokec12 10000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 taxes\cf9 \strokec9 =\cf12 \strokec12 50000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 utilities_expenses\cf9 \strokec9 =\cf12 \strokec12 20000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 maintenance_expenses\cf9 \strokec9 =\cf12 \strokec12 15000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_setup_cost\cf9 \strokec9 =\cf12 \strokec12 100000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_equipment_cost\cf9 \strokec9 =\cf12 \strokec12 200000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_other_costs\cf9 \strokec9 =\cf12 \strokec12 50000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_legal_cost\cf9 \strokec9 =\cf12 \strokec12 20000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_logistics_cost\cf9 \strokec9 =\cf12 \strokec12 30000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 time_horizon\cf9 \strokec9 =\cf12 \strokec12 6\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_rent_growth\cf9 \strokec9 =\cf12 \strokec12 0.01\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 default_probability\cf9 \strokec9 =\cf12 \strokec12 0.05\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 liquidity_factor\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 safety_factor\cf9 \strokec9 =\cf12 \strokec12 1.2\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_grace_period\cf9 \strokec9 =\cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_income_growth\cf9 \strokec9 =\cf12 \strokec12 0.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_expenses_growth\cf9 \strokec9 =\cf12 \strokec12 0.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 forecast_method\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1041 \u1072 \u1079 \u1086 \u1074 \u1099 \u1081 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monte_carlo_simulations\cf9 \strokec9 =\cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monte_carlo_deviation\cf9 \strokec9 =\cf12 \strokec12 0.1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monte_carlo_seed\cf9 \strokec9 =\cf12 \strokec12 42\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 enable_ml_settings\cf9 \strokec9 =\cf11 \strokec11 False\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 electricity_cost_per_m2\cf9 \strokec9 =\cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_inflation_rate\cf9 \strokec9 =\cf12 \strokec12 0.005\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_salary_growth\cf9 \strokec9 =\cf12 \strokec12 0.005\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_other_expenses_growth\cf9 \strokec9 =\cf12 \strokec12 0.005\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 poly_degree\cf9 \strokec9 =\cf12 \strokec12 2\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 areas\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_areas\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertAlmostEqual\cf4 \strokec4 (\cf8 \strokec8 areas\cf4 \strokec4 [\cf10 \strokec10 "storage_area"\cf4 \strokec4 ], \cf12 \strokec12 20.0\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertAlmostEqual\cf4 \strokec4 (\cf8 \strokec8 areas\cf4 \strokec4 [\cf10 \strokec10 "loan_area"\cf4 \strokec4 ], \cf12 \strokec12 15.0\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertAlmostEqual\cf4 \strokec4 (\cf8 \strokec8 areas\cf4 \strokec4 [\cf10 \strokec10 "vip_area"\cf4 \strokec4 ], \cf12 \strokec12 10.0\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertAlmostEqual\cf4 \strokec4 (\cf8 \strokec8 areas\cf4 \strokec4 [\cf10 \strokec10 "short_term_area"\cf4 \strokec4 ], \cf12 \strokec12 5.0\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertAlmostEqual\cf4 \strokec4 (\cf8 \strokec8 areas\cf4 \strokec4 [\cf10 \strokec10 "usable_area"\cf4 \strokec4 ], \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 total_area\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 useful_area_ratio\cf4 \strokec4 )\cb1 \
\
\cb3     \cf11 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 test_calculate_financials\cf4 \strokec4 (\cf8 \strokec8 self\cf4 \strokec4 ):\cb1 \
\cb3         \cf10 \strokec10 """\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         \uc0\u1055 \u1088 \u1086 \u1074 \u1077 \u1088 \u1103 \u1077 \u1084  \u1086 \u1073 \u1097 \u1080 \u1081  \u1088 \u1072 \u1089 \u1095 \u1105 \u1090  calculate_financials \u1079 \u1072  1 \u1084 \u1077 \u1089 \u1103 \u1094  (\u1076 \u1086 \u1093 \u1086 \u1076 \u1099 , \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1099 , \u1087 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100 ).\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         """\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 params\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 WarehouseParams\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 total_area\cf9 \strokec9 =\cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 rental_cost_per_m2\cf9 \strokec9 =\cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 useful_area_ratio\cf9 \strokec9 =\cf12 \strokec12 0.7\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 mode\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1056 \u1091 \u1095 \u1085 \u1086 \u1081 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_share\cf9 \strokec9 =\cf12 \strokec12 0.25\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_share\cf9 \strokec9 =\cf12 \strokec12 0.25\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_share\cf9 \strokec9 =\cf12 \strokec12 0.25\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_share\cf9 \strokec9 =\cf12 \strokec12 0.25\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_area_manual\cf9 \strokec9 =\cf12 \strokec12 20.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_area_manual\cf9 \strokec9 =\cf12 \strokec12 15.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_area_manual\cf9 \strokec9 =\cf12 \strokec12 10.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_area_manual\cf9 \strokec9 =\cf12 \strokec12 5.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_fee\cf9 \strokec9 =\cf12 \strokec12 1500\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 shelves_per_m2\cf9 \strokec9 =\cf12 \strokec12 3\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_daily_rate\cf9 \strokec9 =\cf12 \strokec12 60\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_extra_fee\cf9 \strokec9 =\cf12 \strokec12 1000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 item_evaluation\cf9 \strokec9 =\cf12 \strokec12 0.8\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 item_realization_markup\cf9 \strokec9 =\cf12 \strokec12 20.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 average_item_value\cf9 \strokec9 =\cf12 \strokec12 15000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_interest_rate\cf9 \strokec9 =\cf12 \strokec12 0.317\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_term_days\cf9 \strokec9 =\cf12 \strokec12 30\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 realization_share_storage\cf9 \strokec9 =\cf12 \strokec12 0.5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 realization_share_loan\cf9 \strokec9 =\cf12 \strokec12 0.5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 realization_share_vip\cf9 \strokec9 =\cf12 \strokec12 0.5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 realization_share_short_term\cf9 \strokec9 =\cf12 \strokec12 0.5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_items_density\cf9 \strokec9 =\cf12 \strokec12 5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_items_density\cf9 \strokec9 =\cf12 \strokec12 1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_items_density\cf9 \strokec9 =\cf12 \strokec12 2\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_items_density\cf9 \strokec9 =\cf12 \strokec12 4\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_fill_rate\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_fill_rate\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_fill_rate\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_fill_rate\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_monthly_churn\cf9 \strokec9 =\cf12 \strokec12 0.01\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_monthly_churn\cf9 \strokec9 =\cf12 \strokec12 0.02\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_monthly_churn\cf9 \strokec9 =\cf12 \strokec12 0.005\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_monthly_churn\cf9 \strokec9 =\cf12 \strokec12 0.03\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 salary_expense\cf9 \strokec9 =\cf12 \strokec12 240000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 miscellaneous_expenses\cf9 \strokec9 =\cf12 \strokec12 50000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 depreciation_expense\cf9 \strokec9 =\cf12 \strokec12 20000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 marketing_expenses\cf9 \strokec9 =\cf12 \strokec12 30000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 insurance_expenses\cf9 \strokec9 =\cf12 \strokec12 10000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 taxes\cf9 \strokec9 =\cf12 \strokec12 50000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 utilities_expenses\cf9 \strokec9 =\cf12 \strokec12 20000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 maintenance_expenses\cf9 \strokec9 =\cf12 \strokec12 15000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_setup_cost\cf9 \strokec9 =\cf12 \strokec12 100000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_equipment_cost\cf9 \strokec9 =\cf12 \strokec12 200000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_other_costs\cf9 \strokec9 =\cf12 \strokec12 50000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_legal_cost\cf9 \strokec9 =\cf12 \strokec12 20000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_logistics_cost\cf9 \strokec9 =\cf12 \strokec12 30000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 time_horizon\cf9 \strokec9 =\cf12 \strokec12 6\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_rent_growth\cf9 \strokec9 =\cf12 \strokec12 0.01\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 default_probability\cf9 \strokec9 =\cf12 \strokec12 0.05\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 liquidity_factor\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 safety_factor\cf9 \strokec9 =\cf12 \strokec12 1.2\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_grace_period\cf9 \strokec9 =\cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_income_growth\cf9 \strokec9 =\cf12 \strokec12 0.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_expenses_growth\cf9 \strokec9 =\cf12 \strokec12 0.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 forecast_method\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1041 \u1072 \u1079 \u1086 \u1074 \u1099 \u1081 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monte_carlo_simulations\cf9 \strokec9 =\cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monte_carlo_deviation\cf9 \strokec9 =\cf12 \strokec12 0.1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monte_carlo_seed\cf9 \strokec9 =\cf12 \strokec12 42\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 enable_ml_settings\cf9 \strokec9 =\cf11 \strokec11 False\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 electricity_cost_per_m2\cf9 \strokec9 =\cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_inflation_rate\cf9 \strokec9 =\cf12 \strokec12 0.005\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_salary_growth\cf9 \strokec9 =\cf12 \strokec12 0.005\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_other_expenses_growth\cf9 \strokec9 =\cf12 \strokec12 0.005\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 poly_degree\cf9 \strokec9 =\cf12 \strokec12 2\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 areas\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_areas\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 for\cf4 \strokec4  \cf8 \strokec8 k\cf4 \strokec4 , \cf8 \strokec8 v\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 areas\cf4 \strokec4 .\cf7 \strokec7 items\cf4 \strokec4 ():\cb1 \
\cb3             \cf7 \strokec7 setattr\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 k\cf4 \strokec4 , \cf8 \strokec8 v\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 fin\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_financials\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 disable_extended\cf9 \strokec9 =\cf11 \strokec11 False\cf4 \strokec4 )\cb1 \
\
\cb3         \cf2 \strokec2 # \uc0\u1044 \u1086 \u1093 \u1086 \u1076  (\u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1080 \u1077 )\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 expected_storage_income\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 storage_area\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 storage_fee\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 expected_vip_income\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 vip_area\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 storage_fee\cf4 \strokec4  \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 vip_extra_fee\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 expected_short_term_income\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 short_term_area\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 short_term_daily_rate\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf12 \strokec12 30\cf4 \cb1 \strokec4 \
\
\cb3         \cf2 \strokec2 # \uc0\u1047 \u1072 \u1081 \u1084 \u1099  \cf4 \cb1 \strokec4 \
\cb3         \cf5 \strokec5 from\cf4 \strokec4  \cf6 \strokec6 calculations\cf4 \strokec4  \cf5 \strokec5 import\cf4 \strokec4  \cf7 \strokec7 calculate_items\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 loan_items\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_items\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 loan_area\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 shelves_per_m2\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 loan_items_density\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 loan_fill_rate\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 loan_evaluated_value\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 average_item_value\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 item_evaluation\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 loan_items\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 daily_loan_rate\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 max\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 loan_interest_rate\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf12 \strokec12 100.0\cf4 \strokec4 , \cf12 \strokec12 0\cf4 \strokec4 )\cb1 \
\cb3         \cf2 \strokec2 # \uc0\u1045 \u1089 \u1083 \u1080  \u1088 \u1077 \u1072 \u1083 \u1080 \u1079 \u1072 \u1094 \u1080 \u1103 _\u1076 \u1086 \u1083 \u1103  = 0.5, \u1090 \u1086 \u1075 \u1076 \u1072  \u1087 \u1086 \u1083 \u1086 \u1074 \u1080 \u1085 \u1072  \u1074 \u1077 \u1097 \u1077 \u1081  \u1080 \u1076 \u1077 \u1090  \u1085 \u1072  \u1087 \u1088 \u1086 \u1094 \u1077 \u1085 \u1090 \u1099 , \u1087 \u1086 \u1083 \u1086 \u1074 \u1080 \u1085 \u1072  \'97 \u1085 \u1072  \u1088 \u1077 \u1072 \u1083 \u1080 \u1079 \u1072 \u1094 \u1080 \u1102 \cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 interest_part\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 loan_items\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  (\cf12 \strokec12 1\cf4 \strokec4  \cf9 \strokec9 -\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 realization_share_loan\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 real_part\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 loan_items\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 realization_share_loan\cf4 \cb1 \strokec4 \
\cb3         \cb1 \
\cb3         \cf8 \strokec8 loan_evaluated_interest\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 interest_part\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 average_item_value\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 item_evaluation\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 expected_loan_interest\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cb1 \
\cb3             \cf8 \strokec8 loan_evaluated_interest\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 daily_loan_rate\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 loan_term_days\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 *\cf4 \strokec4  (\cf12 \strokec12 1\cf4 \strokec4  \cf9 \strokec9 -\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 default_probability\cf4 \strokec4 )\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 loan_evaluated_real\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 real_part\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 average_item_value\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 item_evaluation\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 expected_loan_real\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 loan_evaluated_real\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 item_realization_markup\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf12 \strokec12 100.0\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 expected_loan_income\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 expected_loan_interest\cf4 \strokec4  \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 expected_loan_real\cf4 \cb1 \strokec4 \
\
\cb3         \cf2 \strokec2 # \uc0\u1056 \u1077 \u1072 \u1083 \u1080 \u1079 \u1072 \u1094 \u1080 \u1103  storage / vip / short_term\cf4 \cb1 \strokec4 \
\cb3         \cf11 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 calc_real\cf4 \strokec4 (\cf8 \strokec8 items\cf4 \strokec4 ):\cb1 \
\cb3             \cf5 \strokec5 return\cf4 \strokec4  (\cb1 \
\cb3                 \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 average_item_value\cf4 \cb1 \strokec4 \
\cb3                 \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 item_evaluation\cf4 \cb1 \strokec4 \
\cb3                 \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 items\cf4 \cb1 \strokec4 \
\cb3                 \cf9 \strokec9 *\cf4 \strokec4  (\cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 item_realization_markup\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf12 \strokec12 100\cf4 \strokec4 )\cb1 \
\cb3             )\cb1 \
\cb3         \cf8 \strokec8 storage_items\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_items\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 storage_area\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 shelves_per_m2\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 storage_items_density\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 storage_fill_rate\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 vip_items\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_items\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 vip_area\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 shelves_per_m2\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 vip_items_density\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 vip_fill_rate\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 short_term_items\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_items\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 short_term_area\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 shelves_per_m2\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 short_term_items_density\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 short_term_fill_rate\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 expected_storage_real\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calc_real\cf4 \strokec4 (\cf8 \strokec8 storage_items\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 realization_share_storage\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 expected_vip_real\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calc_real\cf4 \strokec4 (\cf8 \strokec8 vip_items\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 realization_share_vip\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 expected_short_real\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calc_real\cf4 \strokec4 (\cf8 \strokec8 short_term_items\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 realization_share_short_term\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 expected_realization_income\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cb1 \
\cb3             \cf8 \strokec8 expected_storage_real\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 expected_vip_real\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 expected_short_real\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\
\cb3         \cf2 \strokec2 # \uc0\u1048 \u1090 \u1086 \u1075 \u1086  \u1076 \u1086 \u1093 \u1086 \u1076 \cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 expected_total_income\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cb1 \
\cb3             \cf8 \strokec8 expected_storage_income\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 expected_vip_income\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 expected_short_term_income\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 expected_loan_income\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 expected_realization_income\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\
\cb3         \cf2 \strokec2 # \uc0\u1056 \u1072 \u1089 \u1093 \u1086 \u1076 \u1099 \cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 monthly_rent\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 total_area\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 rental_cost_per_m2\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 electricity_cost\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 total_area\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 electricity_cost_per_m2\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 packaging_cost\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 total_area\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 packaging_cost_per_m2\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 expected_total_monthly_expenses\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cb1 \
\cb3             \cf8 \strokec8 monthly_rent\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 salary_expense\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 packaging_cost\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 miscellaneous_expenses\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 depreciation_expense\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 marketing_expenses\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 insurance_expenses\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 taxes\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 utilities_expenses\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 maintenance_expenses\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 electricity_cost\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\
\cb3         \cf2 \strokec2 # \uc0\u1057 \u1088 \u1072 \u1074 \u1085 \u1080 \u1074 \u1072 \u1077 \u1084  \u1092 \u1072 \u1082 \u1090 \u1080 \u1095 \u1077 \u1089 \u1082 \u1080 \u1077  \u1088 \u1077 \u1079 \u1091 \u1083 \u1100 \u1090 \u1072 \u1090 \u1099  \u1089  \u1086 \u1078 \u1080 \u1076 \u1072 \u1077 \u1084 \u1099 \u1084 \u1080 \cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertAlmostEqual\cf4 \strokec4 (\cf8 \strokec8 fin\cf4 \strokec4 [\cf10 \strokec10 "storage_income"\cf4 \strokec4 ], \cf8 \strokec8 expected_storage_income\cf4 \strokec4 , \cf8 \strokec8 places\cf9 \strokec9 =\cf12 \strokec12 2\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertAlmostEqual\cf4 \strokec4 (\cf8 \strokec8 fin\cf4 \strokec4 [\cf10 \strokec10 "vip_income"\cf4 \strokec4 ], \cf8 \strokec8 expected_vip_income\cf4 \strokec4 , \cf8 \strokec8 places\cf9 \strokec9 =\cf12 \strokec12 2\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertAlmostEqual\cf4 \strokec4 (\cf8 \strokec8 fin\cf4 \strokec4 [\cf10 \strokec10 "short_term_income"\cf4 \strokec4 ], \cf8 \strokec8 expected_short_term_income\cf4 \strokec4 , \cf8 \strokec8 places\cf9 \strokec9 =\cf12 \strokec12 2\cf4 \strokec4 )\cb1 \
\
\cb3         \cf2 \strokec2 # \uc0\u1054 \u1089 \u1085 \u1086 \u1074 \u1085 \u1072 \u1103  \u1088 \u1072 \u1079 \u1085 \u1080 \u1094 \u1072  \u1084 \u1086 \u1078 \u1077 \u1090  \u1073 \u1099 \u1090 \u1100  \u1074  loan_income, \u1090 .\u1082 . \u1088 \u1072 \u1079 \u1076 \u1077 \u1083 \u1080 \u1083 \u1080  (\u1087 \u1088 \u1086 \u1094 \u1077 \u1085 \u1090 \u1099  + \u1088 \u1077 \u1072 \u1083 \u1080 \u1079 \u1072 \u1094 \u1080 \u1103 )\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertAlmostEqual\cf4 \strokec4 (\cf8 \strokec8 fin\cf4 \strokec4 [\cf10 \strokec10 "loan_income"\cf4 \strokec4 ], \cf8 \strokec8 expected_loan_income\cf4 \strokec4 , \cf8 \strokec8 places\cf9 \strokec9 =\cf12 \strokec12 2\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertAlmostEqual\cf4 \strokec4 (\cf8 \strokec8 fin\cf4 \strokec4 [\cf10 \strokec10 "realization_income"\cf4 \strokec4 ], \cf8 \strokec8 expected_realization_income\cf4 \strokec4 , \cf8 \strokec8 places\cf9 \strokec9 =\cf12 \strokec12 2\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertAlmostEqual\cf4 \strokec4 (\cf8 \strokec8 fin\cf4 \strokec4 [\cf10 \strokec10 "total_income"\cf4 \strokec4 ], \cf8 \strokec8 expected_total_income\cf4 \strokec4 , \cf8 \strokec8 places\cf9 \strokec9 =\cf12 \strokec12 2\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertAlmostEqual\cf4 \strokec4 (\cf8 \strokec8 fin\cf4 \strokec4 [\cf10 \strokec10 "total_expenses"\cf4 \strokec4 ], \cf8 \strokec8 expected_total_monthly_expenses\cf4 \strokec4 , \cf8 \strokec8 places\cf9 \strokec9 =\cf12 \strokec12 2\cf4 \strokec4 )\cb1 \
\
\cb3         \cf2 \strokec2 # \uc0\u1055 \u1088 \u1086 \u1074 \u1077 \u1088 \u1103 \u1077 \u1084  \u1077 \u1076 \u1080 \u1085 \u1086 \u1074 \u1088 \u1077 \u1084 \u1077 \u1085 \u1085 \u1099 \u1077 \cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 one_time_setup_cost\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 100000\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 time_horizon\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 6\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 areas\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_areas\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 for\cf4 \strokec4  \cf8 \strokec8 k\cf4 \strokec4 , \cf8 \strokec8 v\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 areas\cf4 \strokec4 .\cf7 \strokec7 items\cf4 \strokec4 ():\cb1 \
\cb3             \cf7 \strokec7 setattr\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 k\cf4 \strokec4 , \cf8 \strokec8 v\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 fin_onetime\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_financials\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 disable_extended\cf9 \strokec9 =\cf11 \strokec11 False\cf4 \strokec4 )\cb1 \
\cb3         \cf2 \strokec2 # profit = total_income - total_monthly_expenses - (one_time_expenses / horizon)\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 expected_profit\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cb1 \
\cb3             \cf8 \strokec8 expected_total_income\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 -\cf4 \strokec4  \cf8 \strokec8 expected_total_monthly_expenses\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 -\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 one_time_expenses\cf4 \strokec4  \cf9 \strokec9 /\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 time_horizon\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertAlmostEqual\cf4 \strokec4 (\cf8 \strokec8 fin_onetime\cf4 \strokec4 [\cf10 \strokec10 "profit"\cf4 \strokec4 ], \cf8 \strokec8 expected_profit\cf4 \strokec4 , \cf8 \strokec8 places\cf9 \strokec9 =\cf12 \strokec12 2\cf4 \strokec4 )\cb1 \
\
\cb3         \cf2 \strokec2 # \uc0\u1047 \u1072 \u1085 \u1091 \u1083 \u1103 \u1077 \u1084  \u1077 \u1076 \u1080 \u1085 \u1086 \u1074 \u1088 \u1077 \u1084 \u1077 \u1085 \u1085 \u1099 \u1077  \cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 one_time_setup_cost\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 one_time_equipment_cost\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 one_time_other_costs\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 one_time_legal_cost\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 one_time_logistics_cost\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 areas\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_areas\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 for\cf4 \strokec4  \cf8 \strokec8 k\cf4 \strokec4 , \cf8 \strokec8 v\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 areas\cf4 \strokec4 .\cf7 \strokec7 items\cf4 \strokec4 ():\cb1 \
\cb3             \cf7 \strokec7 setattr\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 k\cf4 \strokec4 , \cf8 \strokec8 v\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 fin_zero_onetime\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_financials\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 disable_extended\cf9 \strokec9 =\cf11 \strokec11 False\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 expected_profit_no_onetime\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  (\cb1 \
\cb3             \cf8 \strokec8 expected_total_income\cf4 \cb1 \strokec4 \
\cb3             \cf9 \strokec9 -\cf4 \strokec4  \cf8 \strokec8 expected_total_monthly_expenses\cf4 \cb1 \strokec4 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertAlmostEqual\cf4 \strokec4 (\cf8 \strokec8 fin_zero_onetime\cf4 \strokec4 [\cf10 \strokec10 "profit"\cf4 \strokec4 ], \cf8 \strokec8 expected_profit_no_onetime\cf4 \strokec4 , \cf8 \strokec8 places\cf9 \strokec9 =\cf12 \strokec12 2\cf4 \strokec4 )\cb1 \
\
\cb3     \cf11 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 test_calculate_additional_metrics\cf4 \strokec4 (\cf8 \strokec8 self\cf4 \strokec4 ):\cb1 \
\cb3         \cf10 \strokec10 """\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         \uc0\u1055 \u1088 \u1086 \u1074 \u1077 \u1088 \u1103 \u1077 \u1084  calculate_additional_metrics (\u1084 \u1072 \u1088 \u1078 \u1072 , \u1088 \u1077 \u1085 \u1090 \u1072 \u1073 \u1077 \u1083 \u1100 \u1085 \u1086 \u1089 \u1090 \u1100 ).\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         """\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 pm\cf4 \strokec4 , \cf8 \strokec8 pr\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_additional_metrics\cf4 \strokec4 (\cf12 \strokec12 100000\cf4 \strokec4 , \cf12 \strokec12 80000\cf4 \strokec4 , \cf12 \strokec12 20000\cf4 \strokec4 )\cb1 \
\cb3         \cf2 \strokec2 # pm = (profit / total_income) * 100 => (20000 / 100000)*100 = 20\cf4 \cb1 \strokec4 \
\cb3         \cf2 \strokec2 # pr = (profit / total_expenses)*100 => (20000 / 80000)*100 = 25\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertAlmostEqual\cf4 \strokec4 (\cf8 \strokec8 pm\cf4 \strokec4 , \cf12 \strokec12 20.0\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertAlmostEqual\cf4 \strokec4 (\cf8 \strokec8 pr\cf4 \strokec4 , \cf12 \strokec12 25.0\cf4 \strokec4 )\cb1 \
\
\cb3     \cf11 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 test_calculate_roi\cf4 \strokec4 (\cf8 \strokec8 self\cf4 \strokec4 ):\cb1 \
\cb3         \cf10 \strokec10 """\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         \uc0\u1055 \u1088 \u1086 \u1074 \u1077 \u1088 \u1103 \u1077 \u1084  ROI.\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         """\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertAlmostEqual\cf4 \strokec4 (\cf7 \strokec7 calculate_roi\cf4 \strokec4 (\cf12 \strokec12 100000\cf4 \strokec4 , \cf12 \strokec12 80000\cf4 \strokec4 ), \cf12 \strokec12 25.0\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertIsNone\cf4 \strokec4 (\cf7 \strokec7 calculate_roi\cf4 \strokec4 (\cf12 \strokec12 100000\cf4 \strokec4 , \cf12 \strokec12 0\cf4 \strokec4 ))\cb1 \
\
\cb3     \cf11 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 test_monte_carlo_simulation\cf4 \strokec4 (\cf8 \strokec8 self\cf4 \strokec4 ):\cb1 \
\cb3         \cf10 \strokec10 """\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         \uc0\u1055 \u1088 \u1086 \u1074 \u1077 \u1088 \u1103 \u1077 \u1084  \u1084 \u1086 \u1085 \u1090 \u1077 -\u1082 \u1072 \u1088 \u1083 \u1086  \u1089 \u1080 \u1084 \u1091 \u1083 \u1103 \u1094 \u1080 \u1102  \u1076 \u1086 \u1093 \u1086 \u1076 \u1086 \u1074 /\u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1086 \u1074 .\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         """\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 base_income\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 100000\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 base_expenses\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 80000\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 time_horizon\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 6\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 simulations\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 100\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 deviation\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 0.1\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 seed\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 42\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 monthly_income_growth\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 0.01\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 monthly_expenses_growth\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf12 \strokec12 0.01\cf4 \cb1 \strokec4 \
\
\cb3         \cf8 \strokec8 df_mc\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 monte_carlo_simulation\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 base_income\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 base_expenses\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 time_horizon\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 simulations\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 deviation\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 seed\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_income_growth\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_expenses_growth\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertIsInstance\cf4 \strokec4 (\cf8 \strokec8 df_mc\cf4 \strokec4 , \cf6 \strokec6 pd\cf4 \strokec4 .\cf6 \strokec6 DataFrame\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertEqual\cf4 \strokec4 (\cf7 \strokec7 len\cf4 \strokec4 (\cf8 \strokec8 df_mc\cf4 \strokec4 ), \cf8 \strokec8 time_horizon\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertIn\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1052 \u1077 \u1089 \u1103 \u1094 "\cf4 \strokec4 , \cf8 \strokec8 df_mc\cf4 \strokec4 .\cf8 \strokec8 columns\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertIn\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1057 \u1088 \u1077 \u1076 \u1085 \u1080 \u1081  \u1044 \u1086 \u1093 \u1086 \u1076 "\cf4 \strokec4 , \cf8 \strokec8 df_mc\cf4 \strokec4 .\cf8 \strokec8 columns\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertIn\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1057 \u1088 \u1077 \u1076 \u1085 \u1080 \u1081  \u1056 \u1072 \u1089 \u1093 \u1086 \u1076 "\cf4 \strokec4 , \cf8 \strokec8 df_mc\cf4 \strokec4 .\cf8 \strokec8 columns\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertIn\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1057 \u1088 \u1077 \u1076 \u1085 \u1103 \u1103  \u1055 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100 "\cf4 \strokec4 , \cf8 \strokec8 df_mc\cf4 \strokec4 .\cf8 \strokec8 columns\cf4 \strokec4 )\cb1 \
\
\cb3         \cf2 \strokec2 # \uc0\u1055 \u1088 \u1086 \u1089 \u1090 \u1077 \u1081 \u1096 \u1080 \u1077  \u1087 \u1088 \u1086 \u1074 \u1077 \u1088 \u1082 \u1080  \u1085 \u1072  \u1076 \u1080 \u1072 \u1087 \u1072 \u1079 \u1086 \u1085  \u1079 \u1085 \u1072 \u1095 \u1077 \u1085 \u1080 \u1081 \cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertTrue\cf4 \strokec4 (\cf7 \strokec7 all\cf4 \strokec4 (\cf8 \strokec8 df_mc\cf4 \strokec4 [\cf10 \strokec10 "\uc0\u1057 \u1088 \u1077 \u1076 \u1085 \u1080 \u1081  \u1044 \u1086 \u1093 \u1086 \u1076 "\cf4 \strokec4 ] \cf7 \strokec7 >\cf4 \strokec4  \cf8 \strokec8 base_income\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf12 \strokec12 0.9\cf4 \strokec4 ))\cb1 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertTrue\cf4 \strokec4 (\cb1 \
\cb3             \cf7 \strokec7 all\cf4 \strokec4 (\cb1 \
\cb3                 \cf8 \strokec8 df_mc\cf4 \strokec4 [\cf10 \strokec10 "\uc0\u1057 \u1088 \u1077 \u1076 \u1085 \u1080 \u1081  \u1044 \u1086 \u1093 \u1086 \u1076 "\cf4 \strokec4 ]\cb1 \
\cb3                 \cf7 \strokec7 <\cf4 \strokec4  \cf8 \strokec8 base_income\cf4 \cb1 \strokec4 \
\cb3                 \cf9 \strokec9 *\cf4 \strokec4  (\cf12 \strokec12 1\cf4 \strokec4  \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 monthly_income_growth\cf4 \strokec4  \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 time_horizon\cf4 \strokec4 )\cb1 \
\cb3                 \cf9 \strokec9 *\cf4 \strokec4  (\cf12 \strokec12 1\cf4 \strokec4  \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 deviation\cf4 \strokec4 )\cb1 \
\cb3             )\cb1 \
\cb3         )\cb1 \
\
\cb3     \cf11 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 test_min_loan_amount_for_bep\cf4 \strokec4 (\cf8 \strokec8 self\cf4 \strokec4 ):\cb1 \
\cb3         \cf10 \strokec10 """\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         \uc0\u1055 \u1088 \u1086 \u1074 \u1077 \u1088 \u1103 \u1077 \u1084  min_loan_amount_for_bep: \cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         \uc0\u1089 \u1082 \u1086 \u1083 \u1100 \u1082 \u1086  \u1085 \u1091 \u1078 \u1085 \u1086  \u1085 \u1072  \u1086 \u1076 \u1085 \u1091  \u1074 \u1077 \u1097 \u1100 , \u1095 \u1090 \u1086 \u1073 \u1099  \u1087 \u1086 \u1082 \u1088 \u1099 \u1090 \u1100  \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1099 ?\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         """\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 params\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 WarehouseParams\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 total_area\cf9 \strokec9 =\cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 rental_cost_per_m2\cf9 \strokec9 =\cf12 \strokec12 10\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 useful_area_ratio\cf9 \strokec9 =\cf12 \strokec12 0.5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 mode\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1056 \u1091 \u1095 \u1085 \u1086 \u1081 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_share\cf9 \strokec9 =\cf12 \strokec12 0.25\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_share\cf9 \strokec9 =\cf12 \strokec12 0.25\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_share\cf9 \strokec9 =\cf12 \strokec12 0.25\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_share\cf9 \strokec9 =\cf12 \strokec12 0.25\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_area_manual\cf9 \strokec9 =\cf12 \strokec12 10.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_area_manual\cf9 \strokec9 =\cf12 \strokec12 10.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_area_manual\cf9 \strokec9 =\cf12 \strokec12 10.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_area_manual\cf9 \strokec9 =\cf12 \strokec12 10.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_fee\cf9 \strokec9 =\cf12 \strokec12 15\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 shelves_per_m2\cf9 \strokec9 =\cf12 \strokec12 3\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_daily_rate\cf9 \strokec9 =\cf12 \strokec12 6\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_extra_fee\cf9 \strokec9 =\cf12 \strokec12 10\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 item_evaluation\cf9 \strokec9 =\cf12 \strokec12 0.8\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 item_realization_markup\cf9 \strokec9 =\cf12 \strokec12 20.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 average_item_value\cf9 \strokec9 =\cf12 \strokec12 15000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_interest_rate\cf9 \strokec9 =\cf12 \strokec12 0.317\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_term_days\cf9 \strokec9 =\cf12 \strokec12 30\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 realization_share_storage\cf9 \strokec9 =\cf12 \strokec12 0.5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 realization_share_loan\cf9 \strokec9 =\cf12 \strokec12 0.5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 realization_share_vip\cf9 \strokec9 =\cf12 \strokec12 0.5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 realization_share_short_term\cf9 \strokec9 =\cf12 \strokec12 0.5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_items_density\cf9 \strokec9 =\cf12 \strokec12 5\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_items_density\cf9 \strokec9 =\cf12 \strokec12 1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_items_density\cf9 \strokec9 =\cf12 \strokec12 2\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_items_density\cf9 \strokec9 =\cf12 \strokec12 4\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_fill_rate\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_fill_rate\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_fill_rate\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_fill_rate\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_monthly_churn\cf9 \strokec9 =\cf12 \strokec12 0.01\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_monthly_churn\cf9 \strokec9 =\cf12 \strokec12 0.02\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_monthly_churn\cf9 \strokec9 =\cf12 \strokec12 0.005\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_monthly_churn\cf9 \strokec9 =\cf12 \strokec12 0.03\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 salary_expense\cf9 \strokec9 =\cf12 \strokec12 240000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 miscellaneous_expenses\cf9 \strokec9 =\cf12 \strokec12 50000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 depreciation_expense\cf9 \strokec9 =\cf12 \strokec12 20000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 marketing_expenses\cf9 \strokec9 =\cf12 \strokec12 30000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 insurance_expenses\cf9 \strokec9 =\cf12 \strokec12 10000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 taxes\cf9 \strokec9 =\cf12 \strokec12 50000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 utilities_expenses\cf9 \strokec9 =\cf12 \strokec12 20000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 maintenance_expenses\cf9 \strokec9 =\cf12 \strokec12 15000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_setup_cost\cf9 \strokec9 =\cf12 \strokec12 100000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_equipment_cost\cf9 \strokec9 =\cf12 \strokec12 200000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_other_costs\cf9 \strokec9 =\cf12 \strokec12 50000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_legal_cost\cf9 \strokec9 =\cf12 \strokec12 20000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_logistics_cost\cf9 \strokec9 =\cf12 \strokec12 30000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 time_horizon\cf9 \strokec9 =\cf12 \strokec12 6\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_rent_growth\cf9 \strokec9 =\cf12 \strokec12 0.01\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 default_probability\cf9 \strokec9 =\cf12 \strokec12 0.05\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 liquidity_factor\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 safety_factor\cf9 \strokec9 =\cf12 \strokec12 1.2\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_grace_period\cf9 \strokec9 =\cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_income_growth\cf9 \strokec9 =\cf12 \strokec12 0.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_expenses_growth\cf9 \strokec9 =\cf12 \strokec12 0.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 forecast_method\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1041 \u1072 \u1079 \u1086 \u1074 \u1099 \u1081 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monte_carlo_simulations\cf9 \strokec9 =\cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monte_carlo_deviation\cf9 \strokec9 =\cf12 \strokec12 0.1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monte_carlo_seed\cf9 \strokec9 =\cf12 \strokec12 42\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 enable_ml_settings\cf9 \strokec9 =\cf11 \strokec11 False\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 electricity_cost_per_m2\cf9 \strokec9 =\cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_inflation_rate\cf9 \strokec9 =\cf12 \strokec12 0.005\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_salary_growth\cf9 \strokec9 =\cf12 \strokec12 0.005\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_other_expenses_growth\cf9 \strokec9 =\cf12 \strokec12 0.005\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 poly_degree\cf9 \strokec9 =\cf12 \strokec12 2\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf8 \strokec8 areas\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_areas\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 for\cf4 \strokec4  \cf8 \strokec8 k\cf4 \strokec4 , \cf8 \strokec8 v\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 areas\cf4 \strokec4 .\cf7 \strokec7 items\cf4 \strokec4 ():\cb1 \
\cb3             \cf7 \strokec7 setattr\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 k\cf4 \strokec4 , \cf8 \strokec8 v\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 financials\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_financials\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 disable_extended\cf9 \strokec9 =\cf11 \strokec11 False\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 minimum_loan\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 min_loan_amount_for_bep\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 financials\cf4 \strokec4 )\cb1 \
\cb3         \cf2 \strokec2 # \uc0\u1055 \u1088 \u1086 \u1089 \u1090 \u1086  \u1087 \u1088 \u1086 \u1074 \u1077 \u1088 \u1103 \u1077 \u1084 , \u1095 \u1090 \u1086  \u1079 \u1085 \u1072 \u1095 \u1077 \u1085 \u1080 \u1077  >= 0\cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertGreaterEqual\cf4 \strokec4 (\cf8 \strokec8 minimum_loan\cf4 \strokec4 , \cf12 \strokec12 0\cf4 \strokec4 )\cb1 \
\
\cb3     \cf2 \strokec2 # ----------------------------------------\cf4 \cb1 \strokec4 \
\cb3     \cf2 \strokec2 # \uc0\u1044 \u1086 \u1087 \u1086 \u1083 \u1085 \u1080 \u1090 \u1077 \u1083 \u1100 \u1085 \u1099 \u1077  \u1090 \u1077 \u1089 \u1090 \u1099  \u1076 \u1083 \u1103  \u1073 \u1086 \u1083 \u1100 \u1096 \u1077 \u1075 \u1086  \u1087 \u1086 \u1082 \u1088 \u1099 \u1090 \u1080 \u1103 \cf4 \cb1 \strokec4 \
\cb3     \cf2 \strokec2 # ----------------------------------------\cf4 \cb1 \strokec4 \
\cb3     \cf11 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 test_calculate_monthly_projection\cf4 \strokec4 (\cf8 \strokec8 self\cf4 \strokec4 ):\cb1 \
\cb3         \cf10 \strokec10 """\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         \uc0\u1045 \u1089 \u1083 \u1080  \u1091  \u1074 \u1072 \u1089  \u1077 \u1089 \u1090 \u1100  \u1092 \u1091 \u1085 \u1082 \u1094 \u1080 \u1103  calculate_monthly_projection \cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         (\uc0\u1087 \u1086 \u1084 \u1077 \u1089 \u1103 \u1095 \u1085 \u1099 \u1081  \u1088 \u1072 \u1089 \u1095 \u1105 \u1090  \u1076 \u1086 \u1093 \u1086 \u1076 \u1086 \u1074 /\u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1086 \u1074 ), \u1087 \u1088 \u1086 \u1074 \u1077 \u1088 \u1103 \u1077 \u1084  \u1077 \u1105 .\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10         """\cf4 \cb1 \strokec4 \
\cb3         \cf2 \strokec2 # \uc0\u1055 \u1088 \u1086 \u1074 \u1077 \u1088 \u1080 \u1084 , \u1095 \u1090 \u1086  \u1092 \u1091 \u1085 \u1082 \u1094 \u1080 \u1103  \u1085 \u1077  \u1087 \u1072 \u1076 \u1072 \u1077 \u1090  \u1080  \u1076 \u1072 \u1105 \u1090  DataFrame\cf4 \cb1 \strokec4 \
\cb3         \cf5 \strokec5 try\cf4 \strokec4 :\cb1 \
\cb3             \cf5 \strokec5 from\cf4 \strokec4  \cf6 \strokec6 calculations\cf4 \strokec4  \cf5 \strokec5 import\cf4 \strokec4  \cf7 \strokec7 calculate_monthly_projection\cf4 \cb1 \strokec4 \
\cb3         \cf5 \strokec5 except\cf4 \strokec4  \cf6 \strokec6 ImportError\cf4 \strokec4 :\cb1 \
\cb3             \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 skipTest\cf4 \strokec4 (\cf10 \strokec10 "calculate_monthly_projection \uc0\u1086 \u1090 \u1089 \u1091 \u1090 \u1089 \u1090 \u1074 \u1091 \u1077 \u1090  \u1074  calculations.py"\cf4 \strokec4 )\cb1 \
\
\cb3         \cf8 \strokec8 params\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 WarehouseParams\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 total_area\cf9 \strokec9 =\cf12 \strokec12 120\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 rental_cost_per_m2\cf9 \strokec9 =\cf12 \strokec12 50\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 useful_area_ratio\cf9 \strokec9 =\cf12 \strokec12 0.8\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 mode\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1056 \u1091 \u1095 \u1085 \u1086 \u1081 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_share\cf9 \strokec9 =\cf12 \strokec12 0.25\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_share\cf9 \strokec9 =\cf12 \strokec12 0.25\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_share\cf9 \strokec9 =\cf12 \strokec12 0.25\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_share\cf9 \strokec9 =\cf12 \strokec12 0.25\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_area_manual\cf9 \strokec9 =\cf12 \strokec12 20.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_area_manual\cf9 \strokec9 =\cf12 \strokec12 20.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_area_manual\cf9 \strokec9 =\cf12 \strokec12 20.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_area_manual\cf9 \strokec9 =\cf12 \strokec12 20.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_fee\cf9 \strokec9 =\cf12 \strokec12 200\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 shelves_per_m2\cf9 \strokec9 =\cf12 \strokec12 2\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_daily_rate\cf9 \strokec9 =\cf12 \strokec12 20\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_extra_fee\cf9 \strokec9 =\cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 item_evaluation\cf9 \strokec9 =\cf12 \strokec12 0.7\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 item_realization_markup\cf9 \strokec9 =\cf12 \strokec12 15.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 average_item_value\cf9 \strokec9 =\cf12 \strokec12 10000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_interest_rate\cf9 \strokec9 =\cf12 \strokec12 0.2\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_term_days\cf9 \strokec9 =\cf12 \strokec12 15\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 realization_share_storage\cf9 \strokec9 =\cf12 \strokec12 0.2\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 realization_share_loan\cf9 \strokec9 =\cf12 \strokec12 0.3\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 realization_share_vip\cf9 \strokec9 =\cf12 \strokec12 0.1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 realization_share_short_term\cf9 \strokec9 =\cf12 \strokec12 0.05\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_items_density\cf9 \strokec9 =\cf12 \strokec12 3\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_items_density\cf9 \strokec9 =\cf12 \strokec12 2\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_items_density\cf9 \strokec9 =\cf12 \strokec12 2\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_items_density\cf9 \strokec9 =\cf12 \strokec12 4\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_fill_rate\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_fill_rate\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_fill_rate\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_fill_rate\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 storage_monthly_churn\cf9 \strokec9 =\cf12 \strokec12 0.05\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_monthly_churn\cf9 \strokec9 =\cf12 \strokec12 0.06\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 vip_monthly_churn\cf9 \strokec9 =\cf12 \strokec12 0.03\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 short_term_monthly_churn\cf9 \strokec9 =\cf12 \strokec12 0.04\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 salary_expense\cf9 \strokec9 =\cf12 \strokec12 100000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 miscellaneous_expenses\cf9 \strokec9 =\cf12 \strokec12 20000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 depreciation_expense\cf9 \strokec9 =\cf12 \strokec12 15000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 marketing_expenses\cf9 \strokec9 =\cf12 \strokec12 10000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 insurance_expenses\cf9 \strokec9 =\cf12 \strokec12 5000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 taxes\cf9 \strokec9 =\cf12 \strokec12 20000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 utilities_expenses\cf9 \strokec9 =\cf12 \strokec12 10000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 maintenance_expenses\cf9 \strokec9 =\cf12 \strokec12 8000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_setup_cost\cf9 \strokec9 =\cf12 \strokec12 50000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_equipment_cost\cf9 \strokec9 =\cf12 \strokec12 80000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_other_costs\cf9 \strokec9 =\cf12 \strokec12 20000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_legal_cost\cf9 \strokec9 =\cf12 \strokec12 10000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 one_time_logistics_cost\cf9 \strokec9 =\cf12 \strokec12 15000\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 time_horizon\cf9 \strokec9 =\cf12 \strokec12 6\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_rent_growth\cf9 \strokec9 =\cf12 \strokec12 0.02\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 default_probability\cf9 \strokec9 =\cf12 \strokec12 0.05\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 liquidity_factor\cf9 \strokec9 =\cf12 \strokec12 1.0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 safety_factor\cf9 \strokec9 =\cf12 \strokec12 1.2\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 loan_grace_period\cf9 \strokec9 =\cf12 \strokec12 0\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_income_growth\cf9 \strokec9 =\cf12 \strokec12 0.01\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_expenses_growth\cf9 \strokec9 =\cf12 \strokec12 0.01\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 forecast_method\cf9 \strokec9 =\cf10 \strokec10 "\uc0\u1041 \u1072 \u1079 \u1086 \u1074 \u1099 \u1081 "\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monte_carlo_simulations\cf9 \strokec9 =\cf12 \strokec12 100\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monte_carlo_deviation\cf9 \strokec9 =\cf12 \strokec12 0.1\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monte_carlo_seed\cf9 \strokec9 =\cf12 \strokec12 42\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 enable_ml_settings\cf9 \strokec9 =\cf11 \strokec11 False\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 electricity_cost_per_m2\cf9 \strokec9 =\cf12 \strokec12 50\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_inflation_rate\cf9 \strokec9 =\cf12 \strokec12 0.005\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_salary_growth\cf9 \strokec9 =\cf12 \strokec12 0.005\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 monthly_other_expenses_growth\cf9 \strokec9 =\cf12 \strokec12 0.005\cf4 \strokec4 ,\cb1 \
\cb3             \cf8 \strokec8 poly_degree\cf9 \strokec9 =\cf12 \strokec12 2\cf4 \strokec4 ,\cb1 \
\cb3         )\cb1 \
\cb3         \cf2 \strokec2 # \uc0\u1057 \u1095 \u1080 \u1090 \u1072 \u1077 \u1084  "\u1089 \u1090 \u1072 \u1090 \u1080 \u1095 \u1085 \u1091 \u1102 " \u1073 \u1072 \u1079 \u1091 \cf4 \cb1 \strokec4 \
\cb3         \cf8 \strokec8 areas\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_areas\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 for\cf4 \strokec4  \cf8 \strokec8 k\cf4 \strokec4 , \cf8 \strokec8 v\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 areas\cf4 \strokec4 .\cf7 \strokec7 items\cf4 \strokec4 ():\cb1 \
\cb3             \cf7 \strokec7 setattr\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 k\cf4 \strokec4 , \cf8 \strokec8 v\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 base_fin\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_financials\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 disable_extended\cf9 \strokec9 =\cf11 \strokec11 False\cf4 \strokec4 )\cb1 \
\
\cb3         \cf5 \strokec5 try\cf4 \strokec4 :\cb1 \
\cb3             \cf8 \strokec8 df_proj\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_monthly_projection\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 base_fin\cf4 \strokec4 )\cb1 \
\cb3             \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertIsInstance\cf4 \strokec4 (\cf8 \strokec8 df_proj\cf4 \strokec4 , \cf6 \strokec6 pd\cf4 \strokec4 .\cf6 \strokec6 DataFrame\cf4 \strokec4 )\cb1 \
\cb3             \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertIn\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1052 \u1077 \u1089 \u1103 \u1094 "\cf4 \strokec4 , \cf8 \strokec8 df_proj\cf4 \strokec4 .\cf8 \strokec8 columns\cf4 \strokec4 )\cb1 \
\cb3             \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertIn\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1044 \u1086 \u1093 \u1086 \u1076 "\cf4 \strokec4 , \cf8 \strokec8 df_proj\cf4 \strokec4 .\cf8 \strokec8 columns\cf4 \strokec4 )\cb1 \
\cb3             \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertIn\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1056 \u1072 \u1089 \u1093 \u1086 \u1076 "\cf4 \strokec4 , \cf8 \strokec8 df_proj\cf4 \strokec4 .\cf8 \strokec8 columns\cf4 \strokec4 )\cb1 \
\cb3             \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertIn\cf4 \strokec4 (\cf10 \strokec10 "\uc0\u1055 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100 "\cf4 \strokec4 , \cf8 \strokec8 df_proj\cf4 \strokec4 .\cf8 \strokec8 columns\cf4 \strokec4 )\cb1 \
\cb3             \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 assertEqual\cf4 \strokec4 (\cf7 \strokec7 len\cf4 \strokec4 (\cf8 \strokec8 df_proj\cf4 \strokec4 ), \cf8 \strokec8 params\cf4 \strokec4 .\cf8 \strokec8 time_horizon\cf4 \strokec4 )\cb1 \
\cb3         \cf5 \strokec5 except\cf4 \strokec4  \cf6 \strokec6 Exception\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf8 \strokec8 e\cf4 \strokec4 :\cb1 \
\cb3             \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 fail\cf4 \strokec4 (\cf11 \strokec11 f\cf10 \strokec10 "calculate_monthly_projection \uc0\u1074 \u1099 \u1079 \u1074 \u1072 \u1083 \u1086  \u1080 \u1089 \u1082 \u1083 \u1102 \u1095 \u1077 \u1085 \u1080 \u1077 : \cf11 \strokec11 \{\cf8 \strokec8 e\cf11 \strokec11 \}\cf10 \strokec10 "\cf4 \strokec4 )\cb1 \
\
\
\cf5 \cb3 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 __name__\cf4 \strokec4  \cf9 \strokec9 ==\cf4 \strokec4  \cf10 \strokec10 "__main__"\cf4 \strokec4 :\cb1 \
\cb3     \cf6 \strokec6 unittest\cf4 \strokec4 .\cf6 \strokec6 main\cf4 \strokec4 ()\cb1 \
\pard\pardeftab560\slleading20\partightenfactor0

\f0\fs26 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 \
\
\'b4\'b4\'b4\
\
\
\uc0\u1060 \u1072 \u1081 \u1083 : config.yaml\
\
\'b4\'b4\'b4python\
\pard\pardeftab720\partightenfactor0

\f1\fs24 \cf2 \cb3 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 # config.yaml\cf4 \cb1 \strokec4 \
\
\cf11 \cb3 \strokec11 default_params\cf4 \strokec4 :\cb1 \
\cb3   \cf11 \strokec11 total_area\cf4 \strokec4 : \cf12 \strokec12 250\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 rental_cost_per_m2\cf4 \strokec4 : \cf12 \strokec12 1000\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 useful_area_ratio\cf4 \strokec4 : \cf12 \strokec12 0.70\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 storage_share\cf4 \strokec4 : \cf12 \strokec12 0.50\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 loan_share\cf4 \strokec4 : \cf12 \strokec12 0.30\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 vip_share\cf4 \strokec4 : \cf12 \strokec12 0.10\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 short_term_share\cf4 \strokec4 : \cf12 \strokec12 0.10\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 storage_area_manual\cf4 \strokec4 : \cf12 \strokec12 30.0\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 loan_area_manual\cf4 \strokec4 : \cf12 \strokec12 30.0\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 vip_area_manual\cf4 \strokec4 : \cf12 \strokec12 10.0\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 short_term_area_manual\cf4 \strokec4 : \cf12 \strokec12 10.0\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 storage_fee\cf4 \strokec4 : \cf12 \strokec12 1500\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 shelves_per_m2\cf4 \strokec4 : \cf12 \strokec12 2\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 short_term_daily_rate\cf4 \strokec4 : \cf12 \strokec12 60.0\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 vip_extra_fee\cf4 \strokec4 : \cf12 \strokec12 1000.0\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 item_evaluation\cf4 \strokec4 : \cf12 \strokec12 0.80\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 item_realization_markup\cf4 \strokec4 : \cf12 \strokec12 20.0\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 average_item_value\cf4 \strokec4 : \cf12 \strokec12 15000\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 loan_interest_rate\cf4 \strokec4 : \cf12 \strokec12 0.317\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 loan_term_days\cf4 \strokec4 : \cf12 \strokec12 30\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 realization_share_storage\cf4 \strokec4 : \cf12 \strokec12 0.10\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 realization_share_loan\cf4 \strokec4 : \cf12 \strokec12 0.10\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 realization_share_vip\cf4 \strokec4 : \cf12 \strokec12 0.10\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 realization_share_short_term\cf4 \strokec4 : \cf12 \strokec12 0.10\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 storage_items_density\cf4 \strokec4 : \cf12 \strokec12 1\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 loan_items_density\cf4 \strokec4 : \cf12 \strokec12 1\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 vip_items_density\cf4 \strokec4 : \cf12 \strokec12 1\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 short_term_items_density\cf4 \strokec4 : \cf12 \strokec12 1\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 storage_fill_rate\cf4 \strokec4 : \cf12 \strokec12 1.0\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 loan_fill_rate\cf4 \strokec4 : \cf12 \strokec12 1.0\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 vip_fill_rate\cf4 \strokec4 : \cf12 \strokec12 1.0\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 short_term_fill_rate\cf4 \strokec4 : \cf12 \strokec12 1.0\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 storage_monthly_churn\cf4 \strokec4 : \cf12 \strokec12 0.01\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 loan_monthly_churn\cf4 \strokec4 : \cf12 \strokec12 0.02\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 vip_monthly_churn\cf4 \strokec4 : \cf12 \strokec12 0.005\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 short_term_monthly_churn\cf4 \strokec4 : \cf12 \strokec12 0.03\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 salary_expense\cf4 \strokec4 : \cf12 \strokec12 240000\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 miscellaneous_expenses\cf4 \strokec4 : \cf12 \strokec12 50000\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 depreciation_expense\cf4 \strokec4 : \cf12 \strokec12 20000\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 marketing_expenses\cf4 \strokec4 : \cf12 \strokec12 30000\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 insurance_expenses\cf4 \strokec4 : \cf12 \strokec12 10000\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 taxes\cf4 \strokec4 : \cf12 \strokec12 50000\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 utilities_expenses\cf4 \strokec4 : \cf12 \strokec12 20000\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 maintenance_expenses\cf4 \strokec4 : \cf12 \strokec12 15000\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 one_time_setup_cost\cf4 \strokec4 : \cf12 \strokec12 100000\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 one_time_equipment_cost\cf4 \strokec4 : \cf12 \strokec12 200000\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 one_time_other_costs\cf4 \strokec4 : \cf12 \strokec12 50000\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 one_time_legal_cost\cf4 \strokec4 : \cf12 \strokec12 20000\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 one_time_logistics_cost\cf4 \strokec4 : \cf12 \strokec12 30000\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 monthly_inflation_rate\cf4 \strokec4 : \cf12 \strokec12 0.005\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 monthly_rent_growth\cf4 \strokec4 : \cf12 \strokec12 0.01\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 monthly_salary_growth\cf4 \strokec4 : \cf12 \strokec12 0.005\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 monthly_other_expenses_growth\cf4 \strokec4 : \cf12 \strokec12 0.005\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 time_horizon\cf4 \strokec4 : \cf12 \strokec12 6\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 default_probability\cf4 \strokec4 : \cf12 \strokec12 0.05\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 liquidity_factor\cf4 \strokec4 : \cf12 \strokec12 1.0\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 safety_factor\cf4 \strokec4 : \cf12 \strokec12 1.2\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 loan_grace_period\cf4 \strokec4 : \cf12 \strokec12 0\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 monthly_income_growth\cf4 \strokec4 : \cf12 \strokec12 0.0\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 monthly_expenses_growth\cf4 \strokec4 : \cf12 \strokec12 0.0\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 monte_carlo_simulations\cf4 \strokec4 : \cf12 \strokec12 100\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 monte_carlo_deviation\cf4 \strokec4 : \cf12 \strokec12 0.1\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 monte_carlo_seed\cf4 \strokec4 : \cf12 \strokec12 42\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 electricity_cost_per_m2\cf4 \strokec4 : \cf12 \strokec12 100.0\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 packaging_cost_per_m2\cf4 \strokec4 : \cf12 \strokec12 10.0\cf4 \strokec4   \cf2 \strokec2 # \uc0\u1044 \u1086 \u1073 \u1072 \u1074 \u1080 \u1083 \u1080  \u1091 \u1087 \u1072 \u1082 \u1086 \u1074 \u1082 \u1091  \u1085 \u1072  \u1084 \'b2\cf4 \cb1 \strokec4 \
\cb3   \cf11 \strokec11 forecast_method\cf4 \strokec4 : \cf10 \strokec10 "\uc0\u1041 \u1072 \u1079 \u1086 \u1074 \u1099 \u1081 "\cf4 \cb1 \strokec4 \
\pard\pardeftab560\slleading20\partightenfactor0

\f0\fs26 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 \
\
\'b4\'b4\'b4\uc0\u8232 \
\pard\pardeftab560\slleading20\pardirnatural\partightenfactor0
\cf0 \
\pard\pardeftab560\slleading20\partightenfactor0
\cf0 \uc0\u1060 \u1072 \u1081 \u1083 : service.py\
\
\'b4\'b4\'b4python\
\pard\pardeftab720\partightenfactor0

\f1\fs24 \cf2 \cb3 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 # service.py\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 from\cf4 \strokec4  \cf6 \strokec6 calculations\cf4 \strokec4  \cf5 \strokec5 import\cf4 \strokec4  (\cb1 \
\cb3     \cf7 \strokec7 calculate_areas\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 calculate_items\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 calculate_financials\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 calculate_irr\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 calculate_monthly_bep\cf4 \strokec4 ,\cb1 \
\cb3     \cf7 \strokec7 calculate_total_bep\cf4 \strokec4 ,\cb1 \
\cb3 )\cb1 \
\
\cf11 \cb3 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 calculate_all\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 disable_extended\cf4 \strokec4 ):\cb1 \
\cb3     \cf10 \strokec10 """\uc0\u1042 \u1099 \u1087 \u1086 \u1083 \u1085 \u1103 \u1077 \u1090  \u1087 \u1086 \u1083 \u1085 \u1099 \u1081  \u1094 \u1080 \u1082 \u1083  \u1088 \u1072 \u1089 \u1095 \u1105 \u1090 \u1086 \u1074 ."""\cf4 \cb1 \strokec4 \
\cb3     \cf8 \strokec8 areas\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_areas\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\cb3     \cf5 \strokec5 for\cf4 \strokec4  \cf8 \strokec8 k\cf4 \strokec4 , \cf8 \strokec8 v\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 areas\cf4 \strokec4 .\cf7 \strokec7 items\cf4 \strokec4 ():\cb1 \
\cb3         \cf7 \strokec7 setattr\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 k\cf4 \strokec4 , \cf8 \strokec8 v\cf4 \strokec4 )\cb1 \
\
\
\cb3     \cf8 \strokec8 items_dict\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \{\cb1 \
\cb3         \cf10 \strokec10 "stored_items"\cf4 \strokec4 : \cf7 \strokec7 calculate_items\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .storage_area,\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .shelves_per_m2,\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .storage_items_density,\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .storage_fill_rate,\cb1 \
\cb3         ),\cb1 \
\cb3         \cf10 \strokec10 "total_items_loan"\cf4 \strokec4 : \cf7 \strokec7 calculate_items\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .loan_area,\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .shelves_per_m2,\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .loan_items_density,\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .loan_fill_rate,\cb1 \
\cb3         ),\cb1 \
\cb3         \cf10 \strokec10 "vip_stored_items"\cf4 \strokec4 : \cf7 \strokec7 calculate_items\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .vip_area,\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .shelves_per_m2,\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .vip_items_density,\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .vip_fill_rate,\cb1 \
\cb3         ),\cb1 \
\cb3         \cf10 \strokec10 "short_term_stored_items"\cf4 \strokec4 : \cf7 \strokec7 calculate_items\cf4 \strokec4 (\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .short_term_area,\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .shelves_per_m2,\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .short_term_items_density,\cb1 \
\cb3             \cf8 \strokec8 params\cf4 \strokec4 .short_term_fill_rate,\cb1 \
\cb3         ),\cb1 \
\cb3     \}\cb1 \
\
\cb3     \cf8 \strokec8 financials\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_financials\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 , \cf8 \strokec8 disable_extended\cf4 \strokec4 )\cb1 \
\cb3     \cf8 \strokec8 initial_investment\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf9 \strokec9 -\cf4 \strokec4 (\cf8 \strokec8 params\cf4 \strokec4 .one_time_setup_cost \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .one_time_equipment_cost\cb1 \
\cb3                            \cf9 \strokec9 +\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .one_time_other_costs)\cb1 \
\cb3     \cf8 \strokec8 cash_flows\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  [\cf8 \strokec8 initial_investment\cf4 \strokec4 ] \cf9 \strokec9 +\cf4 \strokec4  [\cf8 \strokec8 financials\cf4 \strokec4 [\cf10 \strokec10 "profit"\cf4 \strokec4 ]] \cf9 \strokec9 *\cf4 \strokec4  \cf8 \strokec8 params\cf4 \strokec4 .time_horizon\cb1 \
\cb3     \cf8 \strokec8 irr_val\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_irr\cf4 \strokec4 (\cf8 \strokec8 cash_flows\cf4 \strokec4 )\cb1 \
\cb3     \cf8 \strokec8 bep_val\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_total_bep\cf4 \strokec4 (\cf8 \strokec8 financials\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\cb3     \cf8 \strokec8 monthly_bep_values\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf7 \strokec7 calculate_monthly_bep\cf4 \strokec4 (\cf8 \strokec8 financials\cf4 \strokec4 , \cf8 \strokec8 params\cf4 \strokec4 )\cb1 \
\
\cb3     \cf5 \strokec5 return\cf4 \strokec4  \cf8 \strokec8 items_dict\cf4 \strokec4 , \cf8 \strokec8 financials\cf4 \strokec4 , \cf8 \strokec8 irr_val\cf4 \strokec4 , \cf8 \strokec8 bep_val\cf4 \strokec4 , \cf8 \strokec8 monthly_bep_values\cf4 \cb1 \strokec4 \
\pard\pardeftab560\slleading20\partightenfactor0

\f0\fs26 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 \
\
\'b4\'b4\'b4\uc0\u8232 \
\uc0\u1060 \u1072 \u1081 \u1083 : app_state.py\
\
\'b4\'b4\'b4python\
\pard\pardeftab720\partightenfactor0

\f1\fs24 \cf2 \cb3 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 # app_state.py\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 streamlit\cf4 \strokec4  \cf5 \strokec5 as\cf4 \strokec4  \cf6 \strokec6 st\cf4 \cb1 \strokec4 \
\cf5 \cb3 \strokec5 import\cf4 \strokec4  \cf6 \strokec6 yaml\cf4 \cb1 \strokec4 \
\
\cf11 \cb3 \strokec11 class\cf4 \strokec4  \cf6 \strokec6 AppState\cf4 \strokec4 :\cb1 \
\cb3     \cf10 \strokec10 """\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     \uc0\u1050 \u1083 \u1072 \u1089 \u1089  \u1076 \u1083 \u1103  \u1091 \u1087 \u1088 \u1072 \u1074 \u1083 \u1077 \u1085 \u1080 \u1103  \u1089 \u1086 \u1089 \u1090 \u1086 \u1103 \u1085 \u1080 \u1077 \u1084  \u1087 \u1088 \u1080 \u1083 \u1086 \u1078 \u1077 \u1085 \u1080 \u1103 , \u1086 \u1073 \u1086 \u1088 \u1072 \u1095 \u1080 \u1074 \u1072 \u1102 \u1097 \u1080 \u1081  st.session_state.\cf4 \cb1 \strokec4 \
\cf10 \cb3 \strokec10     """\cf4 \cb1 \strokec4 \
\cb3     \cf11 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 __init__\cf4 \strokec4 (\cf8 \strokec8 self\cf4 \strokec4 ):\cb1 \
\cb3         \cf5 \strokec5 if\cf4 \strokec4  \cf10 \strokec10 "initialized"\cf4 \strokec4  \cf11 \strokec11 not\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 session_state\cf4 \strokec4 :\cb1 \
\cb3             \cf8 \strokec8 self\cf4 \strokec4 .\cf7 \strokec7 load_default_state\cf4 \strokec4 ()\cb1 \
\cb3             \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 session_state\cf4 \strokec4 [\cf10 \strokec10 "initialized"\cf4 \strokec4 ] \cf9 \strokec9 =\cf4 \strokec4  \cf11 \strokec11 True\cf4 \cb1 \strokec4 \
\
\cb3     \cf11 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 load_default_state\cf4 \strokec4 (\cf8 \strokec8 self\cf4 \strokec4 ):\cb1 \
\cb3         \cf10 \strokec10 """\uc0\u1047 \u1072 \u1075 \u1088 \u1091 \u1078 \u1072 \u1077 \u1090  \u1089 \u1086 \u1089 \u1090 \u1086 \u1103 \u1085 \u1080 \u1077  \u1087 \u1086  \u1091 \u1084 \u1086 \u1083 \u1095 \u1072 \u1085 \u1080 \u1102  \u1080 \u1079  config.yaml."""\cf4 \cb1 \strokec4 \
\cb3         \cf5 \strokec5 with\cf4 \strokec4  \cf7 \strokec7 open\cf4 \strokec4 (\cf10 \strokec10 "config.yaml"\cf4 \strokec4 , \cf10 \strokec10 "r"\cf4 \strokec4 ) \cf5 \strokec5 as\cf4 \strokec4  \cf8 \strokec8 f\cf4 \strokec4 :\cb1 \
\cb3             \cf8 \strokec8 config\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf6 \strokec6 yaml\cf4 \strokec4 .\cf7 \strokec7 safe_load\cf4 \strokec4 (\cf8 \strokec8 f\cf4 \strokec4 )\cb1 \
\cb3         \cf8 \strokec8 default_params\cf4 \strokec4  \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 config\cf4 \strokec4 [\cf10 \strokec10 "default_params"\cf4 \strokec4 ]\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 session_state\cf4 \strokec4 .shares \cf9 \strokec9 =\cf4 \strokec4  \{\cb1 \
\cb3             \cf10 \strokec10 "storage_share"\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \strokec4 (\cf8 \strokec8 default_params\cf4 \strokec4 [\cf10 \strokec10 "storage_share"\cf4 \strokec4 ]),\cb1 \
\cb3             \cf10 \strokec10 "loan_share"\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \strokec4 (\cf8 \strokec8 default_params\cf4 \strokec4 [\cf10 \strokec10 "loan_share"\cf4 \strokec4 ]),\cb1 \
\cb3             \cf10 \strokec10 "vip_share"\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \strokec4 (\cf8 \strokec8 default_params\cf4 \strokec4 [\cf10 \strokec10 "vip_share"\cf4 \strokec4 ]),\cb1 \
\cb3             \cf10 \strokec10 "short_term_share"\cf4 \strokec4 : \cf6 \strokec6 float\cf4 \strokec4 (\cf8 \strokec8 default_params\cf4 \strokec4 [\cf10 \strokec10 "short_term_share"\cf4 \strokec4 ]),\cb1 \
\cb3         \}\cb1 \
\cb3         \cf5 \strokec5 for\cf4 \strokec4  \cf8 \strokec8 key\cf4 \strokec4 , \cf8 \strokec8 value\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf8 \strokec8 default_params\cf4 \strokec4 .items():\cb1 \
\cb3             \cf5 \strokec5 if\cf4 \strokec4  \cf8 \strokec8 key\cf4 \strokec4  \cf11 \strokec11 not\cf4 \strokec4  \cf11 \strokec11 in\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 session_state\cf4 \strokec4 :\cb1 \
\cb3                 \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 session_state\cf4 \strokec4 [\cf8 \strokec8 key\cf4 \strokec4 ] \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 value\cf4 \cb1 \strokec4 \
\
\cb3     \cf7 \strokec7 @\cf6 \strokec6 property\cf4 \cb1 \strokec4 \
\cb3     \cf11 \strokec11 def\cf4 \strokec4  \cf8 \strokec8 shares\cf4 \strokec4 (\cf8 \strokec8 self\cf4 \strokec4 ):\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 session_state\cf4 \strokec4 .shares\cb1 \
\
\cb3     \cf11 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 update_share\cf4 \strokec4 (\cf8 \strokec8 self\cf4 \strokec4 , \cf8 \strokec8 key\cf4 \strokec4 , \cf8 \strokec8 value\cf4 \strokec4 ):\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 session_state\cf4 \strokec4 .shares[\cf8 \strokec8 key\cf4 \strokec4 ] \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 value\cf4 \cb1 \strokec4 \
\
\cb3     \cf11 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 get\cf4 \strokec4 (\cf8 \strokec8 self\cf4 \strokec4 , \cf8 \strokec8 key\cf4 \strokec4 ):\cb1 \
\cb3         \cf5 \strokec5 return\cf4 \strokec4  \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 session_state\cf4 \strokec4 .\cf7 \strokec7 get\cf4 \strokec4 (\cf8 \strokec8 key\cf4 \strokec4 )\cb1 \
\
\cb3     \cf11 \strokec11 def\cf4 \strokec4  \cf7 \strokec7 set\cf4 \strokec4 (\cf8 \strokec8 self\cf4 \strokec4 , \cf8 \strokec8 key\cf4 \strokec4 , \cf8 \strokec8 value\cf4 \strokec4 ):\cb1 \
\cb3         \cf6 \strokec6 st\cf4 \strokec4 .\cf8 \strokec8 session_state\cf4 \strokec4 [\cf8 \strokec8 key\cf4 \strokec4 ] \cf9 \strokec9 =\cf4 \strokec4  \cf8 \strokec8 value\cf4 \cb1 \strokec4 \
\pard\pardeftab560\slleading20\partightenfactor0

\f0\fs26 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 \
\
\'b4\'b4\'b4}